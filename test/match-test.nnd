;;-*- mode: nendo; syntax: scheme -*-;;
;;
;; match-test.nnd - test suite for util.match
;;  
;;   This file ported from chibi-scheme 0.3 by Alex Shinn.
;;

(use nendo.test)
(use util.match)
;;(use util.match-expanded)

(test-start "match")
(test-section "match")

(define-syntax match-test*
  (syntax-rules ()
    ((_ title code result)
     (test* title result code))))

(define-syntax pending*
  (syntax-rules ()
    ((_ title code result)
     (printf "(pending) [%s]\n" title))))


;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; run tests


;;(pretty-print
;; (strip-syntactic-closures
;;  (macroexpand
;;   '(match '((a . 1) (b . 2) (c . 3))
;;      (((x . y) ... last) (list x y last))))))

;; test single tail, expects ((a b) (1 2) (c . 3)) ==> ./test/match-test.nnd:28: Error: match: no matching pattern (RuntimeError)
(match-test*  "single tail"
              (match '((a . 1) (b . 2) (c . 3))
                (((x . y) ... last) (list x y last)))
              '((a b) (1 2) (c . 3)))

(test-end)
