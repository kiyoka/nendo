;;-*- mode: nendo; syntax: scheme -*-;;
;;
;; match-test.nnd - test suite for util.match
;;  
;;   This file ported from chibi-scheme 0.3 by Alex Shinn.
;;

(use nendo.test)
;;(use util.match)
(use util.match-expanded)

(test-start "match")
(test-section "match")

(define-syntax match-test*
  (syntax-rules ()
    ((_ title code result)
     (test* title result code))))

(define-syntax pending*
  (syntax-rules ()
    ((_ title code result)
     (printf "(pending) [%s]\n" title))))


;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; run tests

;;(match-test* "match-next"
;;           (match-next v ((quote ((a . 1) (b . 2) (c . 3))) (set! (quote ((a . 1) (b . 2) (c . 3))))))
;;             '((a b) (1 2) (c . 3)))

(print "CHIBI")
(write
 ((lambda
      (v)
    #?=v
    ((lambda
         (failure)
       ((lambda
            (tail-len)
          ((lambda
               (ls)
             #?=ls
             ((lambda
                  (len)
                ((lambda
                     ()
                   (if
                    (< #?=len #?=tail-len)
                    (failure)
                    ((lambda
                         ()
                       (define loop #f)
                       (set! loop
                             (lambda
                                 (ls n p-ls_4 p-ls_3)
                               #?=ls
                               (if
                                (= n tail-len)
                                ((lambda
                                     (y x)
                                   (if
                                    (if
                                     (pair? #?=ls)
                                     (null?
                                      #?=(cdr ls)) #f)
                                    ((lambda
                                         (w)
                                       ((lambda
                                            (last)
                                          (list x y last)) w))
                                     (car ls))
                                    (failure)))
                                 (reverse p-ls_4)
                                 (reverse p-ls_3))
                                (if
                                 (pair? ls)
                                 ((lambda
                                      (w)
                                    (if
                                     (pair? w)
                                     ((lambda
                                          (w x)
                                        ((lambda
                                             (x_5)
                                           ((lambda
                                                (y)
                                              (loop
                                               (cdr ls)
                                               (- n 1)
                                               (cons y p-ls_4)
                                               (cons x_5 p-ls_3))) x)) w))
                                      (car w)
                                      (cdr w))
                                     (failure)))
                                  (car ls))
                                 (failure))))) ()
                       (loop ls len
                             (quote
                              ())
                             (quote
                              ()))))))))
              (length ls))) v))
        (length
         (quote
          (last)))))
     (lambda
         ()
       (error "Error: match: no matching pattern"))))
  (quote
   ((a . 1) (b . 2) (c . 3)))))
(newline)


(print "Nendo-fix")
(write 
 (%let
  ((_v__gensym__ff3f61c3ba35f549a979b3165d34cc15ea0af34c_30035
    (quote
     ((a . 1) (b . 2) (c . 3)))))
  (%let
   ((_failure__gensym__ff3f61c3ba35f549a979b3165d34cc15ea0af34c_30036
     (lambda
         ()
       (error "Error: match: no matching pattern"))))
   (begin
     (begin
       (begin
         (begin
           (%let
            ((_tail_MIMARKlen__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30131
              (length
               (quote
                (last)))))
            (%let
             ((_ls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30132 #?=_v__gensym__ff3f61c3ba35f549a979b3165d34cc15ea0af34c_30035))
             (%let
              ((_len__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30133
                (length _ls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30132)))
              (if
               (< _len__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30133 _tail_MIMARKlen__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30131)
               (_failure__gensym__ff3f61c3ba35f549a979b3165d34cc15ea0af34c_30036)
               (letrec
                   ((_loop__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30134
                     (lambda
                         (_ls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30132 _n__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30135 _p_MIMARKls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30105 _p_MIMARKls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30074)
                       (if
                        (= _n__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30135 _tail_MIMARKlen__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30131)
                        (begin
                          (%let
                           ((y
                             (reverse _p_MIMARKls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30105))
                            (x
                             (reverse _p_MIMARKls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30074)))
                           (if
                            (if
                             (not
                              (eq? #f
                                   (pair? #?=_ls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30132)))
                             (null?
                              #?=(cdr _ls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30132)) #f)
                            (%let
                             ((_w__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30177
                               (car _ls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30132)))
                             (begin
                               (%let
                                ()
                                (%let
                                 ()
                                 (%let
                                  ((last _w__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30177))
                                  (begin
                                    (list x y last)))))))
                            (_failure__gensym__ff3f61c3ba35f549a979b3165d34cc15ea0af34c_30036))))
                        (if
                         (pair? _ls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30132)
                         (begin
                           (%let
                            ((_w__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30136
                              (car _ls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30132)))
                            (if
                             (pair? _w__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30136)
                             (%let
                              ((_w__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30208
                                (car _w__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30136))
                               (_x__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30209
                                (cdr _w__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30136)))
                              (begin
                                (%let
                                 ()
                                 (%let
                                  ()
                                  (%let
                                   ((_w__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30136
                                     (car _ls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30132)))
                                   (%let
                                    ((x _w__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30208))
                                    (begin
                                      (%let
                                       ()
                                       (%let
                                        ()
                                        (%let
                                         ((_w__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30136
                                           (car _ls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30132)))
                                         (%let
                                          ((_w__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30208
                                            (car _w__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30136)))
                                          (%let
                                           ()
                                           (%let
                                            ()
                                            (%let
                                             ((_w__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30136
                                               (car _ls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30132)))
                                             (%let
                                              ((x _w__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30208))
                                              (%let
                                               ((y _x__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30209))
                                               (_loop__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30134
                                                (cdr _ls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30132)
                                                (- _n__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30135 1)
                                                (cons y _p_MIMARKls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30105)
                                                (cons x _p_MIMARKls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30074))))))))))))))))))
                             (_failure__gensym__ff3f61c3ba35f549a979b3165d34cc15ea0af34c_30036))))
                         (if _else__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30137
                             (begin
                               (_failure__gensym__ff3f61c3ba35f549a979b3165d34cc15ea0af34c_30036))
                             ()))))))
                 (_loop__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30134 _ls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30132 _len__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30133
                                                                                (quote
                                                                                 ())
                                                                                (quote
                                                                                 ()))))))))))))))


(print "Nendo")
(write 
 (%let
  ((_v__gensym__ff3f61c3ba35f549a979b3165d34cc15ea0af34c_30035
    (quote
     ((a . 1) (b . 2) (c . 3)))))
  (%let
   ((_failure__gensym__ff3f61c3ba35f549a979b3165d34cc15ea0af34c_30036
     (lambda
         ()
       (error "Error: match: no matching pattern"))))
   (begin
     (begin
       (begin
         (begin
           (%let
            ((_tail_MIMARKlen__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30131
              (length
               (quote
                (last)))))
            (%let
             ((_ls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30132 #?=_v__gensym__ff3f61c3ba35f549a979b3165d34cc15ea0af34c_30035))
             (%let
              ((_len__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30133
                (length _ls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30132)))
              (if
               (< _len__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30133 _tail_MIMARKlen__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30131)
               (_failure__gensym__ff3f61c3ba35f549a979b3165d34cc15ea0af34c_30036)
               (letrec
                   ((_loop__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30134
                     (lambda
                         (_ls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30132 _n__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30135 _p_MIMARKls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30105 _p_MIMARKls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30074)
                       (if
                        (= _n__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30135 _tail_MIMARKlen__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30131)
                        (begin
                          (%let
                           ((y
                             (reverse _p_MIMARKls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30105))
                            (x
                             (reverse _p_MIMARKls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30074)))
                           (if
                            (if
                             (not
                              (eq? #f
                                   (pair? #?=_ls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30132)))
                             (null?
                              #?=(cdr _ls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30132)) #f)
                            (%let
                             ((_w__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30177
                               (car _ls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30132)))
                             (begin
                               (%let
                                ((_v__gensym__ff3f61c3ba35f549a979b3165d34cc15ea0af34c_30035
                                  (quote
                                   ((a . 1) (b . 2) (c . 3)))))
                                (%let
                                 ((_ls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30132 _v__gensym__ff3f61c3ba35f549a979b3165d34cc15ea0af34c_30035))
                                 (%let
                                  ((last _w__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30177))
                                  (begin
                                    (list x y last)))))))
                            (_failure__gensym__ff3f61c3ba35f549a979b3165d34cc15ea0af34c_30036))))
                        (if
                         (pair? _ls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30132)
                         (begin
                           (%let
                            ((_w__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30136
                              (car _ls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30132)))
                            (if
                             (pair? _w__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30136)
                             (%let
                              ((_w__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30208
                                (car _w__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30136))
                               (_x__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30209
                                (cdr _w__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30136)))
                              (begin
                                (%let
                                 ((_v__gensym__ff3f61c3ba35f549a979b3165d34cc15ea0af34c_30035
                                   (quote
                                    ((a . 1) (b . 2) (c . 3)))))
                                 (%let
                                  ((_ls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30132 _v__gensym__ff3f61c3ba35f549a979b3165d34cc15ea0af34c_30035))
                                  (%let
                                   ((_w__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30136
                                     (car _ls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30132)))
                                   (%let
                                    ((x _w__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30208))
                                    (begin
                                      (%let
                                       ((_v__gensym__ff3f61c3ba35f549a979b3165d34cc15ea0af34c_30035
                                         (quote
                                          ((a . 1) (b . 2) (c . 3)))))
                                       (%let
                                        ((_ls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30132 _v__gensym__ff3f61c3ba35f549a979b3165d34cc15ea0af34c_30035))
                                        (%let
                                         ((_w__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30136
                                           (car _ls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30132)))
                                         (%let
                                          ((_w__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30208
                                            (car _w__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30136)))
                                          (%let
                                           ((_v__gensym__ff3f61c3ba35f549a979b3165d34cc15ea0af34c_30035
                                             (quote
                                              ((a . 1) (b . 2) (c . 3)))))
                                           (%let
                                            ((_ls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30132 _v__gensym__ff3f61c3ba35f549a979b3165d34cc15ea0af34c_30035))
                                            (%let
                                             ((_w__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30136
                                               (car _ls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30132)))
                                             (%let
                                              ((x _w__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30208))
                                              (%let
                                               ((y _x__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30209))
                                               (_loop__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30134
                                                (cdr _ls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30132)
                                                (- _n__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30135 1)
                                                (cons y _p_MIMARKls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30105)
                                                (cons x _p_MIMARKls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30074))))))))))))))))))
                             (_failure__gensym__ff3f61c3ba35f549a979b3165d34cc15ea0af34c_30036))))
                         (if _else__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30137
                             (begin
                               (_failure__gensym__ff3f61c3ba35f549a979b3165d34cc15ea0af34c_30036))
                             ()))))))
                 (_loop__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30134 _ls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30132 _len__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30133
                                                                                (quote
                                                                                 ())
                                                                                (quote
                                                                                 ()))))))))))))))


(print "Nendo-fix")
(write 
 (%let
  ((_v__gensym__ff3f61c3ba35f549a979b3165d34cc15ea0af34c_30035
    (quote
     ((a . 1) (b . 2) (c . 3)))))
  (%let
   ((_failure__gensym__ff3f61c3ba35f549a979b3165d34cc15ea0af34c_30036
     (lambda
         ()
       (error "Error: match: no matching pattern"))))
   (begin
     (begin
       (begin
         (begin
           (%let
            ((_tail_MIMARKlen__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30131
              (length
               (quote
                (last)))))
            (%let
             ((_ls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30132 #?=_v__gensym__ff3f61c3ba35f549a979b3165d34cc15ea0af34c_30035))
             (%let
              ((_len__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30133
                (length _ls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30132)))
              (if
               (< _len__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30133 _tail_MIMARKlen__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30131)
               (_failure__gensym__ff3f61c3ba35f549a979b3165d34cc15ea0af34c_30036)
               (letrec
                   ((_loop__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30134
                     (lambda
                         (_ls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30132 _n__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30135 _p_MIMARKls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30105 _p_MIMARKls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30074)
                       (if
                        (= _n__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30135 _tail_MIMARKlen__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30131)
                        (begin
                          (%let
                           ((y
                             (reverse _p_MIMARKls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30105))
                            (x
                             (reverse _p_MIMARKls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30074)))
                           (if
                            (if
                             (not
                              (eq? #f
                                   (pair? #?=_ls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30132)))
                             (null?
                              #?=(cdr _ls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30132)) #f)
                            (%let
                             ((_w__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30177
                               (car _ls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30132)))
                             (begin
                               (%let
                                ()
                                (%let
                                 ((_ls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30132 _v__gensym__ff3f61c3ba35f549a979b3165d34cc15ea0af34c_30035))
                                 (%let
                                  ((last _w__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30177))
                                  (begin
                                    (list x y last)))))))
                            (_failure__gensym__ff3f61c3ba35f549a979b3165d34cc15ea0af34c_30036))))
                        (if
                         (pair? _ls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30132)
                         (begin
                           (%let
                            ((_w__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30136
                              (car _ls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30132)))
                            (if
                             (pair? _w__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30136)
                             (%let
                              ((_w__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30208
                                (car _w__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30136))
                               (_x__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30209
                                (cdr _w__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30136)))
                              (begin
                                (%let
                                 ()
                                 (%let
                                  ((_ls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30132 _v__gensym__ff3f61c3ba35f549a979b3165d34cc15ea0af34c_30035))
                                  (%let
                                   ((_w__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30136
                                     (car _ls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30132)))
                                   (%let
                                    ((x _w__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30208))
                                    (begin
                                      (%let
                                       ()
                                       (%let
                                        ((_ls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30132 _v__gensym__ff3f61c3ba35f549a979b3165d34cc15ea0af34c_30035))
                                        (%let
                                         ((_w__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30136
                                           (car _ls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30132)))
                                         (%let
                                          ((_w__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30208
                                            (car _w__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30136)))
                                          (%let
                                           ()
                                           (%let
                                            ((_ls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30132 _v__gensym__ff3f61c3ba35f549a979b3165d34cc15ea0af34c_30035))
                                            (%let
                                             ((_w__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30136
                                               (car _ls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30132)))
                                             (%let
                                              ((x _w__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30208))
                                              (%let
                                               ((y _x__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30209))
                                               (_loop__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30134
                                                (cdr _ls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30132)
                                                (- _n__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30135 1)
                                                (cons y _p_MIMARKls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30105)
                                                (cons x _p_MIMARKls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30074))))))))))))))))))
                             (_failure__gensym__ff3f61c3ba35f549a979b3165d34cc15ea0af34c_30036))))
                         (if _else__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30137
                             (begin
                               (_failure__gensym__ff3f61c3ba35f549a979b3165d34cc15ea0af34c_30036))
                             ()))))))
                 (_loop__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30134 _ls__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30132 _len__gensym__16b2635cc60d2744f1ec64942b9115d129949ee3_30133
                                                                                (quote
                                                                                 ())
                                                                                (quote
                                                                                 ()))))))))))))))



;; test single tail, expects ((a b) (1 2) (c . 3)) ==> ./test/match-test.nnd:28: Error: match: no matching pattern (RuntimeError)
(pretty-print
 (strip-syntactic-closures
  (macroexpand
   '(match '((a . 1) (b . 2) (c . 3))
      (((x . y) ... last) (list x y last))))))
(exit)

;; test single tail, expects ((a b) (1 2) (c . 3)) ==> ./test/match-test.nnd:28: Error: match: no matching pattern (RuntimeError)
(pending*   "single tail"
            (match '((a . 1) (b . 2) (c . 3))
              (((x . y) ... last) (list x y last)))
            '((a b) (1 2) (c . 3)))

(test-end)

