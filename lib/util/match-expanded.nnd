;;;-*- mode: nendo; syntax: scheme -*-;;

(define-syntax match-syntax-error
 (er-macro-transformer
  (lambda
   (expr rename compare)
   ((lambda
     (tmp)
     (if tmp tmp
      (error "no expansion for"
       (strip-syntactic-closures expr))))
    ((lambda
      (v.1)
      (if
       (null? v.1)
       (cons
        (rename
         (quote match-syntax-error))
        (cons "invalid match-syntax-error usage"
         (quote
          ()))) #f))
     (cdr expr))))))

(define-syntax match
 (er-macro-transformer
  (lambda
   (expr rename compare)
   ((lambda
     (tmp)
     (if tmp tmp
      ((lambda
        (tmp)
        (if tmp tmp
         ((lambda
           (tmp)
           (if tmp tmp
            ((lambda
              (tmp)
              (if tmp tmp
               ((lambda
                 (tmp)
                 (if tmp tmp
                  (error "no expansion for"
                   (strip-syntactic-closures expr))))
                ((lambda
                  (v.20)
                  (if
                   (pair? v.20)
                   ((lambda
                     (v.21)
                     ((lambda
                       (atom)
                       ((lambda
                         (v.22)
                         ((lambda
                           ()
                           (define lp #f)
                           (set! lp
                            (lambda
                             (v.23 pat-ls body-ls)
                             (if
                              (null? v.23)
                              ((lambda
                                (pat body)
                                (cons
                                 (rename
                                  (quote match-next))
                                 (cons atom
                                  (cons
                                   (cons atom
                                    (cons
                                     (cons
                                      (rename
                                       (quote set!))
                                      (cons atom
                                       (quote
                                        ())))
                                     (quote
                                      ())))
                                   (map
                                    (lambda
                                     (pat body)
                                     (cons pat body)) pat body)))))
                               (reverse pat-ls)
                               (reverse body-ls))
                              (if
                               (pair? v.23)
                               ((lambda
                                 (v.24)
                                 (if
                                  (pair? v.24)
                                  ((lambda
                                    (v.25)
                                    ((lambda
                                      (pat)
                                      ((lambda
                                        (v.26)
                                        ((lambda
                                          (body)
                                          (lp
                                           (cdr v.23)
                                           (cons pat pat-ls)
                                           (cons body body-ls))) v.26))
                                       (cdr v.24))) v.25))
                                   (car v.24)) #f))
                                (car v.23)) #f)))) #<undef>
                           (lp v.22
                            ()
                            ()))))
                        (cdr v.20))) v.21))
                    (car v.20)) #f))
                 (cdr expr)))))
             ((lambda
               (v.12)
               (if
                (pair? v.12)
                ((lambda
                  (v.13)
                  (if
                   (vector? v.13)
                   ((lambda
                     (v.14)
                     (if
                      (list? v.14)
                      ((lambda
                        (vec)
                        ((lambda
                          (v.15)
                          ((lambda
                            ()
                            (define lp #f)
                            (set! lp
                             (lambda
                              (v.16 pat-ls body-ls)
                              (if
                               (null? v.16)
                               ((lambda
                                 (pat body)
                                 (cons
                                  (rename
                                   (quote let))
                                  (cons
                                   (cons
                                    (cons
                                     (rename
                                      (quote v))
                                     (cons
                                      (list->vector
                                       (map
                                        (lambda
                                         (vec) vec) vec))
                                      (quote
                                       ())))
                                    (quote
                                     ()))
                                   (cons
                                    (cons
                                     (rename
                                      (quote match-next))
                                     (cons
                                      (rename
                                       (quote v))
                                      (cons
                                       (cons
                                        (rename
                                         (quote v))
                                        (cons
                                         (cons
                                          (rename
                                           (quote set!))
                                          (cons
                                           (rename
                                            (quote v))
                                           (quote
                                            ())))
                                         (quote
                                          ())))
                                       (map
                                        (lambda
                                         (pat body)
                                         (cons pat body)) pat body))))
                                    (quote
                                     ())))))
                                (reverse pat-ls)
                                (reverse body-ls))
                               (if
                                (pair? v.16)
                                ((lambda
                                  (v.17)
                                  (if
                                   (pair? v.17)
                                   ((lambda
                                     (v.18)
                                     ((lambda
                                       (pat)
                                       ((lambda
                                         (v.19)
                                         ((lambda
                                           (body)
                                           (lp
                                            (cdr v.16)
                                            (cons pat pat-ls)
                                            (cons body body-ls))) v.19))
                                        (cdr v.17))) v.18))
                                    (car v.17)) #f))
                                 (car v.16)) #f)))) #<undef>
                            (lp v.15
                             ()
                             ()))))
                         (cdr v.12))) v.14) #f))
                    (vector->list v.13)) #f))
                 (car v.12)) #f))
              (cdr expr)))))
          ((lambda
            (v.5)
            (if
             (pair? v.5)
             ((lambda
               (v.6)
               (if
                (list? v.6)
                ((lambda
                  (app)
                  ((lambda
                    (v.7)
                    ((lambda
                      ()
                      (define lp #f)
                      (set! lp
                       (lambda
                        (v.8 pat-ls body-ls)
                        (if
                         (null? v.8)
                         ((lambda
                           (pat body)
                           (cons
                            (rename
                             (quote let))
                            (cons
                             (cons
                              (cons
                               (rename
                                (quote v))
                               (cons
                                (map
                                 (lambda
                                  (app) app) app)
                                (quote
                                 ())))
                              (quote
                               ()))
                             (cons
                              (cons
                               (rename
                                (quote match-next))
                               (cons
                                (rename
                                 (quote v))
                                (cons
                                 (cons
                                  (map
                                   (lambda
                                    (app) app) app)
                                  (cons
                                   (cons
                                    (rename
                                     (quote set!))
                                    (cons
                                     (map
                                      (lambda
                                       (app) app) app)
                                     (quote
                                      ())))
                                   (quote
                                    ())))
                                 (map
                                  (lambda
                                   (pat body)
                                   (cons pat body)) pat body))))
                              (quote
                               ())))))
                          (reverse pat-ls)
                          (reverse body-ls))
                         (if
                          (pair? v.8)
                          ((lambda
                            (v.9)
                            (if
                             (pair? v.9)
                             ((lambda
                               (v.10)
                               ((lambda
                                 (pat)
                                 ((lambda
                                   (v.11)
                                   ((lambda
                                     (body)
                                     (lp
                                      (cdr v.8)
                                      (cons pat pat-ls)
                                      (cons body body-ls))) v.11))
                                  (cdr v.9))) v.10))
                              (car v.9)) #f))
                           (car v.8)) #f)))) #<undef>
                      (lp v.7
                       ()
                       ()))))
                   (cdr v.5))) v.6) #f))
              (car v.5)) #f))
           (cdr expr)))))
       ((lambda
         (v.2)
         (if
          (pair? v.2)
          ((lambda
            (v.3)
            ((lambda
              (atom)
              ((lambda
                (v.4)
                (if
                 (null? v.4)
                 (cons
                  (rename
                   (quote match-syntax-error))
                  (cons "no match clauses"
                   (quote
                    ()))) #f))
               (cdr v.2))) v.3))
           (car v.2)) #f))
        (cdr expr)))))
    ((lambda
      (v.1)
      (if
       (null? v.1)
       (cons
        (rename
         (quote match-syntax-error))
        (cons "missing match expression"
         (quote
          ()))) #f))
     (cdr expr))))))

(define-syntax match-next
 (er-macro-transformer
  (lambda
   (expr rename compare)
   ((lambda
     (tmp)
     (if tmp tmp
      ((lambda
        (tmp)
        (if tmp tmp
         ((lambda
           (tmp)
           (if tmp tmp
            (error "no expansion for"
             (strip-syntactic-closures expr))))
          ((lambda
            (v.21)
            (if
             (pair? v.21)
             ((lambda
               (v.22)
               ((lambda
                 (v)
                 ((lambda
                   (v.23)
                   (if
                    (pair? v.23)
                    ((lambda
                      (v.24)
                      ((lambda
                        (g+s)
                        ((lambda
                          (v.25)
                          (if
                           (pair? v.25)
                           ((lambda
                             (v.26)
                             (if
                              (pair? v.26)
                              ((lambda
                                (v.27)
                                ((lambda
                                  (pat)
                                  ((lambda
                                    (v.28)
                                    ((lambda
                                      (body)
                                      ((lambda
                                        (v.29)
                                        ((lambda
                                          (rest)
                                          (cons
                                           (rename
                                            (quote match-next))
                                           (cons v
                                            (cons g+s
                                             (cons
                                              (cons pat
                                               (cons
                                                (cons
                                                 (rename
                                                  (quote =>))
                                                 (cons
                                                  (rename
                                                   (quote failure))
                                                  (quote
                                                   ()))) body)) rest))))) v.29))
                                       (cdr v.25))) v.28))
                                   (cdr v.26))) v.27))
                               (car v.26)) #f))
                            (car v.25)) #f))
                         (cdr v.23))) v.24))
                     (car v.23)) #f))
                  (cdr v.21))) v.22))
              (car v.21)) #f))
           (cdr expr)))))
       ((lambda
         (v.6)
         (if
          (pair? v.6)
          ((lambda
            (v.7)
            ((lambda
              (v)
              ((lambda
                (v.8)
                (if
                 (pair? v.8)
                 ((lambda
                   (v.9)
                   ((lambda
                     (g+s)
                     ((lambda
                       (v.10)
                       (if
                        (pair? v.10)
                        ((lambda
                          (v.11)
                          (if
                           (pair? v.11)
                           ((lambda
                             (v.12)
                             ((lambda
                               (pat)
                               ((lambda
                                 (v.13)
                                 (if
                                  (pair? v.13)
                                  ((lambda
                                    (v.14)
                                    (if
                                     (pair? v.14)
                                     ((lambda
                                       (v.15)
                                       (if
                                        (compare v.15
                                         (quote =>))
                                        ((lambda
                                          (v.16)
                                          (if
                                           (pair? v.16)
                                           ((lambda
                                             (v.17)
                                             ((lambda
                                               (failure)
                                               ((lambda
                                                 (v.18)
                                                 (if
                                                  (null? v.18)
                                                  ((lambda
                                                    (v.19)
                                                    ((lambda
                                                      (body)
                                                      ((lambda
                                                        (v.20)
                                                        ((lambda
                                                          (rest)
                                                          (cons
                                                           (rename
                                                            (quote let))
                                                           (cons
                                                            (cons
                                                             (cons failure
                                                              (cons
                                                               (cons
                                                                (rename
                                                                 (quote lambda))
                                                                (cons
                                                                 (quote
                                                                  ())
                                                                 (cons
                                                                  (cons
                                                                   (rename
                                                                    (quote match-next))
                                                                   (cons v
                                                                    (cons g+s rest)))
                                                                  (quote
                                                                   ()))))
                                                               (quote
                                                                ())))
                                                             (quote
                                                              ()))
                                                            (cons
                                                             (cons
                                                              (rename
                                                               (quote match-one))
                                                              (cons v
                                                               (cons pat
                                                                (cons g+s
                                                                 (cons
                                                                  (cons
                                                                   (rename
                                                                    (quote match-drop-ids))
                                                                   (cons
                                                                    (cons
                                                                     (rename
                                                                      (quote begin)) body)
                                                                    (quote
                                                                     ())))
                                                                  (cons
                                                                   (cons failure
                                                                    (quote
                                                                     ()))
                                                                   (cons
                                                                    (quote
                                                                     ())
                                                                    (quote
                                                                     ()))))))))
                                                             (quote
                                                              ()))))) v.20))
                                                       (cdr v.10))) v.19))
                                                   (cdr v.13)) #f))
                                                (cdr v.16))) v.17))
                                            (car v.16)) #f))
                                         (cdr v.14)) #f))
                                      (car v.14)) #f))
                                   (car v.13)) #f))
                                (cdr v.11))) v.12))
                            (car v.11)) #f))
                         (car v.10)) #f))
                      (cdr v.8))) v.9))
                  (car v.8)) #f))
               (cdr v.6))) v.7))
           (car v.6)) #f))
        (cdr expr)))))
    ((lambda
      (v.1)
      (if
       (pair? v.1)
       ((lambda
         (v.2)
         ((lambda
           (v)
           ((lambda
             (v.3)
             (if
              (pair? v.3)
              ((lambda
                (v.4)
                ((lambda
                  (g+s)
                  ((lambda
                    (v.5)
                    (if
                     (null? v.5)
                     (cons
                      (rename
                       (quote error))
                      (cons "Error: match: no matching pattern"
                       (quote
                        ()))) #f))
                   (cdr v.3))) v.4))
               (car v.3)) #f))
            (cdr v.1))) v.2))
        (car v.1)) #f))
     (cdr expr))))))

(define-syntax match-one
 (er-macro-transformer
  (lambda
   (expr rename compare)
   ((lambda
     (tmp)
     (if tmp tmp
      ((lambda
        (tmp)
        (if tmp tmp
         (error "no expansion for"
          (strip-syntactic-closures expr))))
       ((lambda
         (v.18)
         ((lambda
           (x)
           (cons
            (rename
             (quote match-two)) x)) v.18))
        (cdr expr)))))
    ((lambda
      (v.1)
      (if
       (pair? v.1)
       ((lambda
         (v.2)
         ((lambda
           (v)
           ((lambda
             (v.3)
             (if
              (pair? v.3)
              ((lambda
                (v.4)
                (if
                 (pair? v.4)
                 ((lambda
                   (v.5)
                   ((lambda
                     (p)
                     ((lambda
                       (v.6)
                       (if
                        (pair? v.6)
                        ((lambda
                          (v.7)
                          ((lambda
                            (q)
                            ((lambda
                              (v.8)
                              ((lambda
                                (r)
                                ((lambda
                                  (v.9)
                                  (if
                                   (pair? v.9)
                                   ((lambda
                                     (v.10)
                                     ((lambda
                                       (g+s)
                                       ((lambda
                                         (v.11)
                                         (if
                                          (pair? v.11)
                                          ((lambda
                                            (v.12)
                                            ((lambda
                                              (sk)
                                              ((lambda
                                                (v.13)
                                                (if
                                                 (pair? v.13)
                                                 ((lambda
                                                   (v.14)
                                                   ((lambda
                                                     (fk)
                                                     ((lambda
                                                       (v.15)
                                                       (if
                                                        (pair? v.15)
                                                        ((lambda
                                                          (v.16)
                                                          ((lambda
                                                            (i)
                                                            ((lambda
                                                              (v.17)
                                                              (if
                                                               (null? v.17)
                                                               (cons
                                                                (rename
                                                                 (quote match-check-ellipse))
                                                                (cons q
                                                                 (cons
                                                                  (cons
                                                                   (rename
                                                                    (quote match-extract-vars))
                                                                   (cons p
                                                                    (cons
                                                                     (cons
                                                                      (rename
                                                                       (quote match-gen-ellipses))
                                                                      (cons v
                                                                       (cons p
                                                                        (cons r
                                                                         (cons g+s
                                                                          (cons sk
                                                                           (cons fk
                                                                            (cons i
                                                                             (quote
                                                                              ())))))))))
                                                                     (cons i
                                                                      (cons
                                                                       (quote
                                                                        ())
                                                                       (quote
                                                                        ()))))))
                                                                  (cons
                                                                   (cons
                                                                    (rename
                                                                     (quote match-two))
                                                                    (cons v
                                                                     (cons
                                                                      (cons p
                                                                       (cons q r))
                                                                      (cons g+s
                                                                       (cons sk
                                                                        (cons fk
                                                                         (cons i
                                                                          (quote
                                                                           ()))))))))
                                                                   (quote
                                                                    ()))))) #f))
                                                             (cdr v.15))) v.16))
                                                         (car v.15)) #f))
                                                      (cdr v.13))) v.14))
                                                  (car v.13)) #f))
                                               (cdr v.11))) v.12))
                                           (car v.11)) #f))
                                        (cdr v.9))) v.10))
                                    (car v.9)) #f))
                                 (cdr v.3))) v.8))
                             (cdr v.6))) v.7))
                         (car v.6)) #f))
                      (cdr v.4))) v.5))
                  (car v.4)) #f))
               (car v.3)) #f))
            (cdr v.1))) v.2))
        (car v.1)) #f))
     (cdr expr))))))

(define-syntax match-two
 (er-macro-transformer
  (lambda
   (expr rename compare)
   ((lambda
     (tmp)
     (if tmp tmp
      ((lambda
        (tmp)
        (if tmp tmp
         ((lambda
           (tmp)
           (if tmp tmp
            ((lambda
              (tmp)
              (if tmp tmp
               ((lambda
                 (tmp)
                 (if tmp tmp
                  ((lambda
                    (tmp)
                    (if tmp tmp
                     ((lambda
                       (tmp)
                       (if tmp tmp
                        ((lambda
                          (tmp)
                          (if tmp tmp
                           ((lambda
                             (tmp)
                             (if tmp tmp
                              ((lambda
                                (tmp)
                                (if tmp tmp
                                 ((lambda
                                   (tmp)
                                   (if tmp tmp
                                    ((lambda
                                      (tmp)
                                      (if tmp tmp
                                       ((lambda
                                         (tmp)
                                         (if tmp tmp
                                          ((lambda
                                            (tmp)
                                            (if tmp tmp
                                             ((lambda
                                               (tmp)
                                               (if tmp tmp
                                                ((lambda
                                                  (tmp)
                                                  (if tmp tmp
                                                   ((lambda
                                                     (tmp)
                                                     (if tmp tmp
                                                      ((lambda
                                                        (tmp)
                                                        (if tmp tmp
                                                         ((lambda
                                                           (tmp)
                                                           (if tmp tmp
                                                            ((lambda
                                                              (tmp)
                                                              (if tmp tmp
                                                               ((lambda
                                                                 (tmp)
                                                                 (if tmp tmp
                                                                  (error "no expansion for"
                                                                   (strip-syntactic-closures expr))))
                                                                ((lambda
                                                                  (v.302)
                                                                  (if
                                                                   (pair? v.302)
                                                                   ((lambda
                                                                     (v.303)
                                                                     ((lambda
                                                                       (v)
                                                                       ((lambda
                                                                         (v.304)
                                                                         (if
                                                                          (pair? v.304)
                                                                          ((lambda
                                                                            (v.305)
                                                                            ((lambda
                                                                              (x)
                                                                              ((lambda
                                                                                (v.306)
                                                                                (if
                                                                                 (pair? v.306)
                                                                                 ((lambda
                                                                                   (v.307)
                                                                                   ((lambda
                                                                                     (g+s)
                                                                                     ((lambda
                                                                                       (v.308)
                                                                                       (if
                                                                                        (pair? v.308)
                                                                                        ((lambda
                                                                                          (v.309)
                                                                                          (if
                                                                                           (list? v.309)
                                                                                           ((lambda
                                                                                             (sk)
                                                                                             ((lambda
                                                                                               (v.310)
                                                                                               (if
                                                                                                (pair? v.310)
                                                                                                ((lambda
                                                                                                  (v.311)
                                                                                                  ((lambda
                                                                                                    (fk)
                                                                                                    ((lambda
                                                                                                      (v.312)
                                                                                                      (if
                                                                                                       (pair? v.312)
                                                                                                       ((lambda
                                                                                                         (v.313)
                                                                                                         (if
                                                                                                          (list? v.313)
                                                                                                          ((lambda
                                                                                                            (id)
                                                                                                            ((lambda
                                                                                                              (v.314)
                                                                                                              (if
                                                                                                               (null? v.314)
                                                                                                               (cons
                                                                                                                (rename
                                                                                                                 (quote let-syntax))
                                                                                                                (cons
                                                                                                                 (cons
                                                                                                                  (cons
                                                                                                                   (rename
                                                                                                                    (quote new-sym?))
                                                                                                                   (cons
                                                                                                                    (cons
                                                                                                                     (rename
                                                                                                                      (quote syntax-rules))
                                                                                                                     (cons
                                                                                                                      (map
                                                                                                                       (lambda
                                                                                                                        (id) id) id)
                                                                                                                      (cons
                                                                                                                       (cons
                                                                                                                        (cons
                                                                                                                         (rename
                                                                                                                          (quote new-sym?))
                                                                                                                         (cons x
                                                                                                                          (cons
                                                                                                                           (rename
                                                                                                                            (quote sk2))
                                                                                                                           (cons
                                                                                                                            (rename
                                                                                                                             (quote fk2))
                                                                                                                            (quote
                                                                                                                             ())))))
                                                                                                                        (cons
                                                                                                                         (rename
                                                                                                                          (quote sk2))
                                                                                                                         (quote
                                                                                                                          ())))
                                                                                                                       (cons
                                                                                                                        (cons
                                                                                                                         (cons
                                                                                                                          (rename
                                                                                                                           (quote new-sym?))
                                                                                                                          (cons
                                                                                                                           (rename
                                                                                                                            (quote y))
                                                                                                                           (cons
                                                                                                                            (rename
                                                                                                                             (quote sk2))
                                                                                                                            (cons
                                                                                                                             (rename
                                                                                                                              (quote fk2))
                                                                                                                             (quote
                                                                                                                              ())))))
                                                                                                                         (cons
                                                                                                                          (rename
                                                                                                                           (quote fk2))
                                                                                                                          (quote
                                                                                                                           ())))
                                                                                                                        (quote
                                                                                                                         ())))))
                                                                                                                    (quote
                                                                                                                     ())))
                                                                                                                  (quote
                                                                                                                   ()))
                                                                                                                 (cons
                                                                                                                  (cons
                                                                                                                   (rename
                                                                                                                    (quote new-sym?))
                                                                                                                   (cons
                                                                                                                    (rename
                                                                                                                     (quote random-sym-to-match))
                                                                                                                    (cons
                                                                                                                     (cons
                                                                                                                      (rename
                                                                                                                       (quote let))
                                                                                                                      (cons
                                                                                                                       (cons
                                                                                                                        (cons x
                                                                                                                         (cons v
                                                                                                                          (quote
                                                                                                                           ())))
                                                                                                                        (quote
                                                                                                                         ()))
                                                                                                                       (cons
                                                                                                                        (append
                                                                                                                         (map
                                                                                                                          (lambda
                                                                                                                           (sk) sk) sk)
                                                                                                                         (cons
                                                                                                                          (append
                                                                                                                           (map
                                                                                                                            (lambda
                                                                                                                             (id) id) id)
                                                                                                                           (cons x
                                                                                                                            (quote
                                                                                                                             ())))
                                                                                                                          (quote
                                                                                                                           ())))
                                                                                                                        (quote
                                                                                                                         ()))))
                                                                                                                     (cons
                                                                                                                      (cons
                                                                                                                       (rename
                                                                                                                        (quote if))
                                                                                                                       (cons
                                                                                                                        (cons
                                                                                                                         (rename
                                                                                                                          (quote equal?))
                                                                                                                         (cons v
                                                                                                                          (cons x
                                                                                                                           (quote
                                                                                                                            ()))))
                                                                                                                        (cons
                                                                                                                         (append
                                                                                                                          (map
                                                                                                                           (lambda
                                                                                                                            (sk) sk) sk)
                                                                                                                          (cons
                                                                                                                           (map
                                                                                                                            (lambda
                                                                                                                             (id) id) id)
                                                                                                                           (quote
                                                                                                                            ())))
                                                                                                                         (cons fk
                                                                                                                          (quote
                                                                                                                           ())))))
                                                                                                                      (quote
                                                                                                                       ())))))
                                                                                                                  (quote
                                                                                                                   ())))) #f))
                                                                                                             (cdr v.312))) v.313) #f))
                                                                                                        (car v.312)) #f))
                                                                                                     (cdr v.310))) v.311))
                                                                                                 (car v.310)) #f))
                                                                                              (cdr v.308))) v.309) #f))
                                                                                         (car v.308)) #f))
                                                                                      (cdr v.306))) v.307))
                                                                                  (car v.306)) #f))
                                                                               (cdr v.304))) v.305))
                                                                           (car v.304)) #f))
                                                                        (cdr v.302))) v.303))
                                                                    (car v.302)) #f))
                                                                 (cdr expr)))))
                                                             ((lambda
                                                               (v.289)
                                                               (if
                                                                (pair? v.289)
                                                                ((lambda
                                                                  (v.290)
                                                                  ((lambda
                                                                    (v)
                                                                    ((lambda
                                                                      (v.291)
                                                                      (if
                                                                       (pair? v.291)
                                                                       ((lambda
                                                                         (v.292)
                                                                         (if
                                                                          (compare v.292
                                                                           (quote _))
                                                                          ((lambda
                                                                            (v.293)
                                                                            (if
                                                                             (pair? v.293)
                                                                             ((lambda
                                                                               (v.294)
                                                                               ((lambda
                                                                                 (g+s)
                                                                                 ((lambda
                                                                                   (v.295)
                                                                                   (if
                                                                                    (pair? v.295)
                                                                                    ((lambda
                                                                                      (v.296)
                                                                                      (if
                                                                                       (list? v.296)
                                                                                       ((lambda
                                                                                         (sk)
                                                                                         ((lambda
                                                                                           (v.297)
                                                                                           (if
                                                                                            (pair? v.297)
                                                                                            ((lambda
                                                                                              (v.298)
                                                                                              ((lambda
                                                                                                (fk)
                                                                                                ((lambda
                                                                                                  (v.299)
                                                                                                  (if
                                                                                                   (pair? v.299)
                                                                                                   ((lambda
                                                                                                     (v.300)
                                                                                                     ((lambda
                                                                                                       (i)
                                                                                                       ((lambda
                                                                                                         (v.301)
                                                                                                         (if
                                                                                                          (null? v.301)
                                                                                                          (append
                                                                                                           (map
                                                                                                            (lambda
                                                                                                             (sk) sk) sk)
                                                                                                           (cons i
                                                                                                            (quote
                                                                                                             ()))) #f))
                                                                                                        (cdr v.299))) v.300))
                                                                                                    (car v.299)) #f))
                                                                                                 (cdr v.297))) v.298))
                                                                                             (car v.297)) #f))
                                                                                          (cdr v.295))) v.296) #f))
                                                                                     (car v.295)) #f))
                                                                                  (cdr v.293))) v.294))
                                                                              (car v.293)) #f))
                                                                           (cdr v.291)) #f))
                                                                        (car v.291)) #f))
                                                                     (cdr v.289))) v.290))
                                                                 (car v.289)) #f))
                                                              (cdr expr)))))
                                                          ((lambda
                                                            (v.281)
                                                            (if
                                                             (pair? v.281)
                                                             ((lambda
                                                               (v.282)
                                                               ((lambda
                                                                 (v)
                                                                 ((lambda
                                                                   (v.283)
                                                                   (if
                                                                    (pair? v.283)
                                                                    ((lambda
                                                                      (v.284)
                                                                      (if
                                                                       (vector? v.284)
                                                                       ((lambda
                                                                         (v.285)
                                                                         (if
                                                                          (list? v.285)
                                                                          ((lambda
                                                                            (p)
                                                                            ((lambda
                                                                              (v.286)
                                                                              (if
                                                                               (pair? v.286)
                                                                               ((lambda
                                                                                 (v.287)
                                                                                 ((lambda
                                                                                   (g+s)
                                                                                   ((lambda
                                                                                     (v.288)
                                                                                     ((lambda
                                                                                       (x)
                                                                                       (cons
                                                                                        (rename
                                                                                         (quote match-vector))
                                                                                        (cons v
                                                                                         (cons 0
                                                                                          (cons
                                                                                           (quote
                                                                                            ())
                                                                                           (cons
                                                                                            (map
                                                                                             (lambda
                                                                                              (p) p) p) x)))))) v.288))
                                                                                    (cdr v.286))) v.287))
                                                                                (car v.286)) #f))
                                                                             (cdr v.283))) v.285) #f))
                                                                        (vector->list v.284)) #f))
                                                                     (car v.283)) #f))
                                                                  (cdr v.281))) v.282))
                                                              (car v.281)) #f))
                                                           (cdr expr)))))
                                                       ((lambda
                                                         (v.266)
                                                         (if
                                                          (pair? v.266)
                                                          ((lambda
                                                            (v.267)
                                                            ((lambda
                                                              (v)
                                                              ((lambda
                                                                (v.268)
                                                                (if
                                                                 (pair? v.268)
                                                                 ((lambda
                                                                   (v.269)
                                                                   (if
                                                                    (pair? v.269)
                                                                    ((lambda
                                                                      (v.270)
                                                                      ((lambda
                                                                        (p)
                                                                        ((lambda
                                                                          (v.271)
                                                                          ((lambda
                                                                            (q)
                                                                            ((lambda
                                                                              (v.272)
                                                                              (if
                                                                               (pair? v.272)
                                                                               ((lambda
                                                                                 (v.273)
                                                                                 ((lambda
                                                                                   (g+s)
                                                                                   ((lambda
                                                                                     (v.274)
                                                                                     (if
                                                                                      (pair? v.274)
                                                                                      ((lambda
                                                                                        (v.275)
                                                                                        ((lambda
                                                                                          (sk)
                                                                                          ((lambda
                                                                                            (v.276)
                                                                                            (if
                                                                                             (pair? v.276)
                                                                                             ((lambda
                                                                                               (v.277)
                                                                                               ((lambda
                                                                                                 (fk)
                                                                                                 ((lambda
                                                                                                   (v.278)
                                                                                                   (if
                                                                                                    (pair? v.278)
                                                                                                    ((lambda
                                                                                                      (v.279)
                                                                                                      ((lambda
                                                                                                        (i)
                                                                                                        ((lambda
                                                                                                          (v.280)
                                                                                                          (if
                                                                                                           (null? v.280)
                                                                                                           (cons
                                                                                                            (rename
                                                                                                             (quote if))
                                                                                                            (cons
                                                                                                             (cons
                                                                                                              (rename
                                                                                                               (quote pair?))
                                                                                                              (cons v
                                                                                                               (quote
                                                                                                                ())))
                                                                                                             (cons
                                                                                                              (cons
                                                                                                               (rename
                                                                                                                (quote let))
                                                                                                               (cons
                                                                                                                (cons
                                                                                                                 (cons
                                                                                                                  (rename
                                                                                                                   (quote w))
                                                                                                                  (cons
                                                                                                                   (cons
                                                                                                                    (rename
                                                                                                                     (quote car))
                                                                                                                    (cons v
                                                                                                                     (quote
                                                                                                                      ())))
                                                                                                                   (quote
                                                                                                                    ())))
                                                                                                                 (cons
                                                                                                                  (cons
                                                                                                                   (rename
                                                                                                                    (quote x))
                                                                                                                   (cons
                                                                                                                    (cons
                                                                                                                     (rename
                                                                                                                      (quote cdr))
                                                                                                                     (cons v
                                                                                                                      (quote
                                                                                                                       ())))
                                                                                                                    (quote
                                                                                                                     ())))
                                                                                                                  (quote
                                                                                                                   ())))
                                                                                                                (cons
                                                                                                                 (cons
                                                                                                                  (rename
                                                                                                                   (quote match-one))
                                                                                                                  (cons
                                                                                                                   (rename
                                                                                                                    (quote w))
                                                                                                                   (cons p
                                                                                                                    (cons
                                                                                                                     (cons
                                                                                                                      (cons
                                                                                                                       (rename
                                                                                                                        (quote car))
                                                                                                                       (cons v
                                                                                                                        (quote
                                                                                                                         ())))
                                                                                                                      (cons
                                                                                                                       (cons
                                                                                                                        (rename
                                                                                                                         (quote set-car!))
                                                                                                                        (cons v
                                                                                                                         (quote
                                                                                                                          ())))
                                                                                                                       (quote
                                                                                                                        ())))
                                                                                                                     (cons
                                                                                                                      (cons
                                                                                                                       (rename
                                                                                                                        (quote match-one))
                                                                                                                       (cons
                                                                                                                        (rename
                                                                                                                         (quote x))
                                                                                                                        (cons q
                                                                                                                         (cons
                                                                                                                          (cons
                                                                                                                           (cons
                                                                                                                            (rename
                                                                                                                             (quote cdr))
                                                                                                                            (cons v
                                                                                                                             (quote
                                                                                                                              ())))
                                                                                                                           (cons
                                                                                                                            (cons
                                                                                                                             (rename
                                                                                                                              (quote set-cdr!))
                                                                                                                             (cons v
                                                                                                                              (quote
                                                                                                                               ())))
                                                                                                                            (quote
                                                                                                                             ())))
                                                                                                                          (cons sk
                                                                                                                           (cons fk
                                                                                                                            (quote
                                                                                                                             ())))))))
                                                                                                                      (cons fk
                                                                                                                       (cons i
                                                                                                                        (quote
                                                                                                                         ()))))))))
                                                                                                                 (quote
                                                                                                                  ()))))
                                                                                                              (cons fk
                                                                                                               (quote
                                                                                                                ()))))) #f))
                                                                                                         (cdr v.278))) v.279))
                                                                                                     (car v.278)) #f))
                                                                                                  (cdr v.276))) v.277))
                                                                                              (car v.276)) #f))
                                                                                           (cdr v.274))) v.275))
                                                                                       (car v.274)) #f))
                                                                                    (cdr v.272))) v.273))
                                                                                (car v.272)) #f))
                                                                             (cdr v.268))) v.271))
                                                                         (cdr v.269))) v.270))
                                                                     (car v.269)) #f))
                                                                  (car v.268)) #f))
                                                               (cdr v.266))) v.267))
                                                           (car v.266)) #f))
                                                        (cdr expr)))))
                                                    ((lambda
                                                      (v.249)
                                                      (if
                                                       (pair? v.249)
                                                       ((lambda
                                                         (v.250)
                                                         ((lambda
                                                           (v)
                                                           ((lambda
                                                             (v.251)
                                                             (if
                                                              (pair? v.251)
                                                              ((lambda
                                                                (v.252)
                                                                (if
                                                                 (pair? v.252)
                                                                 ((lambda
                                                                   (v.253)
                                                                   ((lambda
                                                                     (p)
                                                                     ((lambda
                                                                       (v.254)
                                                                       (if
                                                                        (pair? v.254)
                                                                        ((lambda
                                                                          (v.255)
                                                                          (if
                                                                           (compare v.255
                                                                            (quote ***))
                                                                           ((lambda
                                                                             (v.256)
                                                                             ((lambda
                                                                               (q)
                                                                               ((lambda
                                                                                 (v.257)
                                                                                 (if
                                                                                  (pair? v.257)
                                                                                  ((lambda
                                                                                    (v.258)
                                                                                    ((lambda
                                                                                      (g+s)
                                                                                      ((lambda
                                                                                        (v.259)
                                                                                        (if
                                                                                         (pair? v.259)
                                                                                         ((lambda
                                                                                           (v.260)
                                                                                           ((lambda
                                                                                             (sk)
                                                                                             ((lambda
                                                                                               (v.261)
                                                                                               (if
                                                                                                (pair? v.261)
                                                                                                ((lambda
                                                                                                  (v.262)
                                                                                                  ((lambda
                                                                                                    (fk)
                                                                                                    ((lambda
                                                                                                      (v.263)
                                                                                                      (if
                                                                                                       (pair? v.263)
                                                                                                       ((lambda
                                                                                                         (v.264)
                                                                                                         ((lambda
                                                                                                           (i)
                                                                                                           ((lambda
                                                                                                             (v.265)
                                                                                                             (if
                                                                                                              (null? v.265)
                                                                                                              (cons
                                                                                                               (rename
                                                                                                                (quote match-syntax-error))
                                                                                                               (cons "invalid use of ***"
                                                                                                                (cons
                                                                                                                 (cons p
                                                                                                                  (cons
                                                                                                                   (rename
                                                                                                                    (quote ***)) q))
                                                                                                                 (quote
                                                                                                                  ())))) #f))
                                                                                                            (cdr v.263))) v.264))
                                                                                                        (car v.263)) #f))
                                                                                                     (cdr v.261))) v.262))
                                                                                                 (car v.261)) #f))
                                                                                              (cdr v.259))) v.260))
                                                                                          (car v.259)) #f))
                                                                                       (cdr v.257))) v.258))
                                                                                   (car v.257)) #f))
                                                                                (cdr v.251))) v.256))
                                                                            (cdr v.254)) #f))
                                                                         (car v.254)) #f))
                                                                      (cdr v.252))) v.253))
                                                                  (car v.252)) #f))
                                                               (car v.251)) #f))
                                                            (cdr v.249))) v.250))
                                                        (car v.249)) #f))
                                                     (cdr expr)))))
                                                 ((lambda
                                                   (v.230)
                                                   (if
                                                    (pair? v.230)
                                                    ((lambda
                                                      (v.231)
                                                      ((lambda
                                                        (v)
                                                        ((lambda
                                                          (v.232)
                                                          (if
                                                           (pair? v.232)
                                                           ((lambda
                                                             (v.233)
                                                             (if
                                                              (pair? v.233)
                                                              ((lambda
                                                                (v.234)
                                                                ((lambda
                                                                  (p)
                                                                  ((lambda
                                                                    (v.235)
                                                                    (if
                                                                     (pair? v.235)
                                                                     ((lambda
                                                                       (v.236)
                                                                       (if
                                                                        (compare v.236
                                                                         (quote ***))
                                                                        ((lambda
                                                                          (v.237)
                                                                          (if
                                                                           (pair? v.237)
                                                                           ((lambda
                                                                             (v.238)
                                                                             ((lambda
                                                                               (q)
                                                                               ((lambda
                                                                                 (v.239)
                                                                                 (if
                                                                                  (null? v.239)
                                                                                  ((lambda
                                                                                    (v.240)
                                                                                    (if
                                                                                     (pair? v.240)
                                                                                     ((lambda
                                                                                       (v.241)
                                                                                       ((lambda
                                                                                         (g+s)
                                                                                         ((lambda
                                                                                           (v.242)
                                                                                           (if
                                                                                            (pair? v.242)
                                                                                            ((lambda
                                                                                              (v.243)
                                                                                              ((lambda
                                                                                                (sk)
                                                                                                ((lambda
                                                                                                  (v.244)
                                                                                                  (if
                                                                                                   (pair? v.244)
                                                                                                   ((lambda
                                                                                                     (v.245)
                                                                                                     ((lambda
                                                                                                       (fk)
                                                                                                       ((lambda
                                                                                                         (v.246)
                                                                                                         (if
                                                                                                          (pair? v.246)
                                                                                                          ((lambda
                                                                                                            (v.247)
                                                                                                            ((lambda
                                                                                                              (i)
                                                                                                              ((lambda
                                                                                                                (v.248)
                                                                                                                (if
                                                                                                                 (null? v.248)
                                                                                                                 (cons
                                                                                                                  (rename
                                                                                                                   (quote match-extract-vars))
                                                                                                                  (cons p
                                                                                                                   (cons
                                                                                                                    (cons
                                                                                                                     (rename
                                                                                                                      (quote match-gen-search))
                                                                                                                     (cons v
                                                                                                                      (cons p
                                                                                                                       (cons q
                                                                                                                        (cons g+s
                                                                                                                         (cons sk
                                                                                                                          (cons fk
                                                                                                                           (cons i
                                                                                                                            (quote
                                                                                                                             ())))))))))
                                                                                                                    (cons i
                                                                                                                     (cons
                                                                                                                      (quote
                                                                                                                       ())
                                                                                                                      (quote
                                                                                                                       ())))))) #f))
                                                                                                               (cdr v.246))) v.247))
                                                                                                           (car v.246)) #f))
                                                                                                        (cdr v.244))) v.245))
                                                                                                    (car v.244)) #f))
                                                                                                 (cdr v.242))) v.243))
                                                                                             (car v.242)) #f))
                                                                                          (cdr v.240))) v.241))
                                                                                      (car v.240)) #f))
                                                                                   (cdr v.232)) #f))
                                                                                (cdr v.237))) v.238))
                                                                            (car v.237)) #f))
                                                                         (cdr v.235)) #f))
                                                                      (car v.235)) #f))
                                                                   (cdr v.233))) v.234))
                                                               (car v.233)) #f))
                                                            (car v.232)) #f))
                                                         (cdr v.230))) v.231))
                                                     (car v.230)) #f))
                                                  (cdr expr)))))
                                              ((lambda
                                                (v.215)
                                                (if
                                                 (pair? v.215)
                                                 ((lambda
                                                   (v.216)
                                                   ((lambda
                                                     (v)
                                                     ((lambda
                                                       (v.217)
                                                       (if
                                                        (pair? v.217)
                                                        ((lambda
                                                          (v.218)
                                                          (if
                                                           (pair? v.218)
                                                           ((lambda
                                                             (v.219)
                                                             ((lambda
                                                               (p)
                                                               ((lambda
                                                                 (v.220)
                                                                 (if
                                                                  (null? v.220)
                                                                  ((lambda
                                                                    (v.221)
                                                                    (if
                                                                     (pair? v.221)
                                                                     ((lambda
                                                                       (v.222)
                                                                       ((lambda
                                                                         (g+s)
                                                                         ((lambda
                                                                           (v.223)
                                                                           (if
                                                                            (pair? v.223)
                                                                            ((lambda
                                                                              (v.224)
                                                                              ((lambda
                                                                                (sk)
                                                                                ((lambda
                                                                                  (v.225)
                                                                                  (if
                                                                                   (pair? v.225)
                                                                                   ((lambda
                                                                                     (v.226)
                                                                                     ((lambda
                                                                                       (fk)
                                                                                       ((lambda
                                                                                         (v.227)
                                                                                         (if
                                                                                          (pair? v.227)
                                                                                          ((lambda
                                                                                            (v.228)
                                                                                            ((lambda
                                                                                              (i)
                                                                                              ((lambda
                                                                                                (v.229)
                                                                                                (if
                                                                                                 (null? v.229)
                                                                                                 (cons
                                                                                                  (rename
                                                                                                   (quote if))
                                                                                                  (cons
                                                                                                   (cons
                                                                                                    (rename
                                                                                                     (quote and))
                                                                                                    (cons
                                                                                                     (cons
                                                                                                      (rename
                                                                                                       (quote pair?))
                                                                                                      (cons v
                                                                                                       (quote
                                                                                                        ())))
                                                                                                     (cons
                                                                                                      (cons
                                                                                                       (rename
                                                                                                        (quote null?))
                                                                                                       (cons
                                                                                                        (cons
                                                                                                         (rename
                                                                                                          (quote cdr))
                                                                                                         (cons v
                                                                                                          (quote
                                                                                                           ())))
                                                                                                        (quote
                                                                                                         ())))
                                                                                                      (quote
                                                                                                       ()))))
                                                                                                   (cons
                                                                                                    (cons
                                                                                                     (rename
                                                                                                      (quote let))
                                                                                                     (cons
                                                                                                      (cons
                                                                                                       (cons
                                                                                                        (rename
                                                                                                         (quote w))
                                                                                                        (cons
                                                                                                         (cons
                                                                                                          (rename
                                                                                                           (quote car))
                                                                                                          (cons v
                                                                                                           (quote
                                                                                                            ())))
                                                                                                         (quote
                                                                                                          ())))
                                                                                                       (quote
                                                                                                        ()))
                                                                                                      (cons
                                                                                                       (cons
                                                                                                        (rename
                                                                                                         (quote match-one))
                                                                                                        (cons
                                                                                                         (rename
                                                                                                          (quote w))
                                                                                                         (cons p
                                                                                                          (cons
                                                                                                           (cons
                                                                                                            (cons
                                                                                                             (rename
                                                                                                              (quote car))
                                                                                                             (cons v
                                                                                                              (quote
                                                                                                               ())))
                                                                                                            (cons
                                                                                                             (cons
                                                                                                              (rename
                                                                                                               (quote set-car!))
                                                                                                              (cons v
                                                                                                               (quote
                                                                                                                ())))
                                                                                                             (quote
                                                                                                              ())))
                                                                                                           (cons sk
                                                                                                            (cons fk
                                                                                                             (cons i
                                                                                                              (quote
                                                                                                               ()))))))))
                                                                                                       (quote
                                                                                                        ()))))
                                                                                                    (cons fk
                                                                                                     (quote
                                                                                                      ()))))) #f))
                                                                                               (cdr v.227))) v.228))
                                                                                           (car v.227)) #f))
                                                                                        (cdr v.225))) v.226))
                                                                                    (car v.225)) #f))
                                                                                 (cdr v.223))) v.224))
                                                                             (car v.223)) #f))
                                                                          (cdr v.221))) v.222))
                                                                      (car v.221)) #f))
                                                                   (cdr v.217)) #f))
                                                                (cdr v.218))) v.219))
                                                            (car v.218)) #f))
                                                         (car v.217)) #f))
                                                      (cdr v.215))) v.216))
                                                  (car v.215)) #f))
                                               (cdr expr)))))
                                           ((lambda
                                             (v.198)
                                             (if
                                              (pair? v.198)
                                              ((lambda
                                                (v.199)
                                                ((lambda
                                                  (v)
                                                  ((lambda
                                                    (v.200)
                                                    (if
                                                     (pair? v.200)
                                                     ((lambda
                                                       (v.201)
                                                       (if
                                                        (pair? v.201)
                                                        ((lambda
                                                          (v.202)
                                                          ((lambda
                                                            (p)
                                                            ((lambda
                                                              (v.203)
                                                              (if
                                                               (pair? v.203)
                                                               ((lambda
                                                                 (v.204)
                                                                 (if
                                                                  (compare v.204
                                                                   (quote ___))
                                                                  ((lambda
                                                                    (v.205)
                                                                    ((lambda
                                                                      (r)
                                                                      ((lambda
                                                                        (v.206)
                                                                        (if
                                                                         (pair? v.206)
                                                                         ((lambda
                                                                           (v.207)
                                                                           ((lambda
                                                                             (g+s)
                                                                             ((lambda
                                                                               (v.208)
                                                                               (if
                                                                                (pair? v.208)
                                                                                ((lambda
                                                                                  (v.209)
                                                                                  ((lambda
                                                                                    (sk)
                                                                                    ((lambda
                                                                                      (v.210)
                                                                                      (if
                                                                                       (pair? v.210)
                                                                                       ((lambda
                                                                                         (v.211)
                                                                                         ((lambda
                                                                                           (fk)
                                                                                           ((lambda
                                                                                             (v.212)
                                                                                             (if
                                                                                              (pair? v.212)
                                                                                              ((lambda
                                                                                                (v.213)
                                                                                                ((lambda
                                                                                                  (i)
                                                                                                  ((lambda
                                                                                                    (v.214)
                                                                                                    (if
                                                                                                     (null? v.214)
                                                                                                     (cons
                                                                                                      (rename
                                                                                                       (quote match-extract-vars))
                                                                                                      (cons p
                                                                                                       (cons
                                                                                                        (cons
                                                                                                         (rename
                                                                                                          (quote match-gen-ellipses))
                                                                                                         (cons v
                                                                                                          (cons p
                                                                                                           (cons r
                                                                                                            (cons g+s
                                                                                                             (cons sk
                                                                                                              (cons fk
                                                                                                               (cons i
                                                                                                                (quote
                                                                                                                 ())))))))))
                                                                                                        (cons i
                                                                                                         (cons
                                                                                                          (quote
                                                                                                           ())
                                                                                                          (quote
                                                                                                           ())))))) #f))
                                                                                                   (cdr v.212))) v.213))
                                                                                               (car v.212)) #f))
                                                                                            (cdr v.210))) v.211))
                                                                                        (car v.210)) #f))
                                                                                     (cdr v.208))) v.209))
                                                                                 (car v.208)) #f))
                                                                              (cdr v.206))) v.207))
                                                                          (car v.206)) #f))
                                                                       (cdr v.200))) v.205))
                                                                   (cdr v.203)) #f))
                                                                (car v.203)) #f))
                                                             (cdr v.201))) v.202))
                                                         (car v.201)) #f))
                                                      (car v.200)) #f))
                                                   (cdr v.198))) v.199))
                                               (car v.198)) #f))
                                            (cdr expr)))))
                                        ((lambda
                                          (v.187)
                                          (if
                                           (pair? v.187)
                                           ((lambda
                                             (v.188)
                                             ((lambda
                                               (v)
                                               ((lambda
                                                 (v.189)
                                                 (if
                                                  (pair? v.189)
                                                  ((lambda
                                                    (v.190)
                                                    (if
                                                     (pair? v.190)
                                                     ((lambda
                                                       (v.191)
                                                       (if
                                                        (compare v.191
                                                         (quote =))
                                                        ((lambda
                                                          (v.192)
                                                          (if
                                                           (pair? v.192)
                                                           ((lambda
                                                             (v.193)
                                                             ((lambda
                                                               (proc)
                                                               ((lambda
                                                                 (v.194)
                                                                 (if
                                                                  (pair? v.194)
                                                                  ((lambda
                                                                    (v.195)
                                                                    ((lambda
                                                                      (p)
                                                                      ((lambda
                                                                        (v.196)
                                                                        (if
                                                                         (null? v.196)
                                                                         ((lambda
                                                                           (v.197)
                                                                           ((lambda
                                                                             (x)
                                                                             (cons
                                                                              (rename
                                                                               (quote let))
                                                                              (cons
                                                                               (cons
                                                                                (cons
                                                                                 (rename
                                                                                  (quote w))
                                                                                 (cons
                                                                                  (cons proc
                                                                                   (cons v
                                                                                    (quote
                                                                                     ())))
                                                                                  (quote
                                                                                   ())))
                                                                                (quote
                                                                                 ()))
                                                                               (cons
                                                                                (cons
                                                                                 (rename
                                                                                  (quote match-one))
                                                                                 (cons
                                                                                  (rename
                                                                                   (quote w))
                                                                                  (cons p x)))
                                                                                (quote
                                                                                 ()))))) v.197))
                                                                          (cdr v.189)) #f))
                                                                       (cdr v.194))) v.195))
                                                                   (car v.194)) #f))
                                                                (cdr v.192))) v.193))
                                                            (car v.192)) #f))
                                                         (cdr v.190)) #f))
                                                      (car v.190)) #f))
                                                   (car v.189)) #f))
                                                (cdr v.187))) v.188))
                                            (car v.187)) #f))
                                         (cdr expr)))))
                                     ((lambda
                                       (v.170)
                                       (if
                                        (pair? v.170)
                                        ((lambda
                                          (v.171)
                                          ((lambda
                                            (v)
                                            ((lambda
                                              (v.172)
                                              (if
                                               (pair? v.172)
                                               ((lambda
                                                 (v.173)
                                                 (if
                                                  (pair? v.173)
                                                  ((lambda
                                                    (v.174)
                                                    (if
                                                     (compare v.174
                                                      (quote ?))
                                                     ((lambda
                                                       (v.175)
                                                       (if
                                                        (pair? v.175)
                                                        ((lambda
                                                          (v.176)
                                                          ((lambda
                                                            (pred)
                                                            ((lambda
                                                              (v.177)
                                                              ((lambda
                                                                (p)
                                                                ((lambda
                                                                  (v.178)
                                                                  (if
                                                                   (pair? v.178)
                                                                   ((lambda
                                                                     (v.179)
                                                                     ((lambda
                                                                       (g+s)
                                                                       ((lambda
                                                                         (v.180)
                                                                         (if
                                                                          (pair? v.180)
                                                                          ((lambda
                                                                            (v.181)
                                                                            ((lambda
                                                                              (sk)
                                                                              ((lambda
                                                                                (v.182)
                                                                                (if
                                                                                 (pair? v.182)
                                                                                 ((lambda
                                                                                   (v.183)
                                                                                   ((lambda
                                                                                     (fk)
                                                                                     ((lambda
                                                                                       (v.184)
                                                                                       (if
                                                                                        (pair? v.184)
                                                                                        ((lambda
                                                                                          (v.185)
                                                                                          ((lambda
                                                                                            (i)
                                                                                            ((lambda
                                                                                              (v.186)
                                                                                              (if
                                                                                               (null? v.186)
                                                                                               (cons
                                                                                                (rename
                                                                                                 (quote if))
                                                                                                (cons
                                                                                                 (cons pred
                                                                                                  (cons v
                                                                                                   (quote
                                                                                                    ())))
                                                                                                 (cons
                                                                                                  (cons
                                                                                                   (rename
                                                                                                    (quote match-one))
                                                                                                   (cons v
                                                                                                    (cons
                                                                                                     (cons
                                                                                                      (rename
                                                                                                       (quote and)) p)
                                                                                                     (cons g+s
                                                                                                      (cons sk
                                                                                                       (cons fk
                                                                                                        (cons i
                                                                                                         (quote
                                                                                                          ()))))))))
                                                                                                  (cons fk
                                                                                                   (quote
                                                                                                    ()))))) #f))
                                                                                             (cdr v.184))) v.185))
                                                                                         (car v.184)) #f))
                                                                                      (cdr v.182))) v.183))
                                                                                  (car v.182)) #f))
                                                                               (cdr v.180))) v.181))
                                                                           (car v.180)) #f))
                                                                        (cdr v.178))) v.179))
                                                                    (car v.178)) #f))
                                                                 (cdr v.172))) v.177))
                                                             (cdr v.175))) v.176))
                                                         (car v.175)) #f))
                                                      (cdr v.173)) #f))
                                                   (car v.173)) #f))
                                                (car v.172)) #f))
                                             (cdr v.170))) v.171))
                                         (car v.170)) #f))
                                      (cdr expr)))))
                                  ((lambda
                                    (v.149)
                                    (if
                                     (pair? v.149)
                                     ((lambda
                                       (v.150)
                                       ((lambda
                                         (v)
                                         ((lambda
                                           (v.151)
                                           (if
                                            (pair? v.151)
                                            ((lambda
                                              (v.152)
                                              (if
                                               (pair? v.152)
                                               ((lambda
                                                 (v.153)
                                                 (if
                                                  (compare v.153
                                                   (quote set!))
                                                  ((lambda
                                                    (v.154)
                                                    (if
                                                     (pair? v.154)
                                                     ((lambda
                                                       (v.155)
                                                       ((lambda
                                                         (setter)
                                                         ((lambda
                                                           (v.156)
                                                           (if
                                                            (null? v.156)
                                                            ((lambda
                                                              (v.157)
                                                              (if
                                                               (pair? v.157)
                                                               ((lambda
                                                                 (v.158)
                                                                 (if
                                                                  (pair? v.158)
                                                                  ((lambda
                                                                    (v.159)
                                                                    ((lambda
                                                                      (g)
                                                                      ((lambda
                                                                        (v.160)
                                                                        (if
                                                                         (pair? v.160)
                                                                         ((lambda
                                                                           (v.161)
                                                                           (if
                                                                            (list? v.161)
                                                                            ((lambda
                                                                              (s)
                                                                              ((lambda
                                                                                (v.162)
                                                                                (if
                                                                                 (null? v.162)
                                                                                 ((lambda
                                                                                   (v.163)
                                                                                   (if
                                                                                    (pair? v.163)
                                                                                    ((lambda
                                                                                      (v.164)
                                                                                      (if
                                                                                       (list? v.164)
                                                                                       ((lambda
                                                                                         (sk)
                                                                                         ((lambda
                                                                                           (v.165)
                                                                                           (if
                                                                                            (pair? v.165)
                                                                                            ((lambda
                                                                                              (v.166)
                                                                                              ((lambda
                                                                                                (fk)
                                                                                                ((lambda
                                                                                                  (v.167)
                                                                                                  (if
                                                                                                   (pair? v.167)
                                                                                                   ((lambda
                                                                                                     (v.168)
                                                                                                     ((lambda
                                                                                                       (i)
                                                                                                       ((lambda
                                                                                                         (v.169)
                                                                                                         (if
                                                                                                          (null? v.169)
                                                                                                          (cons
                                                                                                           (rename
                                                                                                            (quote let))
                                                                                                           (cons
                                                                                                            (cons
                                                                                                             (cons setter
                                                                                                              (cons
                                                                                                               (cons
                                                                                                                (rename
                                                                                                                 (quote lambda))
                                                                                                                (cons
                                                                                                                 (cons
                                                                                                                  (rename
                                                                                                                   (quote x))
                                                                                                                  (quote
                                                                                                                   ()))
                                                                                                                 (cons
                                                                                                                  (append
                                                                                                                   (map
                                                                                                                    (lambda
                                                                                                                     (s) s) s)
                                                                                                                   (cons
                                                                                                                    (rename
                                                                                                                     (quote x))
                                                                                                                    (quote
                                                                                                                     ())))
                                                                                                                  (quote
                                                                                                                   ()))))
                                                                                                               (quote
                                                                                                                ())))
                                                                                                             (quote
                                                                                                              ()))
                                                                                                            (cons
                                                                                                             (append
                                                                                                              (map
                                                                                                               (lambda
                                                                                                                (sk) sk) sk)
                                                                                                              (cons i
                                                                                                               (quote
                                                                                                                ())))
                                                                                                             (quote
                                                                                                              ())))) #f))
                                                                                                        (cdr v.167))) v.168))
                                                                                                    (car v.167)) #f))
                                                                                                 (cdr v.165))) v.166))
                                                                                             (car v.165)) #f))
                                                                                          (cdr v.163))) v.164) #f))
                                                                                     (car v.163)) #f))
                                                                                  (cdr v.157)) #f))
                                                                               (cdr v.160))) v.161) #f))
                                                                          (car v.160)) #f))
                                                                       (cdr v.158))) v.159))
                                                                   (car v.158)) #f))
                                                                (car v.157)) #f))
                                                             (cdr v.151)) #f))
                                                          (cdr v.154))) v.155))
                                                      (car v.154)) #f))
                                                   (cdr v.152)) #f))
                                                (car v.152)) #f))
                                             (car v.151)) #f))
                                          (cdr v.149))) v.150))
                                      (car v.149)) #f))
                                   (cdr expr)))))
                               ((lambda
                                 (v.128)
                                 (if
                                  (pair? v.128)
                                  ((lambda
                                    (v.129)
                                    ((lambda
                                      (v)
                                      ((lambda
                                        (v.130)
                                        (if
                                         (pair? v.130)
                                         ((lambda
                                           (v.131)
                                           (if
                                            (pair? v.131)
                                            ((lambda
                                              (v.132)
                                              (if
                                               (compare v.132
                                                (quote get!))
                                               ((lambda
                                                 (v.133)
                                                 (if
                                                  (pair? v.133)
                                                  ((lambda
                                                    (v.134)
                                                    ((lambda
                                                      (getter)
                                                      ((lambda
                                                        (v.135)
                                                        (if
                                                         (null? v.135)
                                                         ((lambda
                                                           (v.136)
                                                           (if
                                                            (pair? v.136)
                                                            ((lambda
                                                              (v.137)
                                                              (if
                                                               (pair? v.137)
                                                               ((lambda
                                                                 (v.138)
                                                                 ((lambda
                                                                   (g)
                                                                   ((lambda
                                                                     (v.139)
                                                                     (if
                                                                      (pair? v.139)
                                                                      ((lambda
                                                                        (v.140)
                                                                        ((lambda
                                                                          (s)
                                                                          ((lambda
                                                                            (v.141)
                                                                            (if
                                                                             (null? v.141)
                                                                             ((lambda
                                                                               (v.142)
                                                                               (if
                                                                                (pair? v.142)
                                                                                ((lambda
                                                                                  (v.143)
                                                                                  (if
                                                                                   (list? v.143)
                                                                                   ((lambda
                                                                                     (sk)
                                                                                     ((lambda
                                                                                       (v.144)
                                                                                       (if
                                                                                        (pair? v.144)
                                                                                        ((lambda
                                                                                          (v.145)
                                                                                          ((lambda
                                                                                            (fk)
                                                                                            ((lambda
                                                                                              (v.146)
                                                                                              (if
                                                                                               (pair? v.146)
                                                                                               ((lambda
                                                                                                 (v.147)
                                                                                                 ((lambda
                                                                                                   (i)
                                                                                                   ((lambda
                                                                                                     (v.148)
                                                                                                     (if
                                                                                                      (null? v.148)
                                                                                                      (cons
                                                                                                       (rename
                                                                                                        (quote let))
                                                                                                       (cons
                                                                                                        (cons
                                                                                                         (cons getter
                                                                                                          (cons
                                                                                                           (cons
                                                                                                            (rename
                                                                                                             (quote lambda))
                                                                                                            (cons
                                                                                                             (quote
                                                                                                              ())
                                                                                                             (cons g
                                                                                                              (quote
                                                                                                               ()))))
                                                                                                           (quote
                                                                                                            ())))
                                                                                                         (quote
                                                                                                          ()))
                                                                                                        (cons
                                                                                                         (append
                                                                                                          (map
                                                                                                           (lambda
                                                                                                            (sk) sk) sk)
                                                                                                          (cons i
                                                                                                           (quote
                                                                                                            ())))
                                                                                                         (quote
                                                                                                          ())))) #f))
                                                                                                    (cdr v.146))) v.147))
                                                                                                (car v.146)) #f))
                                                                                             (cdr v.144))) v.145))
                                                                                         (car v.144)) #f))
                                                                                      (cdr v.142))) v.143) #f))
                                                                                 (car v.142)) #f))
                                                                              (cdr v.136)) #f))
                                                                           (cdr v.139))) v.140))
                                                                       (car v.139)) #f))
                                                                    (cdr v.137))) v.138))
                                                                (car v.137)) #f))
                                                             (car v.136)) #f))
                                                          (cdr v.130)) #f))
                                                       (cdr v.133))) v.134))
                                                   (car v.133)) #f))
                                                (cdr v.131)) #f))
                                             (car v.131)) #f))
                                          (car v.130)) #f))
                                       (cdr v.128))) v.129))
                                   (car v.128)) #f))
                                (cdr expr)))))
                            ((lambda
                              (v.111)
                              (if
                               (pair? v.111)
                               ((lambda
                                 (v.112)
                                 ((lambda
                                   (v)
                                   ((lambda
                                     (v.113)
                                     (if
                                      (pair? v.113)
                                      ((lambda
                                        (v.114)
                                        (if
                                         (pair? v.114)
                                         ((lambda
                                           (v.115)
                                           (if
                                            (compare v.115
                                             (quote not))
                                            ((lambda
                                              (v.116)
                                              (if
                                               (pair? v.116)
                                               ((lambda
                                                 (v.117)
                                                 ((lambda
                                                   (p)
                                                   ((lambda
                                                     (v.118)
                                                     (if
                                                      (null? v.118)
                                                      ((lambda
                                                        (v.119)
                                                        (if
                                                         (pair? v.119)
                                                         ((lambda
                                                           (v.120)
                                                           ((lambda
                                                             (g+s)
                                                             ((lambda
                                                               (v.121)
                                                               (if
                                                                (pair? v.121)
                                                                ((lambda
                                                                  (v.122)
                                                                  (if
                                                                   (list? v.122)
                                                                   ((lambda
                                                                     (sk)
                                                                     ((lambda
                                                                       (v.123)
                                                                       (if
                                                                        (pair? v.123)
                                                                        ((lambda
                                                                          (v.124)
                                                                          ((lambda
                                                                            (fk)
                                                                            ((lambda
                                                                              (v.125)
                                                                              (if
                                                                               (pair? v.125)
                                                                               ((lambda
                                                                                 (v.126)
                                                                                 ((lambda
                                                                                   (i)
                                                                                   ((lambda
                                                                                     (v.127)
                                                                                     (if
                                                                                      (null? v.127)
                                                                                      (cons
                                                                                       (rename
                                                                                        (quote match-one))
                                                                                       (cons v
                                                                                        (cons p
                                                                                         (cons g+s
                                                                                          (cons
                                                                                           (cons
                                                                                            (rename
                                                                                             (quote match-drop-ids))
                                                                                            (cons fk
                                                                                             (quote
                                                                                              ())))
                                                                                           (cons
                                                                                            (append
                                                                                             (map
                                                                                              (lambda
                                                                                               (sk) sk) sk)
                                                                                             (cons i
                                                                                              (quote
                                                                                               ())))
                                                                                            (cons i
                                                                                             (quote
                                                                                              ())))))))) #f))
                                                                                    (cdr v.125))) v.126))
                                                                                (car v.125)) #f))
                                                                             (cdr v.123))) v.124))
                                                                         (car v.123)) #f))
                                                                      (cdr v.121))) v.122) #f))
                                                                 (car v.121)) #f))
                                                              (cdr v.119))) v.120))
                                                          (car v.119)) #f))
                                                       (cdr v.113)) #f))
                                                    (cdr v.116))) v.117))
                                                (car v.116)) #f))
                                             (cdr v.114)) #f))
                                          (car v.114)) #f))
                                       (car v.113)) #f))
                                    (cdr v.111))) v.112))
                                (car v.111)) #f))
                             (cdr expr)))))
                         ((lambda
                           (v.96)
                           (if
                            (pair? v.96)
                            ((lambda
                              (v.97)
                              ((lambda
                                (v)
                                ((lambda
                                  (v.98)
                                  (if
                                   (pair? v.98)
                                   ((lambda
                                     (v.99)
                                     (if
                                      (pair? v.99)
                                      ((lambda
                                        (v.100)
                                        (if
                                         (compare v.100
                                          (quote or))
                                         ((lambda
                                           (v.101)
                                           (if
                                            (list? v.101)
                                            ((lambda
                                              (p)
                                              ((lambda
                                                (v.102)
                                                (if
                                                 (pair? v.102)
                                                 ((lambda
                                                   (v.103)
                                                   ((lambda
                                                     (g+s)
                                                     ((lambda
                                                       (v.104)
                                                       (if
                                                        (pair? v.104)
                                                        ((lambda
                                                          (v.105)
                                                          ((lambda
                                                            (sk)
                                                            ((lambda
                                                              (v.106)
                                                              (if
                                                               (pair? v.106)
                                                               ((lambda
                                                                 (v.107)
                                                                 ((lambda
                                                                   (fk)
                                                                   ((lambda
                                                                     (v.108)
                                                                     (if
                                                                      (pair? v.108)
                                                                      ((lambda
                                                                        (v.109)
                                                                        ((lambda
                                                                          (i)
                                                                          ((lambda
                                                                            (v.110)
                                                                            (if
                                                                             (null? v.110)
                                                                             (cons
                                                                              (rename
                                                                               (quote match-extract-vars))
                                                                              (cons
                                                                               (cons
                                                                                (rename
                                                                                 (quote or))
                                                                                (map
                                                                                 (lambda
                                                                                  (p) p) p))
                                                                               (cons
                                                                                (cons
                                                                                 (rename
                                                                                  (quote match-gen-or))
                                                                                 (cons v
                                                                                  (cons
                                                                                   (map
                                                                                    (lambda
                                                                                     (p) p) p)
                                                                                   (cons g+s
                                                                                    (cons sk
                                                                                     (cons fk
                                                                                      (cons i
                                                                                       (quote
                                                                                        ()))))))))
                                                                                (cons i
                                                                                 (cons
                                                                                  (quote
                                                                                   ())
                                                                                  (quote
                                                                                   ())))))) #f))
                                                                           (cdr v.108))) v.109))
                                                                       (car v.108)) #f))
                                                                    (cdr v.106))) v.107))
                                                                (car v.106)) #f))
                                                             (cdr v.104))) v.105))
                                                         (car v.104)) #f))
                                                      (cdr v.102))) v.103))
                                                  (car v.102)) #f))
                                               (cdr v.98))) v.101) #f))
                                          (cdr v.99)) #f))
                                       (car v.99)) #f))
                                    (car v.98)) #f))
                                 (cdr v.96))) v.97))
                             (car v.96)) #f))
                          (cdr expr)))))
                      ((lambda
                        (v.87)
                        (if
                         (pair? v.87)
                         ((lambda
                           (v.88)
                           ((lambda
                             (v)
                             ((lambda
                               (v.89)
                               (if
                                (pair? v.89)
                                ((lambda
                                  (v.90)
                                  (if
                                   (pair? v.90)
                                   ((lambda
                                     (v.91)
                                     (if
                                      (compare v.91
                                       (quote or))
                                      ((lambda
                                        (v.92)
                                        (if
                                         (pair? v.92)
                                         ((lambda
                                           (v.93)
                                           ((lambda
                                             (p)
                                             ((lambda
                                               (v.94)
                                               (if
                                                (null? v.94)
                                                ((lambda
                                                  (v.95)
                                                  ((lambda
                                                    (x)
                                                    (cons
                                                     (rename
                                                      (quote match-one))
                                                     (cons v
                                                      (cons p x)))) v.95))
                                                 (cdr v.89)) #f))
                                              (cdr v.92))) v.93))
                                          (car v.92)) #f))
                                       (cdr v.90)) #f))
                                    (car v.90)) #f))
                                 (car v.89)) #f))
                              (cdr v.87))) v.88))
                          (car v.87)) #f))
                       (cdr expr)))))
                   ((lambda
                     (v.72)
                     (if
                      (pair? v.72)
                      ((lambda
                        (v.73)
                        ((lambda
                          (v)
                          ((lambda
                            (v.74)
                            (if
                             (pair? v.74)
                             ((lambda
                               (v.75)
                               (if
                                (pair? v.75)
                                ((lambda
                                  (v.76)
                                  (if
                                   (compare v.76
                                    (quote or))
                                   ((lambda
                                     (v.77)
                                     (if
                                      (null? v.77)
                                      ((lambda
                                        (v.78)
                                        (if
                                         (pair? v.78)
                                         ((lambda
                                           (v.79)
                                           ((lambda
                                             (g+s)
                                             ((lambda
                                               (v.80)
                                               (if
                                                (pair? v.80)
                                                ((lambda
                                                  (v.81)
                                                  ((lambda
                                                    (sk)
                                                    ((lambda
                                                      (v.82)
                                                      (if
                                                       (pair? v.82)
                                                       ((lambda
                                                         (v.83)
                                                         ((lambda
                                                           (fk)
                                                           ((lambda
                                                             (v.84)
                                                             (if
                                                              (pair? v.84)
                                                              ((lambda
                                                                (v.85)
                                                                ((lambda
                                                                  (i)
                                                                  ((lambda
                                                                    (v.86)
                                                                    (if
                                                                     (null? v.86) fk #f))
                                                                   (cdr v.84))) v.85))
                                                               (car v.84)) #f))
                                                            (cdr v.82))) v.83))
                                                        (car v.82)) #f))
                                                     (cdr v.80))) v.81))
                                                 (car v.80)) #f))
                                              (cdr v.78))) v.79))
                                          (car v.78)) #f))
                                       (cdr v.74)) #f))
                                    (cdr v.75)) #f))
                                 (car v.75)) #f))
                              (car v.74)) #f))
                           (cdr v.72))) v.73))
                       (car v.72)) #f))
                    (cdr expr)))))
                ((lambda
                  (v.55)
                  (if
                   (pair? v.55)
                   ((lambda
                     (v.56)
                     ((lambda
                       (v)
                       ((lambda
                         (v.57)
                         (if
                          (pair? v.57)
                          ((lambda
                            (v.58)
                            (if
                             (pair? v.58)
                             ((lambda
                               (v.59)
                               (if
                                (compare v.59
                                 (quote and))
                                ((lambda
                                  (v.60)
                                  (if
                                   (pair? v.60)
                                   ((lambda
                                     (v.61)
                                     ((lambda
                                       (p)
                                       ((lambda
                                         (v.62)
                                         (if
                                          (list? v.62)
                                          ((lambda
                                            (q)
                                            ((lambda
                                              (v.63)
                                              (if
                                               (pair? v.63)
                                               ((lambda
                                                 (v.64)
                                                 ((lambda
                                                   (g+s)
                                                   ((lambda
                                                     (v.65)
                                                     (if
                                                      (pair? v.65)
                                                      ((lambda
                                                        (v.66)
                                                        ((lambda
                                                          (sk)
                                                          ((lambda
                                                            (v.67)
                                                            (if
                                                             (pair? v.67)
                                                             ((lambda
                                                               (v.68)
                                                               ((lambda
                                                                 (fk)
                                                                 ((lambda
                                                                   (v.69)
                                                                   (if
                                                                    (pair? v.69)
                                                                    ((lambda
                                                                      (v.70)
                                                                      ((lambda
                                                                        (i)
                                                                        ((lambda
                                                                          (v.71)
                                                                          (if
                                                                           (null? v.71)
                                                                           (cons
                                                                            (rename
                                                                             (quote match-one))
                                                                            (cons v
                                                                             (cons p
                                                                              (cons g+s
                                                                               (cons
                                                                                (cons
                                                                                 (rename
                                                                                  (quote match-one))
                                                                                 (cons v
                                                                                  (cons
                                                                                   (cons
                                                                                    (rename
                                                                                     (quote and))
                                                                                    (map
                                                                                     (lambda
                                                                                      (q) q) q))
                                                                                   (cons g+s
                                                                                    (cons sk
                                                                                     (cons fk
                                                                                      (quote
                                                                                       ())))))))
                                                                                (cons fk
                                                                                 (cons i
                                                                                  (quote
                                                                                   ())))))))) #f))
                                                                         (cdr v.69))) v.70))
                                                                     (car v.69)) #f))
                                                                  (cdr v.67))) v.68))
                                                              (car v.67)) #f))
                                                           (cdr v.65))) v.66))
                                                       (car v.65)) #f))
                                                    (cdr v.63))) v.64))
                                                (car v.63)) #f))
                                             (cdr v.57))) v.62) #f))
                                        (cdr v.60))) v.61))
                                    (car v.60)) #f))
                                 (cdr v.58)) #f))
                              (car v.58)) #f))
                           (car v.57)) #f))
                        (cdr v.55))) v.56))
                    (car v.55)) #f))
                 (cdr expr)))))
             ((lambda
               (v.40)
               (if
                (pair? v.40)
                ((lambda
                  (v.41)
                  ((lambda
                    (v)
                    ((lambda
                      (v.42)
                      (if
                       (pair? v.42)
                       ((lambda
                         (v.43)
                         (if
                          (pair? v.43)
                          ((lambda
                            (v.44)
                            (if
                             (compare v.44
                              (quote and))
                             ((lambda
                               (v.45)
                               (if
                                (null? v.45)
                                ((lambda
                                  (v.46)
                                  (if
                                   (pair? v.46)
                                   ((lambda
                                     (v.47)
                                     ((lambda
                                       (g+s)
                                       ((lambda
                                         (v.48)
                                         (if
                                          (pair? v.48)
                                          ((lambda
                                            (v.49)
                                            (if
                                             (list? v.49)
                                             ((lambda
                                               (sk)
                                               ((lambda
                                                 (v.50)
                                                 (if
                                                  (pair? v.50)
                                                  ((lambda
                                                    (v.51)
                                                    ((lambda
                                                      (fk)
                                                      ((lambda
                                                        (v.52)
                                                        (if
                                                         (pair? v.52)
                                                         ((lambda
                                                           (v.53)
                                                           ((lambda
                                                             (i)
                                                             ((lambda
                                                               (v.54)
                                                               (if
                                                                (null? v.54)
                                                                (append
                                                                 (map
                                                                  (lambda
                                                                   (sk) sk) sk)
                                                                 (cons i
                                                                  (quote
                                                                   ()))) #f))
                                                              (cdr v.52))) v.53))
                                                          (car v.52)) #f))
                                                       (cdr v.50))) v.51))
                                                   (car v.50)) #f))
                                                (cdr v.48))) v.49) #f))
                                           (car v.48)) #f))
                                        (cdr v.46))) v.47))
                                    (car v.46)) #f))
                                 (cdr v.42)) #f))
                              (cdr v.43)) #f))
                           (car v.43)) #f))
                        (car v.42)) #f))
                     (cdr v.40))) v.41))
                 (car v.40)) #f))
              (cdr expr)))))
          ((lambda
            (v.31)
            (if
             (pair? v.31)
             ((lambda
               (v.32)
               ((lambda
                 (v)
                 ((lambda
                   (v.33)
                   (if
                    (pair? v.33)
                    ((lambda
                      (v.34)
                      (if
                       (pair? v.34)
                       ((lambda
                         (v.35)
                         (if
                          (compare v.35
                           (quote quasiquote))
                          ((lambda
                            (v.36)
                            (if
                             (pair? v.36)
                             ((lambda
                               (v.37)
                               ((lambda
                                 (p)
                                 ((lambda
                                   (v.38)
                                   (if
                                    (null? v.38)
                                    ((lambda
                                      (v.39)
                                      ((lambda
                                        (x)
                                        (cons
                                         (rename
                                          (quote match-quasiquote))
                                         (cons v
                                          (cons p x)))) v.39))
                                     (cdr v.33)) #f))
                                  (cdr v.36))) v.37))
                              (car v.36)) #f))
                           (cdr v.34)) #f))
                        (car v.34)) #f))
                     (car v.33)) #f))
                  (cdr v.31))) v.32))
              (car v.31)) #f))
           (cdr expr)))))
       ((lambda
         (v.14)
         (if
          (pair? v.14)
          ((lambda
            (v.15)
            ((lambda
              (v)
              ((lambda
                (v.16)
                (if
                 (pair? v.16)
                 ((lambda
                   (v.17)
                   (if
                    (pair? v.17)
                    ((lambda
                      (v.18)
                      (if
                       (compare v.18
                        (quote quote))
                       ((lambda
                         (v.19)
                         (if
                          (pair? v.19)
                          ((lambda
                            (v.20)
                            ((lambda
                              (p)
                              ((lambda
                                (v.21)
                                (if
                                 (null? v.21)
                                 ((lambda
                                   (v.22)
                                   (if
                                    (pair? v.22)
                                    ((lambda
                                      (v.23)
                                      ((lambda
                                        (g+s)
                                        ((lambda
                                          (v.24)
                                          (if
                                           (pair? v.24)
                                           ((lambda
                                             (v.25)
                                             (if
                                              (list? v.25)
                                              ((lambda
                                                (sk)
                                                ((lambda
                                                  (v.26)
                                                  (if
                                                   (pair? v.26)
                                                   ((lambda
                                                     (v.27)
                                                     ((lambda
                                                       (fk)
                                                       ((lambda
                                                         (v.28)
                                                         (if
                                                          (pair? v.28)
                                                          ((lambda
                                                            (v.29)
                                                            ((lambda
                                                              (i)
                                                              ((lambda
                                                                (v.30)
                                                                (if
                                                                 (null? v.30)
                                                                 (cons
                                                                  (rename
                                                                   (quote if))
                                                                  (cons
                                                                   (cons
                                                                    (rename
                                                                     (quote equal?))
                                                                    (cons v
                                                                     (cons
                                                                      (cons
                                                                       (rename
                                                                        (quote quote))
                                                                       (cons p
                                                                        (quote
                                                                         ())))
                                                                      (quote
                                                                       ()))))
                                                                   (cons
                                                                    (append
                                                                     (map
                                                                      (lambda
                                                                       (sk) sk) sk)
                                                                     (cons i
                                                                      (quote
                                                                       ())))
                                                                    (cons fk
                                                                     (quote
                                                                      ()))))) #f))
                                                               (cdr v.28))) v.29))
                                                           (car v.28)) #f))
                                                        (cdr v.26))) v.27))
                                                    (car v.26)) #f))
                                                 (cdr v.24))) v.25) #f))
                                            (car v.24)) #f))
                                         (cdr v.22))) v.23))
                                     (car v.22)) #f))
                                  (cdr v.16)) #f))
                               (cdr v.19))) v.20))
                           (car v.19)) #f))
                        (cdr v.17)) #f))
                     (car v.17)) #f))
                  (car v.16)) #f))
               (cdr v.14))) v.15))
           (car v.14)) #f))
        (cdr expr)))))
    ((lambda
      (v.1)
      (if
       (pair? v.1)
       ((lambda
         (v.2)
         ((lambda
           (v)
           ((lambda
             (v.3)
             (if
              (pair? v.3)
              ((lambda
                (v.4)
                (if
                 (null? v.4)
                 ((lambda
                   (v.5)
                   (if
                    (pair? v.5)
                    ((lambda
                      (v.6)
                      ((lambda
                        (g+s)
                        ((lambda
                          (v.7)
                          (if
                           (pair? v.7)
                           ((lambda
                             (v.8)
                             (if
                              (list? v.8)
                              ((lambda
                                (sk)
                                ((lambda
                                  (v.9)
                                  (if
                                   (pair? v.9)
                                   ((lambda
                                     (v.10)
                                     ((lambda
                                       (fk)
                                       ((lambda
                                         (v.11)
                                         (if
                                          (pair? v.11)
                                          ((lambda
                                            (v.12)
                                            ((lambda
                                              (i)
                                              ((lambda
                                                (v.13)
                                                (if
                                                 (null? v.13)
                                                 (cons
                                                  (rename
                                                   (quote if))
                                                  (cons
                                                   (cons
                                                    (rename
                                                     (quote null?))
                                                    (cons v
                                                     (quote
                                                      ())))
                                                   (cons
                                                    (append
                                                     (map
                                                      (lambda
                                                       (sk) sk) sk)
                                                     (cons i
                                                      (quote
                                                       ())))
                                                    (cons fk
                                                     (quote
                                                      ()))))) #f))
                                               (cdr v.11))) v.12))
                                           (car v.11)) #f))
                                        (cdr v.9))) v.10))
                                    (car v.9)) #f))
                                 (cdr v.7))) v.8) #f))
                            (car v.7)) #f))
                         (cdr v.5))) v.6))
                     (car v.5)) #f))
                  (cdr v.3)) #f))
               (car v.3)) #f))
            (cdr v.1))) v.2))
        (car v.1)) #f))
     (cdr expr))))))

(define-syntax match-quasiquote
 (er-macro-transformer
  (lambda
   (expr rename compare)
   ((lambda
     (tmp)
     (if tmp tmp
      ((lambda
        (tmp)
        (if tmp tmp
         ((lambda
           (tmp)
           (if tmp tmp
            ((lambda
              (tmp)
              (if tmp tmp
               ((lambda
                 (tmp)
                 (if tmp tmp
                  ((lambda
                    (tmp)
                    (if tmp tmp
                     ((lambda
                       (tmp)
                       (if tmp tmp
                        ((lambda
                          (tmp)
                          (if tmp tmp
                           (error "no expansion for"
                            (strip-syntactic-closures expr))))
                         ((lambda
                           (v.121)
                           (if
                            (pair? v.121)
                            ((lambda
                              (v.122)
                              ((lambda
                                (v)
                                ((lambda
                                  (v.123)
                                  (if
                                   (pair? v.123)
                                   ((lambda
                                     (v.124)
                                     ((lambda
                                       (x)
                                       ((lambda
                                         (v.125)
                                         (if
                                          (pair? v.125)
                                          ((lambda
                                            (v.126)
                                            ((lambda
                                              (g+s)
                                              ((lambda
                                                (v.127)
                                                (if
                                                 (pair? v.127)
                                                 ((lambda
                                                   (v.128)
                                                   ((lambda
                                                     (sk)
                                                     ((lambda
                                                       (v.129)
                                                       (if
                                                        (pair? v.129)
                                                        ((lambda
                                                          (v.130)
                                                          ((lambda
                                                            (fk)
                                                            ((lambda
                                                              (v.131)
                                                              (if
                                                               (pair? v.131)
                                                               ((lambda
                                                                 (v.132)
                                                                 ((lambda
                                                                   (i)
                                                                   ((lambda
                                                                     (v.133)
                                                                     ((lambda
                                                                       (depth)
                                                                       (cons
                                                                        (rename
                                                                         (quote match-one))
                                                                        (cons v
                                                                         (cons
                                                                          (cons
                                                                           (rename
                                                                            (quote quote))
                                                                           (cons x
                                                                            (quote
                                                                             ())))
                                                                          (cons g+s
                                                                           (cons sk
                                                                            (cons fk
                                                                             (cons i
                                                                              (quote
                                                                               ()))))))))) v.133))
                                                                    (cdr v.131))) v.132))
                                                                (car v.131)) #f))
                                                             (cdr v.129))) v.130))
                                                         (car v.129)) #f))
                                                      (cdr v.127))) v.128))
                                                  (car v.127)) #f))
                                               (cdr v.125))) v.126))
                                           (car v.125)) #f))
                                        (cdr v.123))) v.124))
                                    (car v.123)) #f))
                                 (cdr v.121))) v.122))
                             (car v.121)) #f))
                          (cdr expr)))))
                      ((lambda
                        (v.107)
                        (if
                         (pair? v.107)
                         ((lambda
                           (v.108)
                           ((lambda
                             (v)
                             ((lambda
                               (v.109)
                               (if
                                (pair? v.109)
                                ((lambda
                                  (v.110)
                                  (if
                                   (vector? v.110)
                                   ((lambda
                                     (v.111)
                                     (if
                                      (list? v.111)
                                      ((lambda
                                        (elt)
                                        ((lambda
                                          (v.112)
                                          (if
                                           (pair? v.112)
                                           ((lambda
                                             (v.113)
                                             ((lambda
                                               (g+s)
                                               ((lambda
                                                 (v.114)
                                                 (if
                                                  (pair? v.114)
                                                  ((lambda
                                                    (v.115)
                                                    ((lambda
                                                      (sk)
                                                      ((lambda
                                                        (v.116)
                                                        (if
                                                         (pair? v.116)
                                                         ((lambda
                                                           (v.117)
                                                           ((lambda
                                                             (fk)
                                                             ((lambda
                                                               (v.118)
                                                               (if
                                                                (pair? v.118)
                                                                ((lambda
                                                                  (v.119)
                                                                  ((lambda
                                                                    (i)
                                                                    ((lambda
                                                                      (v.120)
                                                                      ((lambda
                                                                        (depth)
                                                                        (cons
                                                                         (rename
                                                                          (quote if))
                                                                         (cons
                                                                          (cons
                                                                           (rename
                                                                            (quote vector?))
                                                                           (cons v
                                                                            (quote
                                                                             ())))
                                                                          (cons
                                                                           (cons
                                                                            (rename
                                                                             (quote let))
                                                                            (cons
                                                                             (cons
                                                                              (cons
                                                                               (rename
                                                                                (quote ls))
                                                                               (cons
                                                                                (cons
                                                                                 (rename
                                                                                  (quote vector->list))
                                                                                 (cons v
                                                                                  (quote
                                                                                   ())))
                                                                                (quote
                                                                                 ())))
                                                                              (quote
                                                                               ()))
                                                                             (cons
                                                                              (cons
                                                                               (rename
                                                                                (quote match-quasiquote))
                                                                               (cons
                                                                                (rename
                                                                                 (quote ls))
                                                                                (cons
                                                                                 (map
                                                                                  (lambda
                                                                                   (elt) elt) elt)
                                                                                 (cons g+s
                                                                                  (cons sk
                                                                                   (cons fk
                                                                                    (cons i depth)))))))
                                                                              (quote
                                                                               ()))))
                                                                           (cons fk
                                                                            (quote
                                                                             ())))))) v.120))
                                                                     (cdr v.118))) v.119))
                                                                 (car v.118)) #f))
                                                              (cdr v.116))) v.117))
                                                          (car v.116)) #f))
                                                       (cdr v.114))) v.115))
                                                   (car v.114)) #f))
                                                (cdr v.112))) v.113))
                                            (car v.112)) #f))
                                         (cdr v.109))) v.111) #f))
                                    (vector->list v.110)) #f))
                                 (car v.109)) #f))
                              (cdr v.107))) v.108))
                          (car v.107)) #f))
                       (cdr expr)))))
                   ((lambda
                     (v.92)
                     (if
                      (pair? v.92)
                      ((lambda
                        (v.93)
                        ((lambda
                          (v)
                          ((lambda
                            (v.94)
                            (if
                             (pair? v.94)
                             ((lambda
                               (v.95)
                               (if
                                (pair? v.95)
                                ((lambda
                                  (v.96)
                                  ((lambda
                                    (p)
                                    ((lambda
                                      (v.97)
                                      ((lambda
                                        (q)
                                        ((lambda
                                          (v.98)
                                          (if
                                           (pair? v.98)
                                           ((lambda
                                             (v.99)
                                             ((lambda
                                               (g+s)
                                               ((lambda
                                                 (v.100)
                                                 (if
                                                  (pair? v.100)
                                                  ((lambda
                                                    (v.101)
                                                    ((lambda
                                                      (sk)
                                                      ((lambda
                                                        (v.102)
                                                        (if
                                                         (pair? v.102)
                                                         ((lambda
                                                           (v.103)
                                                           ((lambda
                                                             (fk)
                                                             ((lambda
                                                               (v.104)
                                                               (if
                                                                (pair? v.104)
                                                                ((lambda
                                                                  (v.105)
                                                                  ((lambda
                                                                    (i)
                                                                    ((lambda
                                                                      (v.106)
                                                                      ((lambda
                                                                        (depth)
                                                                        (cons
                                                                         (rename
                                                                          (quote if))
                                                                         (cons
                                                                          (cons
                                                                           (rename
                                                                            (quote pair?))
                                                                           (cons v
                                                                            (quote
                                                                             ())))
                                                                          (cons
                                                                           (cons
                                                                            (rename
                                                                             (quote let))
                                                                            (cons
                                                                             (cons
                                                                              (cons
                                                                               (rename
                                                                                (quote w))
                                                                               (cons
                                                                                (cons
                                                                                 (rename
                                                                                  (quote car))
                                                                                 (cons v
                                                                                  (quote
                                                                                   ())))
                                                                                (quote
                                                                                 ())))
                                                                              (cons
                                                                               (cons
                                                                                (rename
                                                                                 (quote x))
                                                                                (cons
                                                                                 (cons
                                                                                  (rename
                                                                                   (quote cdr))
                                                                                  (cons v
                                                                                   (quote
                                                                                    ())))
                                                                                 (quote
                                                                                  ())))
                                                                               (quote
                                                                                ())))
                                                                             (cons
                                                                              (cons
                                                                               (rename
                                                                                (quote match-quasiquote))
                                                                               (cons
                                                                                (rename
                                                                                 (quote w))
                                                                                (cons p
                                                                                 (cons g+s
                                                                                  (cons
                                                                                   (cons
                                                                                    (rename
                                                                                     (quote match-quasiquote-step))
                                                                                    (cons
                                                                                     (rename
                                                                                      (quote x))
                                                                                     (cons q
                                                                                      (cons g+s
                                                                                       (cons sk
                                                                                        (cons fk
                                                                                         (cons depth
                                                                                          (quote
                                                                                           ()))))))))
                                                                                   (cons fk
                                                                                    (cons i depth)))))))
                                                                              (quote
                                                                               ()))))
                                                                           (cons fk
                                                                            (quote
                                                                             ())))))) v.106))
                                                                     (cdr v.104))) v.105))
                                                                 (car v.104)) #f))
                                                              (cdr v.102))) v.103))
                                                          (car v.102)) #f))
                                                       (cdr v.100))) v.101))
                                                   (car v.100)) #f))
                                                (cdr v.98))) v.99))
                                            (car v.98)) #f))
                                         (cdr v.94))) v.97))
                                     (cdr v.95))) v.96))
                                 (car v.95)) #f))
                              (car v.94)) #f))
                           (cdr v.92))) v.93))
                       (car v.92)) #f))
                    (cdr expr)))))
                ((lambda
                  (v.73)
                  (if
                   (pair? v.73)
                   ((lambda
                     (v.74)
                     ((lambda
                       (v)
                       ((lambda
                         (v.75)
                         (if
                          (pair? v.75)
                          ((lambda
                            (v.76)
                            (if
                             (pair? v.76)
                             ((lambda
                               (v.77)
                               (if
                                (compare v.77
                                 (quote unquote-splicing))
                                ((lambda
                                  (v.78)
                                  (if
                                   (pair? v.78)
                                   ((lambda
                                     (v.79)
                                     ((lambda
                                       (p)
                                       ((lambda
                                         (v.80)
                                         (if
                                          (null? v.80)
                                          ((lambda
                                            (v.81)
                                            (if
                                             (pair? v.81)
                                             ((lambda
                                               (v.82)
                                               ((lambda
                                                 (g+s)
                                                 ((lambda
                                                   (v.83)
                                                   (if
                                                    (pair? v.83)
                                                    ((lambda
                                                      (v.84)
                                                      ((lambda
                                                        (sk)
                                                        ((lambda
                                                          (v.85)
                                                          (if
                                                           (pair? v.85)
                                                           ((lambda
                                                             (v.86)
                                                             ((lambda
                                                               (fk)
                                                               ((lambda
                                                                 (v.87)
                                                                 (if
                                                                  (pair? v.87)
                                                                  ((lambda
                                                                    (v.88)
                                                                    ((lambda
                                                                      (i)
                                                                      ((lambda
                                                                        (v.89)
                                                                        (if
                                                                         (pair? v.89)
                                                                         ((lambda
                                                                           (v.90)
                                                                           ((lambda
                                                                             (x)
                                                                             ((lambda
                                                                               (v.91)
                                                                               ((lambda
                                                                                 (depth)
                                                                                 (cons
                                                                                  (rename
                                                                                   (quote match-quasiquote))
                                                                                  (cons v
                                                                                   (cons p
                                                                                    (cons g+s
                                                                                     (cons sk
                                                                                      (cons fk
                                                                                       (cons i depth)))))))) v.91))
                                                                              (cdr v.89))) v.90))
                                                                          (car v.89)) #f))
                                                                       (cdr v.87))) v.88))
                                                                   (car v.87)) #f))
                                                                (cdr v.85))) v.86))
                                                            (car v.85)) #f))
                                                         (cdr v.83))) v.84))
                                                     (car v.83)) #f))
                                                  (cdr v.81))) v.82))
                                              (car v.81)) #f))
                                           (cdr v.75)) #f))
                                        (cdr v.78))) v.79))
                                    (car v.78)) #f))
                                 (cdr v.76)) #f))
                              (car v.76)) #f))
                           (car v.75)) #f))
                        (cdr v.73))) v.74))
                    (car v.73)) #f))
                 (cdr expr)))))
             ((lambda
               (v.54)
               (if
                (pair? v.54)
                ((lambda
                  (v.55)
                  ((lambda
                    (v)
                    ((lambda
                      (v.56)
                      (if
                       (pair? v.56)
                       ((lambda
                         (v.57)
                         (if
                          (pair? v.57)
                          ((lambda
                            (v.58)
                            (if
                             (compare v.58
                              (quote unquote))
                             ((lambda
                               (v.59)
                               (if
                                (pair? v.59)
                                ((lambda
                                  (v.60)
                                  ((lambda
                                    (p)
                                    ((lambda
                                      (v.61)
                                      (if
                                       (null? v.61)
                                       ((lambda
                                         (v.62)
                                         (if
                                          (pair? v.62)
                                          ((lambda
                                            (v.63)
                                            ((lambda
                                              (g+s)
                                              ((lambda
                                                (v.64)
                                                (if
                                                 (pair? v.64)
                                                 ((lambda
                                                   (v.65)
                                                   ((lambda
                                                     (sk)
                                                     ((lambda
                                                       (v.66)
                                                       (if
                                                        (pair? v.66)
                                                        ((lambda
                                                          (v.67)
                                                          ((lambda
                                                            (fk)
                                                            ((lambda
                                                              (v.68)
                                                              (if
                                                               (pair? v.68)
                                                               ((lambda
                                                                 (v.69)
                                                                 ((lambda
                                                                   (i)
                                                                   ((lambda
                                                                     (v.70)
                                                                     (if
                                                                      (pair? v.70)
                                                                      ((lambda
                                                                        (v.71)
                                                                        ((lambda
                                                                          (x)
                                                                          ((lambda
                                                                            (v.72)
                                                                            ((lambda
                                                                              (depth)
                                                                              (cons
                                                                               (rename
                                                                                (quote match-quasiquote))
                                                                               (cons v
                                                                                (cons p
                                                                                 (cons g+s
                                                                                  (cons sk
                                                                                   (cons fk
                                                                                    (cons i depth)))))))) v.72))
                                                                           (cdr v.70))) v.71))
                                                                       (car v.70)) #f))
                                                                    (cdr v.68))) v.69))
                                                                (car v.68)) #f))
                                                             (cdr v.66))) v.67))
                                                         (car v.66)) #f))
                                                      (cdr v.64))) v.65))
                                                  (car v.64)) #f))
                                               (cdr v.62))) v.63))
                                           (car v.62)) #f))
                                        (cdr v.56)) #f))
                                     (cdr v.59))) v.60))
                                 (car v.59)) #f))
                              (cdr v.57)) #f))
                           (car v.57)) #f))
                        (car v.56)) #f))
                     (cdr v.54))) v.55))
                 (car v.54)) #f))
              (cdr expr)))))
          ((lambda
            (v.37)
            (if
             (pair? v.37)
             ((lambda
               (v.38)
               ((lambda
                 (v)
                 ((lambda
                   (v.39)
                   (if
                    (pair? v.39)
                    ((lambda
                      (v.40)
                      (if
                       (pair? v.40)
                       ((lambda
                         (v.41)
                         (if
                          (compare v.41
                           (quote quasiquote))
                          ((lambda
                            (v.42)
                            (if
                             (pair? v.42)
                             ((lambda
                               (v.43)
                               ((lambda
                                 (p)
                                 ((lambda
                                   (v.44)
                                   (if
                                    (null? v.44)
                                    ((lambda
                                      (v.45)
                                      (if
                                       (pair? v.45)
                                       ((lambda
                                         (v.46)
                                         ((lambda
                                           (g+s)
                                           ((lambda
                                             (v.47)
                                             (if
                                              (pair? v.47)
                                              ((lambda
                                                (v.48)
                                                ((lambda
                                                  (sk)
                                                  ((lambda
                                                    (v.49)
                                                    (if
                                                     (pair? v.49)
                                                     ((lambda
                                                       (v.50)
                                                       ((lambda
                                                         (fk)
                                                         ((lambda
                                                           (v.51)
                                                           (if
                                                            (pair? v.51)
                                                            ((lambda
                                                              (v.52)
                                                              ((lambda
                                                                (i)
                                                                ((lambda
                                                                  (v.53)
                                                                  ((lambda
                                                                    (depth)
                                                                    (cons
                                                                     (rename
                                                                      (quote match-quasiquote))
                                                                     (cons v
                                                                      (cons p
                                                                       (cons g+s
                                                                        (cons sk
                                                                         (cons fk
                                                                          (cons i
                                                                           (cons #f depth))))))))) v.53))
                                                                 (cdr v.51))) v.52))
                                                             (car v.51)) #f))
                                                          (cdr v.49))) v.50))
                                                      (car v.49)) #f))
                                                   (cdr v.47))) v.48))
                                               (car v.47)) #f))
                                            (cdr v.45))) v.46))
                                        (car v.45)) #f))
                                     (cdr v.39)) #f))
                                  (cdr v.42))) v.43))
                              (car v.42)) #f))
                           (cdr v.40)) #f))
                        (car v.40)) #f))
                     (car v.39)) #f))
                  (cdr v.37))) v.38))
              (car v.37)) #f))
           (cdr expr)))))
       ((lambda
         (v.18)
         (if
          (pair? v.18)
          ((lambda
            (v.19)
            ((lambda
              (v)
              ((lambda
                (v.20)
                (if
                 (pair? v.20)
                 ((lambda
                   (v.21)
                   (if
                    (pair? v.21)
                    ((lambda
                      (v.22)
                      (if
                       (pair? v.22)
                       ((lambda
                         (v.23)
                         (if
                          (compare v.23
                           (quote unquote-splicing))
                          ((lambda
                            (v.24)
                            (if
                             (pair? v.24)
                             ((lambda
                               (v.25)
                               ((lambda
                                 (p)
                                 ((lambda
                                   (v.26)
                                   (if
                                    (null? v.26)
                                    ((lambda
                                      (v.27)
                                      ((lambda
                                        (rest)
                                        ((lambda
                                          (v.28)
                                          (if
                                           (pair? v.28)
                                           ((lambda
                                             (v.29)
                                             ((lambda
                                               (g+s)
                                               ((lambda
                                                 (v.30)
                                                 (if
                                                  (pair? v.30)
                                                  ((lambda
                                                    (v.31)
                                                    ((lambda
                                                      (sk)
                                                      ((lambda
                                                        (v.32)
                                                        (if
                                                         (pair? v.32)
                                                         ((lambda
                                                           (v.33)
                                                           ((lambda
                                                             (fk)
                                                             ((lambda
                                                               (v.34)
                                                               (if
                                                                (pair? v.34)
                                                                ((lambda
                                                                  (v.35)
                                                                  ((lambda
                                                                    (i)
                                                                    ((lambda
                                                                      (v.36)
                                                                      (if
                                                                       (null? v.36)
                                                                       (cons
                                                                        (rename
                                                                         (quote if))
                                                                        (cons
                                                                         (cons
                                                                          (rename
                                                                           (quote pair?))
                                                                          (cons v
                                                                           (quote
                                                                            ())))
                                                                         (cons
                                                                          (cons
                                                                           (rename
                                                                            (quote match-one))
                                                                           (cons v
                                                                            (cons
                                                                             (cons p
                                                                              (rename
                                                                               (quote tmp)))
                                                                             (cons
                                                                              (cons
                                                                               (rename
                                                                                (quote match-quasiquote))
                                                                               (cons
                                                                                (rename
                                                                                 (quote tmp))
                                                                                (cons rest
                                                                                 (cons g+s
                                                                                  (cons sk
                                                                                   (cons fk
                                                                                    (quote
                                                                                     ())))))))
                                                                              (cons fk
                                                                               (cons i
                                                                                (quote
                                                                                 ())))))))
                                                                          (cons fk
                                                                           (quote
                                                                            ()))))) #f))
                                                                     (cdr v.34))) v.35))
                                                                 (car v.34)) #f))
                                                              (cdr v.32))) v.33))
                                                          (car v.32)) #f))
                                                       (cdr v.30))) v.31))
                                                   (car v.30)) #f))
                                                (cdr v.28))) v.29))
                                            (car v.28)) #f))
                                         (cdr v.20))) v.27))
                                     (cdr v.21)) #f))
                                  (cdr v.24))) v.25))
                              (car v.24)) #f))
                           (cdr v.22)) #f))
                        (car v.22)) #f))
                     (car v.21)) #f))
                  (car v.20)) #f))
               (cdr v.18))) v.19))
           (car v.18)) #f))
        (cdr expr)))))
    ((lambda
      (v.1)
      (if
       (pair? v.1)
       ((lambda
         (v.2)
         ((lambda
           (v)
           ((lambda
             (v.3)
             (if
              (pair? v.3)
              ((lambda
                (v.4)
                (if
                 (pair? v.4)
                 ((lambda
                   (v.5)
                   (if
                    (compare v.5
                     (quote unquote))
                    ((lambda
                      (v.6)
                      (if
                       (pair? v.6)
                       ((lambda
                         (v.7)
                         ((lambda
                           (p)
                           ((lambda
                             (v.8)
                             (if
                              (null? v.8)
                              ((lambda
                                (v.9)
                                (if
                                 (pair? v.9)
                                 ((lambda
                                   (v.10)
                                   ((lambda
                                     (g+s)
                                     ((lambda
                                       (v.11)
                                       (if
                                        (pair? v.11)
                                        ((lambda
                                          (v.12)
                                          ((lambda
                                            (sk)
                                            ((lambda
                                              (v.13)
                                              (if
                                               (pair? v.13)
                                               ((lambda
                                                 (v.14)
                                                 ((lambda
                                                   (fk)
                                                   ((lambda
                                                     (v.15)
                                                     (if
                                                      (pair? v.15)
                                                      ((lambda
                                                        (v.16)
                                                        ((lambda
                                                          (i)
                                                          ((lambda
                                                            (v.17)
                                                            (if
                                                             (null? v.17)
                                                             (cons
                                                              (rename
                                                               (quote match-one))
                                                              (cons v
                                                               (cons p
                                                                (cons g+s
                                                                 (cons sk
                                                                  (cons fk
                                                                   (cons i
                                                                    (quote
                                                                     ())))))))) #f))
                                                           (cdr v.15))) v.16))
                                                       (car v.15)) #f))
                                                    (cdr v.13))) v.14))
                                                (car v.13)) #f))
                                             (cdr v.11))) v.12))
                                         (car v.11)) #f))
                                      (cdr v.9))) v.10))
                                  (car v.9)) #f))
                               (cdr v.3)) #f))
                            (cdr v.6))) v.7))
                        (car v.6)) #f))
                     (cdr v.4)) #f))
                  (car v.4)) #f))
               (car v.3)) #f))
            (cdr v.1))) v.2))
        (car v.1)) #f))
     (cdr expr))))))

(define-syntax match-quasiquote-step
 (er-macro-transformer
  (lambda
   (expr rename compare)
   ((lambda
     (tmp)
     (if tmp tmp
      (error "no expansion for"
       (strip-syntactic-closures expr))))
    ((lambda
      (v.1)
      (if
       (pair? v.1)
       ((lambda
         (v.2)
         ((lambda
           (x)
           ((lambda
             (v.3)
             (if
              (pair? v.3)
              ((lambda
                (v.4)
                ((lambda
                  (q)
                  ((lambda
                    (v.5)
                    (if
                     (pair? v.5)
                     ((lambda
                       (v.6)
                       ((lambda
                         (g+s)
                         ((lambda
                           (v.7)
                           (if
                            (pair? v.7)
                            ((lambda
                              (v.8)
                              ((lambda
                                (sk)
                                ((lambda
                                  (v.9)
                                  (if
                                   (pair? v.9)
                                   ((lambda
                                     (v.10)
                                     ((lambda
                                       (fk)
                                       ((lambda
                                         (v.11)
                                         (if
                                          (pair? v.11)
                                          ((lambda
                                            (v.12)
                                            ((lambda
                                              (depth)
                                              ((lambda
                                                (v.13)
                                                (if
                                                 (pair? v.13)
                                                 ((lambda
                                                   (v.14)
                                                   ((lambda
                                                     (i)
                                                     ((lambda
                                                       (v.15)
                                                       (if
                                                        (null? v.15)
                                                        (cons
                                                         (rename
                                                          (quote match-quasiquote))
                                                         (cons x
                                                          (cons q
                                                           (cons g+s
                                                            (cons sk
                                                             (cons fk
                                                              (cons i depth))))))) #f))
                                                      (cdr v.13))) v.14))
                                                  (car v.13)) #f))
                                               (cdr v.11))) v.12))
                                           (car v.11)) #f))
                                        (cdr v.9))) v.10))
                                    (car v.9)) #f))
                                 (cdr v.7))) v.8))
                             (car v.7)) #f))
                          (cdr v.5))) v.6))
                      (car v.5)) #f))
                   (cdr v.3))) v.4))
               (car v.3)) #f))
            (cdr v.1))) v.2))
        (car v.1)) #f))
     (cdr expr))))))

(define-syntax match-drop-ids
 (er-macro-transformer
  (lambda
   (expr rename compare)
   ((lambda
     (tmp)
     (if tmp tmp
      (error "no expansion for"
       (strip-syntactic-closures expr))))
    ((lambda
      (v.1)
      (if
       (pair? v.1)
       ((lambda
         (v.2)
         ((lambda
           (expr)
           ((lambda
             (v.3)
             (if
              (list? v.3)
              ((lambda
                (ids) expr) v.3) #f))
            (cdr v.1))) v.2))
        (car v.1)) #f))
     (cdr expr))))))

(define-syntax match-drop-first-arg
 (er-macro-transformer
  (lambda
   (expr rename compare)
   ((lambda
     (tmp)
     (if tmp tmp
      (error "no expansion for"
       (strip-syntactic-closures expr))))
    ((lambda
      (v.1)
      (if
       (pair? v.1)
       ((lambda
         (v.2)
         ((lambda
           (arg)
           ((lambda
             (v.3)
             (if
              (pair? v.3)
              ((lambda
                (v.4)
                ((lambda
                  (expr)
                  ((lambda
                    (v.5)
                    (if
                     (null? v.5) expr #f))
                   (cdr v.3))) v.4))
               (car v.3)) #f))
            (cdr v.1))) v.2))
        (car v.1)) #f))
     (cdr expr))))))

(define-syntax match-gen-or
 (er-macro-transformer
  (lambda
   (expr rename compare)
   ((lambda
     (tmp)
     (if tmp tmp
      (error "no expansion for"
       (strip-syntactic-closures expr))))
    ((lambda
      (v.1)
      (if
       (pair? v.1)
       ((lambda
         (v.2)
         ((lambda
           (v)
           ((lambda
             (v.3)
             (if
              (pair? v.3)
              ((lambda
                (v.4)
                ((lambda
                  (p)
                  ((lambda
                    (v.5)
                    (if
                     (pair? v.5)
                     ((lambda
                       (v.6)
                       ((lambda
                         (g+s)
                         ((lambda
                           (v.7)
                           (if
                            (pair? v.7)
                            ((lambda
                              (v.8)
                              (if
                               (list? v.8)
                               ((lambda
                                 (sk)
                                 ((lambda
                                   (v.9)
                                   (if
                                    (pair? v.9)
                                    ((lambda
                                      (v.10)
                                      ((lambda
                                        (fk)
                                        ((lambda
                                          (v.11)
                                          (if
                                           (pair? v.11)
                                           ((lambda
                                             (v.12)
                                             (if
                                              (list? v.12)
                                              ((lambda
                                                (i)
                                                ((lambda
                                                  (v.13)
                                                  (if
                                                   (pair? v.13)
                                                   ((lambda
                                                     (v.14)
                                                     ((lambda
                                                       ()
                                                       (define lp #f)
                                                       (set! lp
                                                        (lambda
                                                         (v.15 id-ls id-ls-ls)
                                                         (if
                                                          (null? v.15)
                                                          ((lambda
                                                            (id id-ls)
                                                            ((lambda
                                                              (v.21)
                                                              (if
                                                               (null? v.21)
                                                               (cons
                                                                (rename
                                                                 (quote let))
                                                                (cons
                                                                 (cons
                                                                  (cons
                                                                   (rename
                                                                    (quote sk2))
                                                                   (cons
                                                                    (cons
                                                                     (rename
                                                                      (quote lambda))
                                                                     (cons
                                                                      (map
                                                                       (lambda
                                                                        (id) id) id)
                                                                      (cons
                                                                       (append
                                                                        (map
                                                                         (lambda
                                                                          (sk) sk) sk)
                                                                        (cons
                                                                         (append
                                                                          (map
                                                                           (lambda
                                                                            (i) i) i)
                                                                          (map
                                                                           (lambda
                                                                            (id) id) id))
                                                                         (quote
                                                                          ())))
                                                                       (quote
                                                                        ()))))
                                                                    (quote
                                                                     ())))
                                                                  (quote
                                                                   ()))
                                                                 (cons
                                                                  (cons
                                                                   (rename
                                                                    (quote match-gen-or-step))
                                                                   (cons v
                                                                    (cons p
                                                                     (cons g+s
                                                                      (cons
                                                                       (cons
                                                                        (rename
                                                                         (quote match-drop-ids))
                                                                        (cons
                                                                         (cons
                                                                          (rename
                                                                           (quote sk2))
                                                                          (map
                                                                           (lambda
                                                                            (id) id) id))
                                                                         (quote
                                                                          ())))
                                                                       (cons fk
                                                                        (cons
                                                                         (map
                                                                          (lambda
                                                                           (i) i) i)
                                                                         (quote
                                                                          ()))))))))
                                                                  (quote
                                                                   ())))) #f))
                                                             (cdr v.13)))
                                                           (reverse id-ls)
                                                           (reverse id-ls-ls))
                                                          (if
                                                           (pair? v.15)
                                                           ((lambda
                                                             (v.16)
                                                             (if
                                                              (pair? v.16)
                                                              ((lambda
                                                                (v.17)
                                                                ((lambda
                                                                  (id)
                                                                  ((lambda
                                                                    (v.18)
                                                                    (if
                                                                     (pair? v.18)
                                                                     ((lambda
                                                                       (v.19)
                                                                       ((lambda
                                                                         (id-ls.1)
                                                                         ((lambda
                                                                           (v.20)
                                                                           (if
                                                                            (null? v.20)
                                                                            (lp
                                                                             (cdr v.15)
                                                                             (cons id id-ls)
                                                                             (cons id-ls.1 id-ls-ls)) #f))
                                                                          (cdr v.18))) v.19))
                                                                      (car v.18)) #f))
                                                                   (cdr v.16))) v.17))
                                                               (car v.16)) #f))
                                                            (car v.15)) #f)))) #<undef>
                                                       (lp v.14
                                                        ()
                                                        ()))))
                                                    (car v.13)) #f))
                                                 (cdr v.11))) v.12) #f))
                                            (car v.11)) #f))
                                         (cdr v.9))) v.10))
                                     (car v.9)) #f))
                                  (cdr v.7))) v.8) #f))
                             (car v.7)) #f))
                          (cdr v.5))) v.6))
                      (car v.5)) #f))
                   (cdr v.3))) v.4))
               (car v.3)) #f))
            (cdr v.1))) v.2))
        (car v.1)) #f))
     (cdr expr))))))

(define-syntax match-gen-or-step
 (er-macro-transformer
  (lambda
   (expr rename compare)
   ((lambda
     (tmp)
     (if tmp tmp
      ((lambda
        (tmp)
        (if tmp tmp
         ((lambda
           (tmp)
           (if tmp tmp
            (error "no expansion for"
             (strip-syntactic-closures expr))))
          ((lambda
            (v.19)
            (if
             (pair? v.19)
             ((lambda
               (v.20)
               ((lambda
                 (v)
                 ((lambda
                   (v.21)
                   (if
                    (pair? v.21)
                    ((lambda
                      (v.22)
                      (if
                       (pair? v.22)
                       ((lambda
                         (v.23)
                         ((lambda
                           (p)
                           ((lambda
                             (v.24)
                             ((lambda
                               (q)
                               ((lambda
                                 (v.25)
                                 (if
                                  (pair? v.25)
                                  ((lambda
                                    (v.26)
                                    ((lambda
                                      (g+s)
                                      ((lambda
                                        (v.27)
                                        (if
                                         (pair? v.27)
                                         ((lambda
                                           (v.28)
                                           ((lambda
                                             (sk)
                                             ((lambda
                                               (v.29)
                                               (if
                                                (pair? v.29)
                                                ((lambda
                                                  (v.30)
                                                  ((lambda
                                                    (fk)
                                                    ((lambda
                                                      (v.31)
                                                      (if
                                                       (pair? v.31)
                                                       ((lambda
                                                         (v.32)
                                                         ((lambda
                                                           (i)
                                                           ((lambda
                                                             (v.33)
                                                             (if
                                                              (null? v.33)
                                                              (cons
                                                               (rename
                                                                (quote match-one))
                                                               (cons v
                                                                (cons p
                                                                 (cons g+s
                                                                  (cons sk
                                                                   (cons
                                                                    (cons
                                                                     (rename
                                                                      (quote match-gen-or-step))
                                                                     (cons v
                                                                      (cons q
                                                                       (cons g+s
                                                                        (cons sk
                                                                         (cons fk
                                                                          (cons i
                                                                           (quote
                                                                            ()))))))))
                                                                    (cons i
                                                                     (quote
                                                                      ())))))))) #f))
                                                            (cdr v.31))) v.32))
                                                        (car v.31)) #f))
                                                     (cdr v.29))) v.30))
                                                 (car v.29)) #f))
                                              (cdr v.27))) v.28))
                                          (car v.27)) #f))
                                       (cdr v.25))) v.26))
                                   (car v.25)) #f))
                                (cdr v.21))) v.24))
                            (cdr v.22))) v.23))
                        (car v.22)) #f))
                     (car v.21)) #f))
                  (cdr v.19))) v.20))
              (car v.19)) #f))
           (cdr expr)))))
       ((lambda
         (v.12)
         (if
          (pair? v.12)
          ((lambda
            (v.13)
            ((lambda
              (v)
              ((lambda
                (v.14)
                (if
                 (pair? v.14)
                 ((lambda
                   (v.15)
                   (if
                    (pair? v.15)
                    ((lambda
                      (v.16)
                      ((lambda
                        (p)
                        ((lambda
                          (v.17)
                          (if
                           (null? v.17)
                           ((lambda
                             (v.18)
                             ((lambda
                               (x)
                               (cons
                                (rename
                                 (quote match-one))
                                (cons v
                                 (cons p x)))) v.18))
                            (cdr v.14)) #f))
                         (cdr v.15))) v.16))
                     (car v.15)) #f))
                  (car v.14)) #f))
               (cdr v.12))) v.13))
           (car v.12)) #f))
        (cdr expr)))))
    ((lambda
      (v.1)
      (if
       (pair? v.1)
       ((lambda
         (v.2)
         ((lambda
           (v)
           ((lambda
             (v.3)
             (if
              (pair? v.3)
              ((lambda
                (v.4)
                (if
                 (null? v.4)
                 ((lambda
                   (v.5)
                   (if
                    (pair? v.5)
                    ((lambda
                      (v.6)
                      ((lambda
                        (g+s)
                        ((lambda
                          (v.7)
                          (if
                           (pair? v.7)
                           ((lambda
                             (v.8)
                             ((lambda
                               (sk)
                               ((lambda
                                 (v.9)
                                 (if
                                  (pair? v.9)
                                  ((lambda
                                    (v.10)
                                    ((lambda
                                      (fk)
                                      ((lambda
                                        (v.11)
                                        ((lambda
                                          (x) fk) v.11))
                                       (cdr v.9))) v.10))
                                   (car v.9)) #f))
                                (cdr v.7))) v.8))
                            (car v.7)) #f))
                         (cdr v.5))) v.6))
                     (car v.5)) #f))
                  (cdr v.3)) #f))
               (car v.3)) #f))
            (cdr v.1))) v.2))
        (car v.1)) #f))
     (cdr expr))))))

(define-syntax match-gen-ellipses
 (er-macro-transformer
  (lambda
   (expr rename compare)
   ((lambda
     (tmp)
     (if tmp tmp
      ((lambda
        (tmp)
        (if tmp tmp
         (error "no expansion for"
          (strip-syntactic-closures expr))))
       ((lambda
         (v.24)
         (if
          (pair? v.24)
          ((lambda
            (v.25)
            ((lambda
              (v)
              ((lambda
                (v.26)
                (if
                 (pair? v.26)
                 ((lambda
                   (v.27)
                   ((lambda
                     (p)
                     ((lambda
                       (v.28)
                       (if
                        (pair? v.28)
                        ((lambda
                          (v.29)
                          ((lambda
                            (r)
                            ((lambda
                              (v.30)
                              (if
                               (pair? v.30)
                               ((lambda
                                 (v.31)
                                 ((lambda
                                   (g+s)
                                   ((lambda
                                     (v.32)
                                     (if
                                      (pair? v.32)
                                      ((lambda
                                        (v.33)
                                        (if
                                         (list? v.33)
                                         ((lambda
                                           (sk)
                                           ((lambda
                                             (v.34)
                                             (if
                                              (pair? v.34)
                                              ((lambda
                                                (v.35)
                                                ((lambda
                                                  (fk)
                                                  ((lambda
                                                    (v.36)
                                                    (if
                                                     (pair? v.36)
                                                     ((lambda
                                                       (v.37)
                                                       ((lambda
                                                         (i)
                                                         ((lambda
                                                           (v.38)
                                                           (if
                                                            (pair? v.38)
                                                            ((lambda
                                                              (v.39)
                                                              ((lambda
                                                                ()
                                                                (define lp #f)
                                                                (set! lp
                                                                 (lambda
                                                                  (v.40 id-ls id-ls-ls)
                                                                  (if
                                                                   (null? v.40)
                                                                   ((lambda
                                                                     (id id-ls)
                                                                     ((lambda
                                                                       (v.46)
                                                                       (if
                                                                        (null? v.46)
                                                                        (cons
                                                                         (rename
                                                                          (quote match-verify-no-ellipses))
                                                                         (cons r
                                                                          (cons
                                                                           (cons
                                                                            (rename
                                                                             (quote let*))
                                                                            (cons
                                                                             (cons
                                                                              (cons
                                                                               (rename
                                                                                (quote tail-len))
                                                                               (cons
                                                                                (cons
                                                                                 (rename
                                                                                  (quote length))
                                                                                 (cons
                                                                                  (cons
                                                                                   (rename
                                                                                    (quote quote))
                                                                                   (cons r
                                                                                    (quote
                                                                                     ())))
                                                                                  (quote
                                                                                   ())))
                                                                                (quote
                                                                                 ())))
                                                                              (cons
                                                                               (cons
                                                                                (rename
                                                                                 (quote ls))
                                                                                (cons v
                                                                                 (quote
                                                                                  ())))
                                                                               (cons
                                                                                (cons
                                                                                 (rename
                                                                                  (quote len))
                                                                                 (cons
                                                                                  (cons
                                                                                   (rename
                                                                                    (quote length))
                                                                                   (cons
                                                                                    (rename
                                                                                     (quote ls))
                                                                                    (quote
                                                                                     ())))
                                                                                  (quote
                                                                                   ())))
                                                                                (quote
                                                                                 ()))))
                                                                             (cons
                                                                              (cons
                                                                               (rename
                                                                                (quote if))
                                                                               (cons
                                                                                (cons
                                                                                 (rename
                                                                                  (quote <))
                                                                                 (cons
                                                                                  (rename
                                                                                   (quote len))
                                                                                  (cons
                                                                                   (rename
                                                                                    (quote tail-len))
                                                                                   (quote
                                                                                    ()))))
                                                                                (cons fk
                                                                                 (cons
                                                                                  (cons
                                                                                   (rename
                                                                                    (quote let))
                                                                                   (cons
                                                                                    (rename
                                                                                     (quote loop))
                                                                                    (cons
                                                                                     (cons
                                                                                      (cons
                                                                                       (rename
                                                                                        (quote ls))
                                                                                       (cons
                                                                                        (rename
                                                                                         (quote ls))
                                                                                        (quote
                                                                                         ())))
                                                                                      (cons
                                                                                       (cons
                                                                                        (rename
                                                                                         (quote n))
                                                                                        (cons
                                                                                         (rename
                                                                                          (quote len))
                                                                                         (quote
                                                                                          ())))
                                                                                       (map
                                                                                        (lambda
                                                                                         (id-ls)
                                                                                         (cons id-ls
                                                                                          (cons
                                                                                           (cons
                                                                                            (rename
                                                                                             (quote quote))
                                                                                            (cons
                                                                                             (quote
                                                                                              ())
                                                                                             (quote
                                                                                              ())))
                                                                                           (quote
                                                                                            ())))) id-ls)))
                                                                                     (cons
                                                                                      (cons
                                                                                       (rename
                                                                                        (quote cond))
                                                                                       (cons
                                                                                        (cons
                                                                                         (cons
                                                                                          (rename
                                                                                           (quote =))
                                                                                          (cons
                                                                                           (rename
                                                                                            (quote n))
                                                                                           (cons
                                                                                            (rename
                                                                                             (quote tail-len))
                                                                                            (quote
                                                                                             ()))))
                                                                                         (cons
                                                                                          (cons
                                                                                           (rename
                                                                                            (quote let))
                                                                                           (cons
                                                                                            (map
                                                                                             (lambda
                                                                                              (id id-ls)
                                                                                              (cons id
                                                                                               (cons
                                                                                                (cons
                                                                                                 (rename
                                                                                                  (quote reverse))
                                                                                                 (cons id-ls
                                                                                                  (quote
                                                                                                   ())))
                                                                                                (quote
                                                                                                 ())))) id id-ls)
                                                                                            (cons
                                                                                             (cons
                                                                                              (rename
                                                                                               (quote match-one))
                                                                                              (cons
                                                                                               (rename
                                                                                                (quote ls))
                                                                                               (cons r
                                                                                                (cons
                                                                                                 (cons #f
                                                                                                  (cons #f
                                                                                                   (quote
                                                                                                    ())))
                                                                                                 (cons
                                                                                                  (append
                                                                                                   (map
                                                                                                    (lambda
                                                                                                     (sk) sk) sk)
                                                                                                   (cons i
                                                                                                    (quote
                                                                                                     ())))
                                                                                                  (cons fk
                                                                                                   (cons i
                                                                                                    (quote
                                                                                                     ()))))))))
                                                                                             (quote
                                                                                              ()))))
                                                                                          (quote
                                                                                           ())))
                                                                                        (cons
                                                                                         (cons
                                                                                          (cons
                                                                                           (rename
                                                                                            (quote pair?))
                                                                                           (cons
                                                                                            (rename
                                                                                             (quote ls))
                                                                                            (quote
                                                                                             ())))
                                                                                          (cons
                                                                                           (cons
                                                                                            (rename
                                                                                             (quote let))
                                                                                            (cons
                                                                                             (cons
                                                                                              (cons
                                                                                               (rename
                                                                                                (quote w))
                                                                                               (cons
                                                                                                (cons
                                                                                                 (rename
                                                                                                  (quote car))
                                                                                                 (cons
                                                                                                  (rename
                                                                                                   (quote ls))
                                                                                                  (quote
                                                                                                   ())))
                                                                                                (quote
                                                                                                 ())))
                                                                                              (quote
                                                                                               ()))
                                                                                             (cons
                                                                                              (cons
                                                                                               (rename
                                                                                                (quote match-one))
                                                                                               (cons
                                                                                                (rename
                                                                                                 (quote w))
                                                                                                (cons p
                                                                                                 (cons
                                                                                                  (cons
                                                                                                   (cons
                                                                                                    (rename
                                                                                                     (quote car))
                                                                                                    (cons
                                                                                                     (rename
                                                                                                      (quote ls))
                                                                                                     (quote
                                                                                                      ())))
                                                                                                   (cons
                                                                                                    (cons
                                                                                                     (rename
                                                                                                      (quote set-car!))
                                                                                                     (cons
                                                                                                      (rename
                                                                                                       (quote ls))
                                                                                                      (quote
                                                                                                       ())))
                                                                                                    (quote
                                                                                                     ())))
                                                                                                  (cons
                                                                                                   (cons
                                                                                                    (rename
                                                                                                     (quote match-drop-ids))
                                                                                                    (cons
                                                                                                     (cons
                                                                                                      (rename
                                                                                                       (quote loop))
                                                                                                      (cons
                                                                                                       (cons
                                                                                                        (rename
                                                                                                         (quote cdr))
                                                                                                        (cons
                                                                                                         (rename
                                                                                                          (quote ls))
                                                                                                         (quote
                                                                                                          ())))
                                                                                                       (cons
                                                                                                        (cons
                                                                                                         (rename
                                                                                                          (quote -))
                                                                                                         (cons
                                                                                                          (rename
                                                                                                           (quote n))
                                                                                                          (cons 1
                                                                                                           (quote
                                                                                                            ()))))
                                                                                                        (map
                                                                                                         (lambda
                                                                                                          (id id-ls)
                                                                                                          (cons
                                                                                                           (rename
                                                                                                            (quote cons))
                                                                                                           (cons id
                                                                                                            (cons id-ls
                                                                                                             (quote
                                                                                                              ()))))) id id-ls))))
                                                                                                     (quote
                                                                                                      ())))
                                                                                                   (cons fk
                                                                                                    (cons i
                                                                                                     (quote
                                                                                                      ()))))))))
                                                                                              (quote
                                                                                               ()))))
                                                                                           (quote
                                                                                            ())))
                                                                                         (cons
                                                                                          (cons
                                                                                           (rename
                                                                                            (quote else))
                                                                                           (cons fk
                                                                                            (quote
                                                                                             ())))
                                                                                          (quote
                                                                                           ())))))
                                                                                      (quote
                                                                                       ())))))
                                                                                  (quote
                                                                                   ())))))
                                                                              (quote
                                                                               ()))))
                                                                           (quote
                                                                            ())))) #f))
                                                                      (cdr v.38)))
                                                                    (reverse id-ls)
                                                                    (reverse id-ls-ls))
                                                                   (if
                                                                    (pair? v.40)
                                                                    ((lambda
                                                                      (v.41)
                                                                      (if
                                                                       (pair? v.41)
                                                                       ((lambda
                                                                         (v.42)
                                                                         ((lambda
                                                                           (id)
                                                                           ((lambda
                                                                             (v.43)
                                                                             (if
                                                                              (pair? v.43)
                                                                              ((lambda
                                                                                (v.44)
                                                                                ((lambda
                                                                                  (id-ls.1)
                                                                                  ((lambda
                                                                                    (v.45)
                                                                                    (if
                                                                                     (null? v.45)
                                                                                     (lp
                                                                                      (cdr v.40)
                                                                                      (cons id id-ls)
                                                                                      (cons id-ls.1 id-ls-ls)) #f))
                                                                                   (cdr v.43))) v.44))
                                                                               (car v.43)) #f))
                                                                            (cdr v.41))) v.42))
                                                                        (car v.41)) #f))
                                                                     (car v.40)) #f)))) #<undef>
                                                                (lp v.39
                                                                 ()
                                                                 ()))))
                                                             (car v.38)) #f))
                                                          (cdr v.36))) v.37))
                                                      (car v.36)) #f))
                                                   (cdr v.34))) v.35))
                                               (car v.34)) #f))
                                            (cdr v.32))) v.33) #f))
                                       (car v.32)) #f))
                                    (cdr v.30))) v.31))
                                (car v.30)) #f))
                             (cdr v.28))) v.29))
                         (car v.28)) #f))
                      (cdr v.26))) v.27))
                  (car v.26)) #f))
               (cdr v.24))) v.25))
           (car v.24)) #f))
        (cdr expr)))))
    ((lambda
      (v.1)
      (if
       (pair? v.1)
       ((lambda
         (v.2)
         ((lambda
           (v)
           ((lambda
             (v.3)
             (if
              (pair? v.3)
              ((lambda
                (v.4)
                ((lambda
                  (p)
                  ((lambda
                    (v.5)
                    (if
                     (pair? v.5)
                     ((lambda
                       (v.6)
                       (if
                        (null? v.6)
                        ((lambda
                          (v.7)
                          (if
                           (pair? v.7)
                           ((lambda
                             (v.8)
                             ((lambda
                               (g+s)
                               ((lambda
                                 (v.9)
                                 (if
                                  (pair? v.9)
                                  ((lambda
                                    (v.10)
                                    (if
                                     (list? v.10)
                                     ((lambda
                                       (sk)
                                       ((lambda
                                         (v.11)
                                         (if
                                          (pair? v.11)
                                          ((lambda
                                            (v.12)
                                            ((lambda
                                              (fk)
                                              ((lambda
                                                (v.13)
                                                (if
                                                 (pair? v.13)
                                                 ((lambda
                                                   (v.14)
                                                   ((lambda
                                                     (i)
                                                     ((lambda
                                                       (v.15)
                                                       (if
                                                        (pair? v.15)
                                                        ((lambda
                                                          (v.16)
                                                          ((lambda
                                                            ()
                                                            (define lp #f)
                                                            (set! lp
                                                             (lambda
                                                              (v.17 id-ls id-ls-ls)
                                                              (if
                                                               (null? v.17)
                                                               ((lambda
                                                                 (id id-ls)
                                                                 ((lambda
                                                                   (v.23)
                                                                   (if
                                                                    (null? v.23)
                                                                    (cons
                                                                     (rename
                                                                      (quote match-check-identifier))
                                                                     (cons p
                                                                      (cons
                                                                       (cons
                                                                        (rename
                                                                         (quote let))
                                                                        (cons
                                                                         (cons
                                                                          (cons p
                                                                           (cons v
                                                                            (quote
                                                                             ())))
                                                                          (quote
                                                                           ()))
                                                                         (cons
                                                                          (cons
                                                                           (rename
                                                                            (quote if))
                                                                           (cons
                                                                            (cons
                                                                             (rename
                                                                              (quote list?))
                                                                             (cons p
                                                                              (quote
                                                                               ())))
                                                                            (cons
                                                                             (append
                                                                              (map
                                                                               (lambda
                                                                                (sk) sk) sk)
                                                                              (cons i
                                                                               (quote
                                                                                ())))
                                                                             (cons fk
                                                                              (quote
                                                                               ())))))
                                                                          (quote
                                                                           ()))))
                                                                       (cons
                                                                        (cons
                                                                         (rename
                                                                          (quote let))
                                                                         (cons
                                                                          (rename
                                                                           (quote loop))
                                                                          (cons
                                                                           (cons
                                                                            (cons
                                                                             (rename
                                                                              (quote ls))
                                                                             (cons v
                                                                              (quote
                                                                               ())))
                                                                            (map
                                                                             (lambda
                                                                              (id-ls)
                                                                              (cons id-ls
                                                                               (cons
                                                                                (cons
                                                                                 (rename
                                                                                  (quote quote))
                                                                                 (cons
                                                                                  (quote
                                                                                   ())
                                                                                  (quote
                                                                                   ())))
                                                                                (quote
                                                                                 ())))) id-ls))
                                                                           (cons
                                                                            (cons
                                                                             (rename
                                                                              (quote cond))
                                                                             (cons
                                                                              (cons
                                                                               (cons
                                                                                (rename
                                                                                 (quote null?))
                                                                                (cons
                                                                                 (rename
                                                                                  (quote ls))
                                                                                 (quote
                                                                                  ())))
                                                                               (cons
                                                                                (cons
                                                                                 (rename
                                                                                  (quote let))
                                                                                 (cons
                                                                                  (map
                                                                                   (lambda
                                                                                    (id id-ls)
                                                                                    (cons id
                                                                                     (cons
                                                                                      (cons
                                                                                       (rename
                                                                                        (quote reverse))
                                                                                       (cons id-ls
                                                                                        (quote
                                                                                         ())))
                                                                                      (quote
                                                                                       ())))) id id-ls)
                                                                                  (cons
                                                                                   (append
                                                                                    (map
                                                                                     (lambda
                                                                                      (sk) sk) sk)
                                                                                    (cons i
                                                                                     (quote
                                                                                      ())))
                                                                                   (quote
                                                                                    ()))))
                                                                                (quote
                                                                                 ())))
                                                                              (cons
                                                                               (cons
                                                                                (cons
                                                                                 (rename
                                                                                  (quote pair?))
                                                                                 (cons
                                                                                  (rename
                                                                                   (quote ls))
                                                                                  (quote
                                                                                   ())))
                                                                                (cons
                                                                                 (cons
                                                                                  (rename
                                                                                   (quote let))
                                                                                  (cons
                                                                                   (cons
                                                                                    (cons
                                                                                     (rename
                                                                                      (quote w))
                                                                                     (cons
                                                                                      (cons
                                                                                       (rename
                                                                                        (quote car))
                                                                                       (cons
                                                                                        (rename
                                                                                         (quote ls))
                                                                                        (quote
                                                                                         ())))
                                                                                      (quote
                                                                                       ())))
                                                                                    (quote
                                                                                     ()))
                                                                                   (cons
                                                                                    (cons
                                                                                     (rename
                                                                                      (quote match-one))
                                                                                     (cons
                                                                                      (rename
                                                                                       (quote w))
                                                                                      (cons p
                                                                                       (cons
                                                                                        (cons
                                                                                         (cons
                                                                                          (rename
                                                                                           (quote car))
                                                                                          (cons
                                                                                           (rename
                                                                                            (quote ls))
                                                                                           (quote
                                                                                            ())))
                                                                                         (cons
                                                                                          (cons
                                                                                           (rename
                                                                                            (quote set-car!))
                                                                                           (cons
                                                                                            (rename
                                                                                             (quote ls))
                                                                                            (quote
                                                                                             ())))
                                                                                          (quote
                                                                                           ())))
                                                                                        (cons
                                                                                         (cons
                                                                                          (rename
                                                                                           (quote match-drop-ids))
                                                                                          (cons
                                                                                           (cons
                                                                                            (rename
                                                                                             (quote loop))
                                                                                            (cons
                                                                                             (cons
                                                                                              (rename
                                                                                               (quote cdr))
                                                                                              (cons
                                                                                               (rename
                                                                                                (quote ls))
                                                                                               (quote
                                                                                                ())))
                                                                                             (map
                                                                                              (lambda
                                                                                               (id id-ls)
                                                                                               (cons
                                                                                                (rename
                                                                                                 (quote cons))
                                                                                                (cons id
                                                                                                 (cons id-ls
                                                                                                  (quote
                                                                                                   ()))))) id id-ls)))
                                                                                           (quote
                                                                                            ())))
                                                                                         (cons fk
                                                                                          (cons i
                                                                                           (quote
                                                                                            ()))))))))
                                                                                    (quote
                                                                                     ()))))
                                                                                 (quote
                                                                                  ())))
                                                                               (cons
                                                                                (cons
                                                                                 (rename
                                                                                  (quote else))
                                                                                 (cons fk
                                                                                  (quote
                                                                                   ())))
                                                                                (quote
                                                                                 ())))))
                                                                            (quote
                                                                             ())))))
                                                                        (quote
                                                                         ()))))) #f))
                                                                  (cdr v.15)))
                                                                (reverse id-ls)
                                                                (reverse id-ls-ls))
                                                               (if
                                                                (pair? v.17)
                                                                ((lambda
                                                                  (v.18)
                                                                  (if
                                                                   (pair? v.18)
                                                                   ((lambda
                                                                     (v.19)
                                                                     ((lambda
                                                                       (id)
                                                                       ((lambda
                                                                         (v.20)
                                                                         (if
                                                                          (pair? v.20)
                                                                          ((lambda
                                                                            (v.21)
                                                                            ((lambda
                                                                              (id-ls.2)
                                                                              ((lambda
                                                                                (v.22)
                                                                                (if
                                                                                 (null? v.22)
                                                                                 (lp
                                                                                  (cdr v.17)
                                                                                  (cons id id-ls)
                                                                                  (cons id-ls.2 id-ls-ls)) #f))
                                                                               (cdr v.20))) v.21))
                                                                           (car v.20)) #f))
                                                                        (cdr v.18))) v.19))
                                                                    (car v.18)) #f))
                                                                 (car v.17)) #f)))) #<undef>
                                                            (lp v.16
                                                             ()
                                                             ()))))
                                                         (car v.15)) #f))
                                                      (cdr v.13))) v.14))
                                                  (car v.13)) #f))
                                               (cdr v.11))) v.12))
                                           (car v.11)) #f))
                                        (cdr v.9))) v.10) #f))
                                   (car v.9)) #f))
                                (cdr v.7))) v.8))
                            (car v.7)) #f))
                         (cdr v.5)) #f))
                      (car v.5)) #f))
                   (cdr v.3))) v.4))
               (car v.3)) #f))
            (cdr v.1))) v.2))
        (car v.1)) #f))
     (cdr expr))))))

(define-syntax match-verify-no-ellipses
 (er-macro-transformer
  (lambda
   (expr rename compare)
   ((lambda
     (tmp)
     (if tmp tmp
      ((lambda
        (tmp)
        (if tmp tmp
         ((lambda
           (tmp)
           (if tmp tmp
            (error "no expansion for"
             (strip-syntactic-closures expr))))
          ((lambda
            (v.13)
            (if
             (pair? v.13)
             ((lambda
               (v.14)
               ((lambda
                 (x)
                 ((lambda
                   (v.15)
                   (if
                    (pair? v.15)
                    ((lambda
                      (v.16)
                      ((lambda
                        (sk)
                        ((lambda
                          (v.17)
                          (if
                           (null? v.17)
                           (cons
                            (rename
                             (quote match-syntax-error))
                            (cons "dotted tail not allowed after ellipse"
                             (cons x
                              (quote
                               ())))) #f))
                         (cdr v.15))) v.16))
                     (car v.15)) #f))
                  (cdr v.13))) v.14))
              (car v.13)) #f))
           (cdr expr)))))
       ((lambda
         (v.8)
         (if
          (pair? v.8)
          ((lambda
            (v.9)
            (if
             (null? v.9)
             ((lambda
               (v.10)
               (if
                (pair? v.10)
                ((lambda
                  (v.11)
                  ((lambda
                    (sk)
                    ((lambda
                      (v.12)
                      (if
                       (null? v.12) sk #f))
                     (cdr v.10))) v.11))
                 (car v.10)) #f))
              (cdr v.8)) #f))
           (car v.8)) #f))
        (cdr expr)))))
    ((lambda
      (v.1)
      (if
       (pair? v.1)
       ((lambda
         (v.2)
         (if
          (pair? v.2)
          ((lambda
            (v.3)
            ((lambda
              (x)
              ((lambda
                (v.4)
                ((lambda
                  (y)
                  ((lambda
                    (v.5)
                    (if
                     (pair? v.5)
                     ((lambda
                       (v.6)
                       ((lambda
                         (sk)
                         ((lambda
                           (v.7)
                           (if
                            (null? v.7)
                            (cons
                             (rename
                              (quote match-check-ellipse))
                             (cons x
                              (cons
                               (cons
                                (rename
                                 (quote match-syntax-error))
                                (cons "multiple ellipse patterns not allowed at same level"
                                 (quote
                                  ())))
                               (cons
                                (cons
                                 (rename
                                  (quote match-verify-no-ellipses))
                                 (cons y
                                  (cons sk
                                   (quote
                                    ()))))
                                (quote
                                 ()))))) #f))
                          (cdr v.5))) v.6))
                      (car v.5)) #f))
                   (cdr v.1))) v.4))
               (cdr v.2))) v.3))
           (car v.2)) #f))
        (car v.1)) #f))
     (cdr expr))))))

(define-syntax match-gen-search
 (er-macro-transformer
  (lambda
   (expr rename compare)
   ((lambda
     (tmp)
     (if tmp tmp
      (error "no expansion for"
       (strip-syntactic-closures expr))))
    ((lambda
      (v.1)
      (if
       (pair? v.1)
       ((lambda
         (v.2)
         ((lambda
           (v)
           ((lambda
             (v.3)
             (if
              (pair? v.3)
              ((lambda
                (v.4)
                ((lambda
                  (p)
                  ((lambda
                    (v.5)
                    (if
                     (pair? v.5)
                     ((lambda
                       (v.6)
                       ((lambda
                         (q)
                         ((lambda
                           (v.7)
                           (if
                            (pair? v.7)
                            ((lambda
                              (v.8)
                              ((lambda
                                (g+s)
                                ((lambda
                                  (v.9)
                                  (if
                                   (pair? v.9)
                                   ((lambda
                                     (v.10)
                                     ((lambda
                                       (sk)
                                       ((lambda
                                         (v.11)
                                         (if
                                          (pair? v.11)
                                          ((lambda
                                            (v.12)
                                            ((lambda
                                              (fk)
                                              ((lambda
                                                (v.13)
                                                (if
                                                 (pair? v.13)
                                                 ((lambda
                                                   (v.14)
                                                   ((lambda
                                                     (i)
                                                     ((lambda
                                                       (v.15)
                                                       (if
                                                        (pair? v.15)
                                                        ((lambda
                                                          (v.16)
                                                          ((lambda
                                                            ()
                                                            (define lp #f)
                                                            (set! lp
                                                             (lambda
                                                              (v.17 id-ls id-ls-ls)
                                                              (if
                                                               (null? v.17)
                                                               ((lambda
                                                                 (id id-ls)
                                                                 ((lambda
                                                                   (v.23)
                                                                   (if
                                                                    (null? v.23)
                                                                    (cons
                                                                     (rename
                                                                      (quote letrec))
                                                                     (cons
                                                                      (cons
                                                                       (cons
                                                                        (rename
                                                                         (quote try))
                                                                        (cons
                                                                         (cons
                                                                          (rename
                                                                           (quote lambda))
                                                                          (cons
                                                                           (cons
                                                                            (rename
                                                                             (quote w))
                                                                            (cons
                                                                             (rename
                                                                              (quote fail))
                                                                             (map
                                                                              (lambda
                                                                               (id-ls) id-ls) id-ls)))
                                                                           (cons
                                                                            (cons
                                                                             (rename
                                                                              (quote match-one))
                                                                             (cons
                                                                              (rename
                                                                               (quote w))
                                                                              (cons q
                                                                               (cons g+s
                                                                                (cons
                                                                                 (cons
                                                                                  (rename
                                                                                   (quote match-drop-ids))
                                                                                  (cons
                                                                                   (cons
                                                                                    (rename
                                                                                     (quote let))
                                                                                    (cons
                                                                                     (map
                                                                                      (lambda
                                                                                       (id id-ls)
                                                                                       (cons id
                                                                                        (cons
                                                                                         (cons
                                                                                          (rename
                                                                                           (quote reverse))
                                                                                          (cons id-ls
                                                                                           (quote
                                                                                            ())))
                                                                                         (quote
                                                                                          ())))) id id-ls)
                                                                                     (cons sk
                                                                                      (quote
                                                                                       ()))))
                                                                                   (quote
                                                                                    ())))
                                                                                 (cons
                                                                                  (cons
                                                                                   (rename
                                                                                    (quote next))
                                                                                   (cons
                                                                                    (rename
                                                                                     (quote w))
                                                                                    (cons
                                                                                     (rename
                                                                                      (quote fail))
                                                                                     (map
                                                                                      (lambda
                                                                                       (id-ls) id-ls) id-ls))))
                                                                                  (cons i
                                                                                   (quote
                                                                                    ()))))))))
                                                                            (quote
                                                                             ()))))
                                                                         (quote
                                                                          ())))
                                                                       (cons
                                                                        (cons
                                                                         (rename
                                                                          (quote next))
                                                                         (cons
                                                                          (cons
                                                                           (rename
                                                                            (quote lambda))
                                                                           (cons
                                                                            (cons
                                                                             (rename
                                                                              (quote w))
                                                                             (cons
                                                                              (rename
                                                                               (quote fail))
                                                                              (map
                                                                               (lambda
                                                                                (id-ls) id-ls) id-ls)))
                                                                            (cons
                                                                             (cons
                                                                              (rename
                                                                               (quote if))
                                                                              (cons
                                                                               (cons
                                                                                (rename
                                                                                 (quote not))
                                                                                (cons
                                                                                 (cons
                                                                                  (rename
                                                                                   (quote pair?))
                                                                                  (cons
                                                                                   (rename
                                                                                    (quote w))
                                                                                   (quote
                                                                                    ())))
                                                                                 (quote
                                                                                  ())))
                                                                               (cons
                                                                                (cons
                                                                                 (rename
                                                                                  (quote fail))
                                                                                 (quote
                                                                                  ()))
                                                                                (cons
                                                                                 (cons
                                                                                  (rename
                                                                                   (quote let))
                                                                                  (cons
                                                                                   (cons
                                                                                    (cons
                                                                                     (rename
                                                                                      (quote u))
                                                                                     (cons
                                                                                      (cons
                                                                                       (rename
                                                                                        (quote car))
                                                                                       (cons
                                                                                        (rename
                                                                                         (quote w))
                                                                                        (quote
                                                                                         ())))
                                                                                      (quote
                                                                                       ())))
                                                                                    (quote
                                                                                     ()))
                                                                                   (cons
                                                                                    (cons
                                                                                     (rename
                                                                                      (quote match-one))
                                                                                     (cons
                                                                                      (rename
                                                                                       (quote u))
                                                                                      (cons p
                                                                                       (cons
                                                                                        (cons
                                                                                         (cons
                                                                                          (rename
                                                                                           (quote car))
                                                                                          (cons
                                                                                           (rename
                                                                                            (quote w))
                                                                                           (quote
                                                                                            ())))
                                                                                         (cons
                                                                                          (cons
                                                                                           (rename
                                                                                            (quote set-car!))
                                                                                           (cons
                                                                                            (rename
                                                                                             (quote w))
                                                                                            (quote
                                                                                             ())))
                                                                                          (quote
                                                                                           ())))
                                                                                        (cons
                                                                                         (cons
                                                                                          (rename
                                                                                           (quote match-drop-ids))
                                                                                          (cons
                                                                                           (cons
                                                                                            (rename
                                                                                             (quote let))
                                                                                            (cons
                                                                                             (map
                                                                                              (lambda
                                                                                               (id id-ls)
                                                                                               (cons id-ls
                                                                                                (cons
                                                                                                 (cons
                                                                                                  (rename
                                                                                                   (quote cons))
                                                                                                  (cons id
                                                                                                   (cons id-ls
                                                                                                    (quote
                                                                                                     ()))))
                                                                                                 (quote
                                                                                                  ())))) id id-ls)
                                                                                             (cons
                                                                                              (cons
                                                                                               (rename
                                                                                                (quote let))
                                                                                               (cons
                                                                                                (rename
                                                                                                 (quote lp))
                                                                                                (cons
                                                                                                 (cons
                                                                                                  (cons
                                                                                                   (rename
                                                                                                    (quote ls))
                                                                                                   (cons
                                                                                                    (cons
                                                                                                     (rename
                                                                                                      (quote cdr))
                                                                                                     (cons
                                                                                                      (rename
                                                                                                       (quote w))
                                                                                                      (quote
                                                                                                       ())))
                                                                                                    (quote
                                                                                                     ())))
                                                                                                  (quote
                                                                                                   ()))
                                                                                                 (cons
                                                                                                  (cons
                                                                                                   (rename
                                                                                                    (quote if))
                                                                                                   (cons
                                                                                                    (cons
                                                                                                     (rename
                                                                                                      (quote pair?))
                                                                                                     (cons
                                                                                                      (rename
                                                                                                       (quote ls))
                                                                                                      (quote
                                                                                                       ())))
                                                                                                    (cons
                                                                                                     (cons
                                                                                                      (rename
                                                                                                       (quote try))
                                                                                                      (cons
                                                                                                       (cons
                                                                                                        (rename
                                                                                                         (quote car))
                                                                                                        (cons
                                                                                                         (rename
                                                                                                          (quote ls))
                                                                                                         (quote
                                                                                                          ())))
                                                                                                       (cons
                                                                                                        (cons
                                                                                                         (rename
                                                                                                          (quote lambda))
                                                                                                         (cons
                                                                                                          (quote
                                                                                                           ())
                                                                                                          (cons
                                                                                                           (cons
                                                                                                            (rename
                                                                                                             (quote lp))
                                                                                                            (cons
                                                                                                             (cons
                                                                                                              (rename
                                                                                                               (quote cdr))
                                                                                                              (cons
                                                                                                               (rename
                                                                                                                (quote ls))
                                                                                                               (quote
                                                                                                                ())))
                                                                                                             (quote
                                                                                                              ())))
                                                                                                           (quote
                                                                                                            ()))))
                                                                                                        (map
                                                                                                         (lambda
                                                                                                          (id-ls) id-ls) id-ls))))
                                                                                                     (cons
                                                                                                      (cons
                                                                                                       (rename
                                                                                                        (quote fail))
                                                                                                       (quote
                                                                                                        ()))
                                                                                                      (quote
                                                                                                       ())))))
                                                                                                  (quote
                                                                                                   ())))))
                                                                                              (quote
                                                                                               ()))))
                                                                                           (quote
                                                                                            ())))
                                                                                         (cons
                                                                                          (cons
                                                                                           (rename
                                                                                            (quote fail))
                                                                                           (quote
                                                                                            ()))
                                                                                          (cons i
                                                                                           (quote
                                                                                            ()))))))))
                                                                                    (quote
                                                                                     ()))))
                                                                                 (quote
                                                                                  ())))))
                                                                             (quote
                                                                              ()))))
                                                                          (quote
                                                                           ())))
                                                                        (quote
                                                                         ())))
                                                                      (cons
                                                                       (cons
                                                                        (rename
                                                                         (quote let))
                                                                        (cons
                                                                         (map
                                                                          (lambda
                                                                           (id-ls)
                                                                           (cons id-ls
                                                                            (cons
                                                                             (cons
                                                                              (rename
                                                                               (quote quote))
                                                                              (cons
                                                                               (quote
                                                                                ())
                                                                               (quote
                                                                                ())))
                                                                             (quote
                                                                              ())))) id-ls)
                                                                         (cons
                                                                          (cons
                                                                           (rename
                                                                            (quote try))
                                                                           (cons v
                                                                            (cons
                                                                             (cons
                                                                              (rename
                                                                               (quote lambda))
                                                                              (cons
                                                                               (quote
                                                                                ())
                                                                               (cons fk
                                                                                (quote
                                                                                 ()))))
                                                                             (map
                                                                              (lambda
                                                                               (id-ls) id-ls) id-ls))))
                                                                          (quote
                                                                           ()))))
                                                                       (quote
                                                                        ())))) #f))
                                                                  (cdr v.15)))
                                                                (reverse id-ls)
                                                                (reverse id-ls-ls))
                                                               (if
                                                                (pair? v.17)
                                                                ((lambda
                                                                  (v.18)
                                                                  (if
                                                                   (pair? v.18)
                                                                   ((lambda
                                                                     (v.19)
                                                                     ((lambda
                                                                       (id)
                                                                       ((lambda
                                                                         (v.20)
                                                                         (if
                                                                          (pair? v.20)
                                                                          ((lambda
                                                                            (v.21)
                                                                            ((lambda
                                                                              (id-ls.1)
                                                                              ((lambda
                                                                                (v.22)
                                                                                (if
                                                                                 (null? v.22)
                                                                                 (lp
                                                                                  (cdr v.17)
                                                                                  (cons id id-ls)
                                                                                  (cons id-ls.1 id-ls-ls)) #f))
                                                                               (cdr v.20))) v.21))
                                                                           (car v.20)) #f))
                                                                        (cdr v.18))) v.19))
                                                                    (car v.18)) #f))
                                                                 (car v.17)) #f)))) #<undef>
                                                            (lp v.16
                                                             ()
                                                             ()))))
                                                         (car v.15)) #f))
                                                      (cdr v.13))) v.14))
                                                  (car v.13)) #f))
                                               (cdr v.11))) v.12))
                                           (car v.11)) #f))
                                        (cdr v.9))) v.10))
                                    (car v.9)) #f))
                                 (cdr v.7))) v.8))
                             (car v.7)) #f))
                          (cdr v.5))) v.6))
                      (car v.5)) #f))
                   (cdr v.3))) v.4))
               (car v.3)) #f))
            (cdr v.1))) v.2))
        (car v.1)) #f))
     (cdr expr))))))

(define-syntax match-vector
 (er-macro-transformer
  (lambda
   (expr rename compare)
   ((lambda
     (tmp)
     (if tmp tmp
      ((lambda
        (tmp)
        (if tmp tmp
         ((lambda
           (tmp)
           (if tmp tmp
            (error "no expansion for"
             (strip-syntactic-closures expr))))
          ((lambda
            (v.33)
            ((lambda
              (x)
              (cons
               (rename
                (quote match-vector-two)) x)) v.33))
           (cdr expr)))))
       ((lambda
         (v.14)
         (if
          (pair? v.14)
          ((lambda
            (v.15)
            ((lambda
              (v)
              ((lambda
                (v.16)
                (if
                 (pair? v.16)
                 ((lambda
                   (v.17)
                   ((lambda
                     (n)
                     ((lambda
                       (v.18)
                       (if
                        (pair? v.18)
                        ((lambda
                          (v.19)
                          ((lambda
                            (pats)
                            ((lambda
                              (v.20)
                              (if
                               (pair? v.20)
                               ((lambda
                                 (v.21)
                                 (if
                                  (pair? v.21)
                                  ((lambda
                                    (v.22)
                                    ((lambda
                                      (p)
                                      ((lambda
                                        (v.23)
                                        (if
                                         (pair? v.23)
                                         ((lambda
                                           (v.24)
                                           (if
                                            (compare v.24
                                             (quote ___))
                                            ((lambda
                                              (v.25)
                                              (if
                                               (null? v.25)
                                               ((lambda
                                                 (v.26)
                                                 (if
                                                  (pair? v.26)
                                                  ((lambda
                                                    (v.27)
                                                    ((lambda
                                                      (sk)
                                                      ((lambda
                                                        (v.28)
                                                        (if
                                                         (pair? v.28)
                                                         ((lambda
                                                           (v.29)
                                                           ((lambda
                                                             (fk)
                                                             ((lambda
                                                               (v.30)
                                                               (if
                                                                (pair? v.30)
                                                                ((lambda
                                                                  (v.31)
                                                                  ((lambda
                                                                    (i)
                                                                    ((lambda
                                                                      (v.32)
                                                                      (if
                                                                       (null? v.32)
                                                                       (cons
                                                                        (rename
                                                                         (quote match-gen-vector-ellipses))
                                                                        (cons v
                                                                         (cons n
                                                                          (cons pats
                                                                           (cons p
                                                                            (cons sk
                                                                             (cons fk
                                                                              (cons i
                                                                               (quote
                                                                                ()))))))))) #f))
                                                                     (cdr v.30))) v.31))
                                                                 (car v.30)) #f))
                                                              (cdr v.28))) v.29))
                                                          (car v.28)) #f))
                                                       (cdr v.26))) v.27))
                                                   (car v.26)) #f))
                                                (cdr v.20)) #f))
                                             (cdr v.23)) #f))
                                          (car v.23)) #f))
                                       (cdr v.21))) v.22))
                                   (car v.21)) #f))
                                (car v.20)) #f))
                             (cdr v.18))) v.19))
                         (car v.18)) #f))
                      (cdr v.16))) v.17))
                  (car v.16)) #f))
               (cdr v.14))) v.15))
           (car v.14)) #f))
        (cdr expr)))))
    ((lambda
      (v.1)
      (if
       (pair? v.1)
       ((lambda
         (v.2)
         ((lambda
           (v)
           ((lambda
             (v.3)
             (if
              (pair? v.3)
              ((lambda
                (v.4)
                ((lambda
                  (n)
                  ((lambda
                    (v.5)
                    (if
                     (pair? v.5)
                     ((lambda
                       (v.6)
                       ((lambda
                         (pats)
                         ((lambda
                           (v.7)
                           (if
                            (pair? v.7)
                            ((lambda
                              (v.8)
                              (if
                               (pair? v.8)
                               ((lambda
                                 (v.9)
                                 ((lambda
                                   (p)
                                   ((lambda
                                     (v.10)
                                     (if
                                      (pair? v.10)
                                      ((lambda
                                        (v.11)
                                        ((lambda
                                          (q)
                                          ((lambda
                                            (v.12)
                                            (if
                                             (null? v.12)
                                             ((lambda
                                               (v.13)
                                               ((lambda
                                                 (x)
                                                 (cons
                                                  (rename
                                                   (quote match-check-ellipse))
                                                  (cons q
                                                   (cons
                                                    (cons
                                                     (rename
                                                      (quote match-gen-vector-ellipses))
                                                     (cons v
                                                      (cons n
                                                       (cons pats
                                                        (cons p x)))))
                                                    (cons
                                                     (cons
                                                      (rename
                                                       (quote match-vector-two))
                                                      (cons v
                                                       (cons n
                                                        (cons pats
                                                         (cons
                                                          (cons p
                                                           (cons q
                                                            (quote
                                                             ()))) x)))))
                                                     (quote
                                                      ())))))) v.13))
                                              (cdr v.7)) #f))
                                           (cdr v.10))) v.11))
                                       (car v.10)) #f))
                                    (cdr v.8))) v.9))
                                (car v.8)) #f))
                             (car v.7)) #f))
                          (cdr v.5))) v.6))
                      (car v.5)) #f))
                   (cdr v.3))) v.4))
               (car v.3)) #f))
            (cdr v.1))) v.2))
        (car v.1)) #f))
     (cdr expr))))))

(define-syntax match-vector-two
 (er-macro-transformer
  (lambda
   (expr rename compare)
   ((lambda
     (tmp)
     (if tmp tmp
      ((lambda
        (tmp)
        (if tmp tmp
         (error "no expansion for"
          (strip-syntactic-closures expr))))
       ((lambda
         (v.22)
         (if
          (pair? v.22)
          ((lambda
            (v.23)
            ((lambda
              (v)
              ((lambda
                (v.24)
                (if
                 (pair? v.24)
                 ((lambda
                   (v.25)
                   ((lambda
                     (n)
                     ((lambda
                       (v.26)
                       (if
                        (pair? v.26)
                        ((lambda
                          (v.27)
                          (if
                           (list? v.27)
                           ((lambda
                             (pats)
                             ((lambda
                               (v.28)
                               (if
                                (pair? v.28)
                                ((lambda
                                  (v.29)
                                  (if
                                   (pair? v.29)
                                   ((lambda
                                     (v.30)
                                     ((lambda
                                       (p)
                                       ((lambda
                                         (v.31)
                                         ((lambda
                                           (q)
                                           ((lambda
                                             (v.32)
                                             ((lambda
                                               (x)
                                               (cons
                                                (rename
                                                 (quote match-vector))
                                                (cons v
                                                 (cons
                                                  (cons
                                                   (rename
                                                    (quote +))
                                                   (cons n
                                                    (cons 1
                                                     (quote
                                                      ()))))
                                                  (cons
                                                   (append
                                                    (map
                                                     (lambda
                                                      (pats) pats) pats)
                                                    (cons
                                                     (cons p
                                                      (cons n
                                                       (quote
                                                        ())))
                                                     (quote
                                                      ())))
                                                   (cons q x)))))) v.32))
                                            (cdr v.28))) v.31))
                                        (cdr v.29))) v.30))
                                    (car v.29)) #f))
                                 (car v.28)) #f))
                              (cdr v.26))) v.27) #f))
                         (car v.26)) #f))
                      (cdr v.24))) v.25))
                  (car v.24)) #f))
               (cdr v.22))) v.23))
           (car v.22)) #f))
        (cdr expr)))))
    ((lambda
      (v.1)
      (if
       (pair? v.1)
       ((lambda
         (v.2)
         ((lambda
           (v)
           ((lambda
             (v.3)
             (if
              (pair? v.3)
              ((lambda
                (v.4)
                ((lambda
                  (n)
                  ((lambda
                    (v.5)
                    (if
                     (pair? v.5)
                     ((lambda
                       (v.6)
                       ((lambda
                         ()
                         (define lp #f)
                         (set! lp
                          (lambda
                           (v.7 pat-ls index-ls)
                           (if
                            (null? v.7)
                            ((lambda
                              (pat index)
                              ((lambda
                                (v.13)
                                (if
                                 (pair? v.13)
                                 ((lambda
                                   (v.14)
                                   (if
                                    (null? v.14)
                                    ((lambda
                                      (v.15)
                                      (if
                                       (pair? v.15)
                                       ((lambda
                                         (v.16)
                                         ((lambda
                                           (sk)
                                           ((lambda
                                             (v.17)
                                             (if
                                              (pair? v.17)
                                              ((lambda
                                                (v.18)
                                                ((lambda
                                                  (fk)
                                                  ((lambda
                                                    (v.19)
                                                    (if
                                                     (pair? v.19)
                                                     ((lambda
                                                       (v.20)
                                                       ((lambda
                                                         (i)
                                                         ((lambda
                                                           (v.21)
                                                           (if
                                                            (null? v.21)
                                                            (cons
                                                             (rename
                                                              (quote if))
                                                             (cons
                                                              (cons
                                                               (rename
                                                                (quote vector?))
                                                               (cons v
                                                                (quote
                                                                 ())))
                                                              (cons
                                                               (cons
                                                                (rename
                                                                 (quote let))
                                                                (cons
                                                                 (cons
                                                                  (cons
                                                                   (rename
                                                                    (quote len))
                                                                   (cons
                                                                    (cons
                                                                     (rename
                                                                      (quote vector-length))
                                                                     (cons v
                                                                      (quote
                                                                       ())))
                                                                    (quote
                                                                     ())))
                                                                  (quote
                                                                   ()))
                                                                 (cons
                                                                  (cons
                                                                   (rename
                                                                    (quote if))
                                                                   (cons
                                                                    (cons
                                                                     (rename
                                                                      (quote =))
                                                                     (cons
                                                                      (rename
                                                                       (quote len))
                                                                      (cons n
                                                                       (quote
                                                                        ()))))
                                                                    (cons
                                                                     (cons
                                                                      (rename
                                                                       (quote match-vector-step))
                                                                      (cons v
                                                                       (cons
                                                                        (map
                                                                         (lambda
                                                                          (pat index)
                                                                          (cons pat
                                                                           (cons index
                                                                            (quote
                                                                             ())))) pat index)
                                                                        (cons sk
                                                                         (cons fk
                                                                          (cons i
                                                                           (quote
                                                                            ())))))))
                                                                     (cons fk
                                                                      (quote
                                                                       ())))))
                                                                  (quote
                                                                   ()))))
                                                               (cons fk
                                                                (quote
                                                                 ()))))) #f))
                                                          (cdr v.19))) v.20))
                                                      (car v.19)) #f))
                                                   (cdr v.17))) v.18))
                                               (car v.17)) #f))
                                            (cdr v.15))) v.16))
                                        (car v.15)) #f))
                                     (cdr v.13)) #f))
                                  (car v.13)) #f))
                               (cdr v.5)))
                             (reverse pat-ls)
                             (reverse index-ls))
                            (if
                             (pair? v.7)
                             ((lambda
                               (v.8)
                               (if
                                (pair? v.8)
                                ((lambda
                                  (v.9)
                                  ((lambda
                                    (pat)
                                    ((lambda
                                      (v.10)
                                      (if
                                       (pair? v.10)
                                       ((lambda
                                         (v.11)
                                         ((lambda
                                           (index)
                                           ((lambda
                                             (v.12)
                                             (if
                                              (null? v.12)
                                              (lp
                                               (cdr v.7)
                                               (cons pat pat-ls)
                                               (cons index index-ls)) #f))
                                            (cdr v.10))) v.11))
                                        (car v.10)) #f))
                                     (cdr v.8))) v.9))
                                 (car v.8)) #f))
                              (car v.7)) #f)))) #<undef>
                         (lp v.6
                          ()
                          ()))))
                      (car v.5)) #f))
                   (cdr v.3))) v.4))
               (car v.3)) #f))
            (cdr v.1))) v.2))
        (car v.1)) #f))
     (cdr expr))))))

(define-syntax match-vector-step
 (er-macro-transformer
  (lambda
   (expr rename compare)
   ((lambda
     (tmp)
     (if tmp tmp
      ((lambda
        (tmp)
        (if tmp tmp
         (error "no expansion for"
          (strip-syntactic-closures expr))))
       ((lambda
         (v.12)
         (if
          (pair? v.12)
          ((lambda
            (v.13)
            ((lambda
              (v)
              ((lambda
                (v.14)
                (if
                 (pair? v.14)
                 ((lambda
                   (v.15)
                   (if
                    (pair? v.15)
                    ((lambda
                      (v.16)
                      (if
                       (pair? v.16)
                       ((lambda
                         (v.17)
                         ((lambda
                           (pat)
                           ((lambda
                             (v.18)
                             (if
                              (pair? v.18)
                              ((lambda
                                (v.19)
                                ((lambda
                                  (index)
                                  ((lambda
                                    (v.20)
                                    (if
                                     (null? v.20)
                                     ((lambda
                                       (v.21)
                                       ((lambda
                                         (rest)
                                         ((lambda
                                           (v.22)
                                           (if
                                            (pair? v.22)
                                            ((lambda
                                              (v.23)
                                              ((lambda
                                                (sk)
                                                ((lambda
                                                  (v.24)
                                                  (if
                                                   (pair? v.24)
                                                   ((lambda
                                                     (v.25)
                                                     ((lambda
                                                       (fk)
                                                       ((lambda
                                                         (v.26)
                                                         (if
                                                          (pair? v.26)
                                                          ((lambda
                                                            (v.27)
                                                            ((lambda
                                                              (i)
                                                              ((lambda
                                                                (v.28)
                                                                (if
                                                                 (null? v.28)
                                                                 (cons
                                                                  (rename
                                                                   (quote let))
                                                                  (cons
                                                                   (cons
                                                                    (cons
                                                                     (rename
                                                                      (quote w))
                                                                     (cons
                                                                      (cons
                                                                       (rename
                                                                        (quote vector-ref))
                                                                       (cons v
                                                                        (cons index
                                                                         (quote
                                                                          ()))))
                                                                      (quote
                                                                       ())))
                                                                    (quote
                                                                     ()))
                                                                   (cons
                                                                    (cons
                                                                     (rename
                                                                      (quote match-one))
                                                                     (cons
                                                                      (rename
                                                                       (quote w))
                                                                      (cons pat
                                                                       (cons
                                                                        (cons
                                                                         (cons
                                                                          (rename
                                                                           (quote vector-ref))
                                                                          (cons v
                                                                           (cons index
                                                                            (quote
                                                                             ()))))
                                                                         (cons
                                                                          (cons
                                                                           (rename
                                                                            (quote vector-set!))
                                                                           (cons v
                                                                            (cons index
                                                                             (quote
                                                                              ()))))
                                                                          (quote
                                                                           ())))
                                                                        (cons
                                                                         (cons
                                                                          (rename
                                                                           (quote match-vector-step))
                                                                          (cons v
                                                                           (cons rest
                                                                            (cons sk
                                                                             (cons fk
                                                                              (quote
                                                                               ()))))))
                                                                         (cons fk
                                                                          (cons i
                                                                           (quote
                                                                            ()))))))))
                                                                    (quote
                                                                     ())))) #f))
                                                               (cdr v.26))) v.27))
                                                           (car v.26)) #f))
                                                        (cdr v.24))) v.25))
                                                    (car v.24)) #f))
                                                 (cdr v.22))) v.23))
                                             (car v.22)) #f))
                                          (cdr v.14))) v.21))
                                      (cdr v.15)) #f))
                                   (cdr v.18))) v.19))
                               (car v.18)) #f))
                            (cdr v.16))) v.17))
                        (car v.16)) #f))
                     (car v.15)) #f))
                  (car v.14)) #f))
               (cdr v.12))) v.13))
           (car v.12)) #f))
        (cdr expr)))))
    ((lambda
      (v.1)
      (if
       (pair? v.1)
       ((lambda
         (v.2)
         ((lambda
           (v)
           ((lambda
             (v.3)
             (if
              (pair? v.3)
              ((lambda
                (v.4)
                (if
                 (null? v.4)
                 ((lambda
                   (v.5)
                   (if
                    (pair? v.5)
                    ((lambda
                      (v.6)
                      (if
                       (list? v.6)
                       ((lambda
                         (sk)
                         ((lambda
                           (v.7)
                           (if
                            (pair? v.7)
                            ((lambda
                              (v.8)
                              ((lambda
                                (fk)
                                ((lambda
                                  (v.9)
                                  (if
                                   (pair? v.9)
                                   ((lambda
                                     (v.10)
                                     ((lambda
                                       (i)
                                       ((lambda
                                         (v.11)
                                         (if
                                          (null? v.11)
                                          (append
                                           (map
                                            (lambda
                                             (sk) sk) sk)
                                           (cons i
                                            (quote
                                             ()))) #f))
                                        (cdr v.9))) v.10))
                                    (car v.9)) #f))
                                 (cdr v.7))) v.8))
                             (car v.7)) #f))
                          (cdr v.5))) v.6) #f))
                     (car v.5)) #f))
                  (cdr v.3)) #f))
               (car v.3)) #f))
            (cdr v.1))) v.2))
        (car v.1)) #f))
     (cdr expr))))))

(define-syntax match-gen-vector-ellipses
 (er-macro-transformer
  (lambda
   (expr rename compare)
   ((lambda
     (tmp)
     (if tmp tmp
      (error "no expansion for"
       (strip-syntactic-closures expr))))
    ((lambda
      (v.1)
      (if
       (pair? v.1)
       ((lambda
         (v.2)
         ((lambda
           (v)
           ((lambda
             (v.3)
             (if
              (pair? v.3)
              ((lambda
                (v.4)
                ((lambda
                  (n)
                  ((lambda
                    (v.5)
                    (if
                     (pair? v.5)
                     ((lambda
                       (v.6)
                       ((lambda
                         ()
                         (define lp #f)
                         (set! lp
                          (lambda
                           (v.7 pat-ls index-ls)
                           (if
                            (null? v.7)
                            ((lambda
                              (pat index)
                              ((lambda
                                (v.13)
                                (if
                                 (pair? v.13)
                                 ((lambda
                                   (v.14)
                                   ((lambda
                                     (p)
                                     ((lambda
                                       (v.15)
                                       (if
                                        (pair? v.15)
                                        ((lambda
                                          (v.16)
                                          ((lambda
                                            (sk)
                                            ((lambda
                                              (v.17)
                                              (if
                                               (pair? v.17)
                                               ((lambda
                                                 (v.18)
                                                 ((lambda
                                                   (fk)
                                                   ((lambda
                                                     (v.19)
                                                     (if
                                                      (pair? v.19)
                                                      ((lambda
                                                        (v.20)
                                                        ((lambda
                                                          (i)
                                                          ((lambda
                                                            (v.21)
                                                            (if
                                                             (null? v.21)
                                                             (cons
                                                              (rename
                                                               (quote if))
                                                              (cons
                                                               (cons
                                                                (rename
                                                                 (quote vector?))
                                                                (cons v
                                                                 (quote
                                                                  ())))
                                                               (cons
                                                                (cons
                                                                 (rename
                                                                  (quote let))
                                                                 (cons
                                                                  (cons
                                                                   (cons
                                                                    (rename
                                                                     (quote len))
                                                                    (cons
                                                                     (cons
                                                                      (rename
                                                                       (quote vector-length))
                                                                      (cons v
                                                                       (quote
                                                                        ())))
                                                                     (quote
                                                                      ())))
                                                                   (quote
                                                                    ()))
                                                                  (cons
                                                                   (cons
                                                                    (rename
                                                                     (quote if))
                                                                    (cons
                                                                     (cons
                                                                      (rename
                                                                       (quote >=))
                                                                      (cons
                                                                       (rename
                                                                        (quote len))
                                                                       (cons n
                                                                        (quote
                                                                         ()))))
                                                                     (cons
                                                                      (cons
                                                                       (rename
                                                                        (quote match-vector-step))
                                                                       (cons v
                                                                        (cons
                                                                         (map
                                                                          (lambda
                                                                           (pat index)
                                                                           (cons pat
                                                                            (cons index
                                                                             (quote
                                                                              ())))) pat index)
                                                                         (cons
                                                                          (cons
                                                                           (rename
                                                                            (quote match-vector-tail))
                                                                           (cons v
                                                                            (cons p
                                                                             (cons n
                                                                              (cons
                                                                               (rename
                                                                                (quote len))
                                                                               (cons sk
                                                                                (cons fk
                                                                                 (quote
                                                                                  ()))))))))
                                                                          (cons fk
                                                                           (cons i
                                                                            (quote
                                                                             ())))))))
                                                                      (cons fk
                                                                       (quote
                                                                        ())))))
                                                                   (quote
                                                                    ()))))
                                                                (cons fk
                                                                 (quote
                                                                  ()))))) #f))
                                                           (cdr v.19))) v.20))
                                                       (car v.19)) #f))
                                                    (cdr v.17))) v.18))
                                                (car v.17)) #f))
                                             (cdr v.15))) v.16))
                                         (car v.15)) #f))
                                      (cdr v.13))) v.14))
                                  (car v.13)) #f))
                               (cdr v.5)))
                             (reverse pat-ls)
                             (reverse index-ls))
                            (if
                             (pair? v.7)
                             ((lambda
                               (v.8)
                               (if
                                (pair? v.8)
                                ((lambda
                                  (v.9)
                                  ((lambda
                                    (pat)
                                    ((lambda
                                      (v.10)
                                      (if
                                       (pair? v.10)
                                       ((lambda
                                         (v.11)
                                         ((lambda
                                           (index)
                                           ((lambda
                                             (v.12)
                                             (if
                                              (null? v.12)
                                              (lp
                                               (cdr v.7)
                                               (cons pat pat-ls)
                                               (cons index index-ls)) #f))
                                            (cdr v.10))) v.11))
                                        (car v.10)) #f))
                                     (cdr v.8))) v.9))
                                 (car v.8)) #f))
                              (car v.7)) #f)))) #<undef>
                         (lp v.6
                          ()
                          ()))))
                      (car v.5)) #f))
                   (cdr v.3))) v.4))
               (car v.3)) #f))
            (cdr v.1))) v.2))
        (car v.1)) #f))
     (cdr expr))))))

(define-syntax match-vector-tail
 (er-macro-transformer
  (lambda
   (expr rename compare)
   ((lambda
     (tmp)
     (if tmp tmp
      (error "no expansion for"
       (strip-syntactic-closures expr))))
    ((lambda
      (v.1)
      (if
       (pair? v.1)
       ((lambda
         (v.2)
         ((lambda
           (v)
           ((lambda
             (v.3)
             (if
              (pair? v.3)
              ((lambda
                (v.4)
                ((lambda
                  (p)
                  ((lambda
                    (v.5)
                    (if
                     (pair? v.5)
                     ((lambda
                       (v.6)
                       ((lambda
                         (n)
                         ((lambda
                           (v.7)
                           (if
                            (pair? v.7)
                            ((lambda
                              (v.8)
                              ((lambda
                                (len)
                                ((lambda
                                  (v.9)
                                  (if
                                   (pair? v.9)
                                   ((lambda
                                     (v.10)
                                     ((lambda
                                       (sk)
                                       ((lambda
                                         (v.11)
                                         (if
                                          (pair? v.11)
                                          ((lambda
                                            (v.12)
                                            ((lambda
                                              (fk)
                                              ((lambda
                                                (v.13)
                                                (if
                                                 (pair? v.13)
                                                 ((lambda
                                                   (v.14)
                                                   ((lambda
                                                     (i)
                                                     ((lambda
                                                       (v.15)
                                                       (if
                                                        (null? v.15)
                                                        (cons
                                                         (rename
                                                          (quote match-extract-vars))
                                                         (cons p
                                                          (cons
                                                           (cons
                                                            (rename
                                                             (quote match-vector-tail-two))
                                                            (cons v
                                                             (cons p
                                                              (cons n
                                                               (cons len
                                                                (cons sk
                                                                 (cons fk
                                                                  (cons i
                                                                   (quote
                                                                    ())))))))))
                                                           (cons i
                                                            (cons
                                                             (quote
                                                              ())
                                                             (quote
                                                              ())))))) #f))
                                                      (cdr v.13))) v.14))
                                                  (car v.13)) #f))
                                               (cdr v.11))) v.12))
                                           (car v.11)) #f))
                                        (cdr v.9))) v.10))
                                    (car v.9)) #f))
                                 (cdr v.7))) v.8))
                             (car v.7)) #f))
                          (cdr v.5))) v.6))
                      (car v.5)) #f))
                   (cdr v.3))) v.4))
               (car v.3)) #f))
            (cdr v.1))) v.2))
        (car v.1)) #f))
     (cdr expr))))))

(define-syntax match-vector-tail-two
 (er-macro-transformer
  (lambda
   (expr rename compare)
   ((lambda
     (tmp)
     (if tmp tmp
      (error "no expansion for"
       (strip-syntactic-closures expr))))
    ((lambda
      (v.1)
      (if
       (pair? v.1)
       ((lambda
         (v.2)
         ((lambda
           (v)
           ((lambda
             (v.3)
             (if
              (pair? v.3)
              ((lambda
                (v.4)
                ((lambda
                  (p)
                  ((lambda
                    (v.5)
                    (if
                     (pair? v.5)
                     ((lambda
                       (v.6)
                       ((lambda
                         (n)
                         ((lambda
                           (v.7)
                           (if
                            (pair? v.7)
                            ((lambda
                              (v.8)
                              ((lambda
                                (len)
                                ((lambda
                                  (v.9)
                                  (if
                                   (pair? v.9)
                                   ((lambda
                                     (v.10)
                                     (if
                                      (list? v.10)
                                      ((lambda
                                        (sk)
                                        ((lambda
                                          (v.11)
                                          (if
                                           (pair? v.11)
                                           ((lambda
                                             (v.12)
                                             ((lambda
                                               (fk)
                                               ((lambda
                                                 (v.13)
                                                 (if
                                                  (pair? v.13)
                                                  ((lambda
                                                    (v.14)
                                                    ((lambda
                                                      (i)
                                                      ((lambda
                                                        (v.15)
                                                        (if
                                                         (pair? v.15)
                                                         ((lambda
                                                           (v.16)
                                                           ((lambda
                                                             ()
                                                             (define lp #f)
                                                             (set! lp
                                                              (lambda
                                                               (v.17 id-ls id-ls-ls)
                                                               (if
                                                                (null? v.17)
                                                                ((lambda
                                                                  (id id-ls)
                                                                  ((lambda
                                                                    (v.23)
                                                                    (if
                                                                     (null? v.23)
                                                                     (cons
                                                                      (rename
                                                                       (quote let))
                                                                      (cons
                                                                       (rename
                                                                        (quote loop))
                                                                       (cons
                                                                        (cons
                                                                         (cons
                                                                          (rename
                                                                           (quote j))
                                                                          (cons n
                                                                           (quote
                                                                            ())))
                                                                         (map
                                                                          (lambda
                                                                           (id-ls)
                                                                           (cons id-ls
                                                                            (cons
                                                                             (cons
                                                                              (rename
                                                                               (quote quote))
                                                                              (cons
                                                                               (quote
                                                                                ())
                                                                               (quote
                                                                                ())))
                                                                             (quote
                                                                              ())))) id-ls))
                                                                        (cons
                                                                         (cons
                                                                          (rename
                                                                           (quote if))
                                                                          (cons
                                                                           (cons
                                                                            (rename
                                                                             (quote >=))
                                                                            (cons
                                                                             (rename
                                                                              (quote j))
                                                                             (cons len
                                                                              (quote
                                                                               ()))))
                                                                           (cons
                                                                            (cons
                                                                             (rename
                                                                              (quote let))
                                                                             (cons
                                                                              (map
                                                                               (lambda
                                                                                (id id-ls)
                                                                                (cons id
                                                                                 (cons
                                                                                  (cons
                                                                                   (rename
                                                                                    (quote reverse))
                                                                                   (cons id-ls
                                                                                    (quote
                                                                                     ())))
                                                                                  (quote
                                                                                   ())))) id id-ls)
                                                                              (cons
                                                                               (append
                                                                                (map
                                                                                 (lambda
                                                                                  (sk) sk) sk)
                                                                                (cons i
                                                                                 (quote
                                                                                  ())))
                                                                               (quote
                                                                                ()))))
                                                                            (cons
                                                                             (cons
                                                                              (rename
                                                                               (quote let))
                                                                              (cons
                                                                               (cons
                                                                                (cons
                                                                                 (rename
                                                                                  (quote w))
                                                                                 (cons
                                                                                  (cons
                                                                                   (rename
                                                                                    (quote vector-ref))
                                                                                   (cons v
                                                                                    (cons
                                                                                     (rename
                                                                                      (quote j))
                                                                                     (quote
                                                                                      ()))))
                                                                                  (quote
                                                                                   ())))
                                                                                (quote
                                                                                 ()))
                                                                               (cons
                                                                                (cons
                                                                                 (rename
                                                                                  (quote match-one))
                                                                                 (cons
                                                                                  (rename
                                                                                   (quote w))
                                                                                  (cons p
                                                                                   (cons
                                                                                    (cons
                                                                                     (cons
                                                                                      (rename
                                                                                       (quote vector-ref))
                                                                                      (cons v
                                                                                       (cons
                                                                                        (rename
                                                                                         (quote j))
                                                                                        (quote
                                                                                         ()))))
                                                                                     (cons
                                                                                      (cons
                                                                                       (rename
                                                                                        (quote vetor-set!))
                                                                                       (cons v
                                                                                        (cons
                                                                                         (rename
                                                                                          (quote j))
                                                                                         (quote
                                                                                          ()))))
                                                                                      (quote
                                                                                       ())))
                                                                                    (cons
                                                                                     (cons
                                                                                      (rename
                                                                                       (quote match-drop-ids))
                                                                                      (cons
                                                                                       (cons
                                                                                        (rename
                                                                                         (quote loop))
                                                                                        (cons
                                                                                         (cons
                                                                                          (rename
                                                                                           (quote +))
                                                                                          (cons
                                                                                           (rename
                                                                                            (quote j))
                                                                                           (cons 1
                                                                                            (quote
                                                                                             ()))))
                                                                                         (map
                                                                                          (lambda
                                                                                           (id id-ls)
                                                                                           (cons
                                                                                            (rename
                                                                                             (quote cons))
                                                                                            (cons id
                                                                                             (cons id-ls
                                                                                              (quote
                                                                                               ()))))) id id-ls)))
                                                                                       (quote
                                                                                        ())))
                                                                                     (cons fk
                                                                                      (cons i
                                                                                       (quote
                                                                                        ()))))))))
                                                                                (quote
                                                                                 ()))))
                                                                             (quote
                                                                              ())))))
                                                                         (quote
                                                                          ()))))) #f))
                                                                   (cdr v.15)))
                                                                 (reverse id-ls)
                                                                 (reverse id-ls-ls))
                                                                (if
                                                                 (pair? v.17)
                                                                 ((lambda
                                                                   (v.18)
                                                                   (if
                                                                    (pair? v.18)
                                                                    ((lambda
                                                                      (v.19)
                                                                      ((lambda
                                                                        (id)
                                                                        ((lambda
                                                                          (v.20)
                                                                          (if
                                                                           (pair? v.20)
                                                                           ((lambda
                                                                             (v.21)
                                                                             ((lambda
                                                                               (id-ls.1)
                                                                               ((lambda
                                                                                 (v.22)
                                                                                 (if
                                                                                  (null? v.22)
                                                                                  (lp
                                                                                   (cdr v.17)
                                                                                   (cons id id-ls)
                                                                                   (cons id-ls.1 id-ls-ls)) #f))
                                                                                (cdr v.20))) v.21))
                                                                            (car v.20)) #f))
                                                                         (cdr v.18))) v.19))
                                                                     (car v.18)) #f))
                                                                  (car v.17)) #f)))) #<undef>
                                                             (lp v.16
                                                              ()
                                                              ()))))
                                                          (car v.15)) #f))
                                                       (cdr v.13))) v.14))
                                                   (car v.13)) #f))
                                                (cdr v.11))) v.12))
                                            (car v.11)) #f))
                                         (cdr v.9))) v.10) #f))
                                    (car v.9)) #f))
                                 (cdr v.7))) v.8))
                             (car v.7)) #f))
                          (cdr v.5))) v.6))
                      (car v.5)) #f))
                   (cdr v.3))) v.4))
               (car v.3)) #f))
            (cdr v.1))) v.2))
        (car v.1)) #f))
     (cdr expr))))))

(define-syntax match-extract-vars
 (er-macro-transformer
  (lambda
   (expr rename compare)
   ((lambda
     (tmp)
     (if tmp tmp
      ((lambda
        (tmp)
        (if tmp tmp
         ((lambda
           (tmp)
           (if tmp tmp
            ((lambda
              (tmp)
              (if tmp tmp
               ((lambda
                 (tmp)
                 (if tmp tmp
                  ((lambda
                    (tmp)
                    (if tmp tmp
                     ((lambda
                       (tmp)
                       (if tmp tmp
                        ((lambda
                          (tmp)
                          (if tmp tmp
                           ((lambda
                             (tmp)
                             (if tmp tmp
                              ((lambda
                                (tmp)
                                (if tmp tmp
                                 ((lambda
                                   (tmp)
                                   (if tmp tmp
                                    ((lambda
                                      (tmp)
                                      (if tmp tmp
                                       ((lambda
                                         (tmp)
                                         (if tmp tmp
                                          ((lambda
                                            (tmp)
                                            (if tmp tmp
                                             ((lambda
                                               (tmp)
                                               (if tmp tmp
                                                (error "no expansion for"
                                                 (strip-syntactic-closures expr))))
                                              ((lambda
                                                (v.120)
                                                (if
                                                 (pair? v.120)
                                                 ((lambda
                                                   (v.121)
                                                   ((lambda
                                                     (p)
                                                     ((lambda
                                                       (v.122)
                                                       (if
                                                        (pair? v.122)
                                                        ((lambda
                                                          (v.123)
                                                          (if
                                                           (list? v.123)
                                                           ((lambda
                                                             (k)
                                                             ((lambda
                                                               (v.124)
                                                               (if
                                                                (pair? v.124)
                                                                ((lambda
                                                                  (v.125)
                                                                  (if
                                                                   (list? v.125)
                                                                   ((lambda
                                                                     (i)
                                                                     ((lambda
                                                                       (v.126)
                                                                       (if
                                                                        (pair? v.126)
                                                                        ((lambda
                                                                          (v.127)
                                                                          ((lambda
                                                                            (v)
                                                                            ((lambda
                                                                              (v.128)
                                                                              (if
                                                                               (null? v.128)
                                                                               (cons
                                                                                (rename
                                                                                 (quote let-syntax))
                                                                                (cons
                                                                                 (cons
                                                                                  (cons
                                                                                   (rename
                                                                                    (quote new-sym?))
                                                                                   (cons
                                                                                    (cons
                                                                                     (rename
                                                                                      (quote syntax-rules))
                                                                                     (cons
                                                                                      (map
                                                                                       (lambda
                                                                                        (i) i) i)
                                                                                      (cons
                                                                                       (cons
                                                                                        (cons
                                                                                         (rename
                                                                                          (quote new-sym?))
                                                                                         (cons p
                                                                                          (cons
                                                                                           (rename
                                                                                            (quote sk))
                                                                                           (cons
                                                                                            (rename
                                                                                             (quote fk))
                                                                                            (quote
                                                                                             ())))))
                                                                                        (cons
                                                                                         (rename
                                                                                          (quote sk))
                                                                                         (quote
                                                                                          ())))
                                                                                       (cons
                                                                                        (cons
                                                                                         (cons
                                                                                          (rename
                                                                                           (quote new-sym?))
                                                                                          (cons
                                                                                           (rename
                                                                                            (quote x))
                                                                                           (cons
                                                                                            (rename
                                                                                             (quote sk))
                                                                                            (cons
                                                                                             (rename
                                                                                              (quote fk))
                                                                                             (quote
                                                                                              ())))))
                                                                                         (cons
                                                                                          (rename
                                                                                           (quote fk))
                                                                                          (quote
                                                                                           ())))
                                                                                        (quote
                                                                                         ())))))
                                                                                    (quote
                                                                                     ())))
                                                                                  (quote
                                                                                   ()))
                                                                                 (cons
                                                                                  (cons
                                                                                   (rename
                                                                                    (quote new-sym?))
                                                                                   (cons
                                                                                    (rename
                                                                                     (quote random-sym-to-match))
                                                                                    (cons
                                                                                     (append
                                                                                      (map
                                                                                       (lambda
                                                                                        (k) k) k)
                                                                                      (cons
                                                                                       (cons
                                                                                        (cons p
                                                                                         (cons
                                                                                          (rename
                                                                                           (quote p-ls))
                                                                                          (quote
                                                                                           ()))) v)
                                                                                       (quote
                                                                                        ())))
                                                                                     (cons
                                                                                      (append
                                                                                       (map
                                                                                        (lambda
                                                                                         (k) k) k)
                                                                                       (cons v
                                                                                        (quote
                                                                                         ())))
                                                                                      (quote
                                                                                       ())))))
                                                                                  (quote
                                                                                   ())))) #f))
                                                                             (cdr v.126))) v.127))
                                                                         (car v.126)) #f))
                                                                      (cdr v.124))) v.125) #f))
                                                                 (car v.124)) #f))
                                                              (cdr v.122))) v.123) #f))
                                                         (car v.122)) #f))
                                                      (cdr v.120))) v.121))
                                                  (car v.120)) #f))
                                               (cdr expr)))))
                                           ((lambda
                                             (v.111)
                                             (if
                                              (pair? v.111)
                                              ((lambda
                                                (v.112)
                                                (if
                                                 (compare v.112
                                                  (quote ***))
                                                 ((lambda
                                                   (v.113)
                                                   (if
                                                    (pair? v.113)
                                                    ((lambda
                                                      (v.114)
                                                      (if
                                                       (list? v.114)
                                                       ((lambda
                                                         (k)
                                                         ((lambda
                                                           (v.115)
                                                           (if
                                                            (pair? v.115)
                                                            ((lambda
                                                              (v.116)
                                                              ((lambda
                                                                (i)
                                                                ((lambda
                                                                  (v.117)
                                                                  (if
                                                                   (pair? v.117)
                                                                   ((lambda
                                                                     (v.118)
                                                                     ((lambda
                                                                       (v)
                                                                       ((lambda
                                                                         (v.119)
                                                                         (if
                                                                          (null? v.119)
                                                                          (append
                                                                           (map
                                                                            (lambda
                                                                             (k) k) k)
                                                                           (cons v
                                                                            (quote
                                                                             ()))) #f))
                                                                        (cdr v.117))) v.118))
                                                                    (car v.117)) #f))
                                                                 (cdr v.115))) v.116))
                                                             (car v.115)) #f))
                                                          (cdr v.113))) v.114) #f))
                                                     (car v.113)) #f))
                                                  (cdr v.111)) #f))
                                               (car v.111)) #f))
                                            (cdr expr)))))
                                        ((lambda
                                          (v.102)
                                          (if
                                           (pair? v.102)
                                           ((lambda
                                             (v.103)
                                             (if
                                              (compare v.103
                                               (quote ___))
                                              ((lambda
                                                (v.104)
                                                (if
                                                 (pair? v.104)
                                                 ((lambda
                                                   (v.105)
                                                   (if
                                                    (list? v.105)
                                                    ((lambda
                                                      (k)
                                                      ((lambda
                                                        (v.106)
                                                        (if
                                                         (pair? v.106)
                                                         ((lambda
                                                           (v.107)
                                                           ((lambda
                                                             (i)
                                                             ((lambda
                                                               (v.108)
                                                               (if
                                                                (pair? v.108)
                                                                ((lambda
                                                                  (v.109)
                                                                  ((lambda
                                                                    (v)
                                                                    ((lambda
                                                                      (v.110)
                                                                      (if
                                                                       (null? v.110)
                                                                       (append
                                                                        (map
                                                                         (lambda
                                                                          (k) k) k)
                                                                        (cons v
                                                                         (quote
                                                                          ()))) #f))
                                                                     (cdr v.108))) v.109))
                                                                 (car v.108)) #f))
                                                              (cdr v.106))) v.107))
                                                          (car v.106)) #f))
                                                       (cdr v.104))) v.105) #f))
                                                  (car v.104)) #f))
                                               (cdr v.102)) #f))
                                            (car v.102)) #f))
                                         (cdr expr)))))
                                     ((lambda
                                       (v.93)
                                       (if
                                        (pair? v.93)
                                        ((lambda
                                          (v.94)
                                          (if
                                           (compare v.94
                                            (quote _))
                                           ((lambda
                                             (v.95)
                                             (if
                                              (pair? v.95)
                                              ((lambda
                                                (v.96)
                                                (if
                                                 (list? v.96)
                                                 ((lambda
                                                   (k)
                                                   ((lambda
                                                     (v.97)
                                                     (if
                                                      (pair? v.97)
                                                      ((lambda
                                                        (v.98)
                                                        ((lambda
                                                          (i)
                                                          ((lambda
                                                            (v.99)
                                                            (if
                                                             (pair? v.99)
                                                             ((lambda
                                                               (v.100)
                                                               ((lambda
                                                                 (v)
                                                                 ((lambda
                                                                   (v.101)
                                                                   (if
                                                                    (null? v.101)
                                                                    (append
                                                                     (map
                                                                      (lambda
                                                                       (k) k) k)
                                                                     (cons v
                                                                      (quote
                                                                       ()))) #f))
                                                                  (cdr v.99))) v.100))
                                                              (car v.99)) #f))
                                                           (cdr v.97))) v.98))
                                                       (car v.97)) #f))
                                                    (cdr v.95))) v.96) #f))
                                               (car v.95)) #f))
                                            (cdr v.93)) #f))
                                         (car v.93)) #f))
                                      (cdr expr)))))
                                  ((lambda
                                    (v.89)
                                    (if
                                     (pair? v.89)
                                     ((lambda
                                       (v.90)
                                       (if
                                        (vector? v.90)
                                        ((lambda
                                          (v.91)
                                          (if
                                           (list? v.91)
                                           ((lambda
                                             (p)
                                             ((lambda
                                               (v.92)
                                               ((lambda
                                                 (x)
                                                 (cons
                                                  (rename
                                                   (quote match-extract-vars))
                                                  (cons
                                                   (map
                                                    (lambda
                                                     (p) p) p) x))) v.92))
                                              (cdr v.89))) v.91) #f))
                                         (vector->list v.90)) #f))
                                      (car v.89)) #f))
                                   (cdr expr)))))
                               ((lambda
                                 (v.78)
                                 (if
                                  (pair? v.78)
                                  ((lambda
                                    (v.79)
                                    (if
                                     (pair? v.79)
                                     ((lambda
                                       (v.80)
                                       ((lambda
                                         (p)
                                         ((lambda
                                           (v.81)
                                           ((lambda
                                             (q)
                                             ((lambda
                                               (v.82)
                                               (if
                                                (pair? v.82)
                                                ((lambda
                                                  (v.83)
                                                  ((lambda
                                                    (k)
                                                    ((lambda
                                                      (v.84)
                                                      (if
                                                       (pair? v.84)
                                                       ((lambda
                                                         (v.85)
                                                         ((lambda
                                                           (i)
                                                           ((lambda
                                                             (v.86)
                                                             (if
                                                              (pair? v.86)
                                                              ((lambda
                                                                (v.87)
                                                                ((lambda
                                                                  (v)
                                                                  ((lambda
                                                                    (v.88)
                                                                    (if
                                                                     (null? v.88)
                                                                     (cons
                                                                      (rename
                                                                       (quote match-extract-vars))
                                                                      (cons p
                                                                       (cons
                                                                        (cons
                                                                         (rename
                                                                          (quote match-extract-vars-step))
                                                                         (cons q
                                                                          (cons k
                                                                           (cons i
                                                                            (cons v
                                                                             (quote
                                                                              ()))))))
                                                                        (cons i
                                                                         (cons
                                                                          (quote
                                                                           ())
                                                                          (quote
                                                                           ())))))) #f))
                                                                   (cdr v.86))) v.87))
                                                               (car v.86)) #f))
                                                            (cdr v.84))) v.85))
                                                        (car v.84)) #f))
                                                     (cdr v.82))) v.83))
                                                 (car v.82)) #f))
                                              (cdr v.78))) v.81))
                                          (cdr v.79))) v.80))
                                      (car v.79)) #f))
                                   (car v.78)) #f))
                                (cdr expr)))))
                            ((lambda
                              (v.65)
                              (if
                               (pair? v.65)
                               ((lambda
                                 (v.66)
                                 (if
                                  (pair? v.66)
                                  ((lambda
                                    (v.67)
                                    ((lambda
                                      (p)
                                      ((lambda
                                        (v.68)
                                        (if
                                         (pair? v.68)
                                         ((lambda
                                           (v.69)
                                           ((lambda
                                             (q)
                                             ((lambda
                                               (v.70)
                                               ((lambda
                                                 (r)
                                                 ((lambda
                                                   (v.71)
                                                   (if
                                                    (pair? v.71)
                                                    ((lambda
                                                      (v.72)
                                                      ((lambda
                                                        (k)
                                                        ((lambda
                                                          (v.73)
                                                          (if
                                                           (pair? v.73)
                                                           ((lambda
                                                             (v.74)
                                                             ((lambda
                                                               (i)
                                                               ((lambda
                                                                 (v.75)
                                                                 (if
                                                                  (pair? v.75)
                                                                  ((lambda
                                                                    (v.76)
                                                                    ((lambda
                                                                      (v)
                                                                      ((lambda
                                                                        (v.77)
                                                                        (if
                                                                         (null? v.77)
                                                                         (cons
                                                                          (rename
                                                                           (quote match-check-ellipse))
                                                                          (cons q
                                                                           (cons
                                                                            (cons
                                                                             (rename
                                                                              (quote match-extract-vars))
                                                                             (cons
                                                                              (cons p r)
                                                                              (cons k
                                                                               (cons i
                                                                                (cons v
                                                                                 (quote
                                                                                  ()))))))
                                                                            (cons
                                                                             (cons
                                                                              (rename
                                                                               (quote match-extract-vars))
                                                                              (cons p
                                                                               (cons
                                                                                (cons
                                                                                 (rename
                                                                                  (quote match-extract-vars-step))
                                                                                 (cons
                                                                                  (cons q r)
                                                                                  (cons k
                                                                                   (cons i
                                                                                    (cons v
                                                                                     (quote
                                                                                      ()))))))
                                                                                (cons i
                                                                                 (cons
                                                                                  (quote
                                                                                   ())
                                                                                  (quote
                                                                                   ()))))))
                                                                             (quote
                                                                              ()))))) #f))
                                                                       (cdr v.75))) v.76))
                                                                   (car v.75)) #f))
                                                                (cdr v.73))) v.74))
                                                            (car v.73)) #f))
                                                         (cdr v.71))) v.72))
                                                     (car v.71)) #f))
                                                  (cdr v.65))) v.70))
                                              (cdr v.68))) v.69))
                                          (car v.68)) #f))
                                       (cdr v.66))) v.67))
                                   (car v.66)) #f))
                                (car v.65)) #f))
                             (cdr expr)))))
                         ((lambda
                           (v.60)
                           (if
                            (pair? v.60)
                            ((lambda
                              (v.61)
                              (if
                               (pair? v.61)
                               ((lambda
                                 (v.62)
                                 (if
                                  (compare v.62
                                   (quote not))
                                  ((lambda
                                    (v.63)
                                    ((lambda
                                      (p)
                                      ((lambda
                                        (v.64)
                                        ((lambda
                                          (x)
                                          (cons
                                           (rename
                                            (quote match-extract-vars))
                                           (cons p x))) v.64))
                                       (cdr v.60))) v.63))
                                   (cdr v.61)) #f))
                                (car v.61)) #f))
                             (car v.60)) #f))
                          (cdr expr)))))
                      ((lambda
                        (v.55)
                        (if
                         (pair? v.55)
                         ((lambda
                           (v.56)
                           (if
                            (pair? v.56)
                            ((lambda
                              (v.57)
                              (if
                               (compare v.57
                                (quote or))
                               ((lambda
                                 (v.58)
                                 ((lambda
                                   (p)
                                   ((lambda
                                     (v.59)
                                     ((lambda
                                       (x)
                                       (cons
                                        (rename
                                         (quote match-extract-vars))
                                        (cons p x))) v.59))
                                    (cdr v.55))) v.58))
                                (cdr v.56)) #f))
                             (car v.56)) #f))
                          (car v.55)) #f))
                       (cdr expr)))))
                   ((lambda
                     (v.50)
                     (if
                      (pair? v.50)
                      ((lambda
                        (v.51)
                        (if
                         (pair? v.51)
                         ((lambda
                           (v.52)
                           (if
                            (compare v.52
                             (quote and))
                            ((lambda
                              (v.53)
                              ((lambda
                                (p)
                                ((lambda
                                  (v.54)
                                  ((lambda
                                    (x)
                                    (cons
                                     (rename
                                      (quote match-extract-vars))
                                     (cons p x))) v.54))
                                 (cdr v.50))) v.53))
                             (cdr v.51)) #f))
                          (car v.51)) #f))
                       (car v.50)) #f))
                    (cdr expr)))))
                ((lambda
                  (v.37)
                  (if
                   (pair? v.37)
                   ((lambda
                     (v.38)
                     (if
                      (pair? v.38)
                      ((lambda
                        (v.39)
                        (if
                         (compare v.39
                          (quote quasiquote))
                         ((lambda
                           (v.40)
                           (if
                            (pair? v.40)
                            ((lambda
                              (v.41)
                              ((lambda
                                (x)
                                ((lambda
                                  (v.42)
                                  (if
                                   (null? v.42)
                                   ((lambda
                                     (v.43)
                                     (if
                                      (pair? v.43)
                                      ((lambda
                                        (v.44)
                                        ((lambda
                                          (k)
                                          ((lambda
                                            (v.45)
                                            (if
                                             (pair? v.45)
                                             ((lambda
                                               (v.46)
                                               ((lambda
                                                 (i)
                                                 ((lambda
                                                   (v.47)
                                                   (if
                                                    (pair? v.47)
                                                    ((lambda
                                                      (v.48)
                                                      ((lambda
                                                        (v)
                                                        ((lambda
                                                          (v.49)
                                                          (if
                                                           (null? v.49)
                                                           (cons
                                                            (rename
                                                             (quote match-extract-quasiquote-vars))
                                                            (cons x
                                                             (cons k
                                                              (cons i
                                                               (cons v
                                                                (cons
                                                                 (cons #t
                                                                  (quote
                                                                   ()))
                                                                 (quote
                                                                  ()))))))) #f))
                                                         (cdr v.47))) v.48))
                                                     (car v.47)) #f))
                                                  (cdr v.45))) v.46))
                                              (car v.45)) #f))
                                           (cdr v.43))) v.44))
                                       (car v.43)) #f))
                                    (cdr v.37)) #f))
                                 (cdr v.40))) v.41))
                             (car v.40)) #f))
                          (cdr v.38)) #f))
                       (car v.38)) #f))
                    (car v.37)) #f))
                 (cdr expr)))))
             ((lambda
               (v.24)
               (if
                (pair? v.24)
                ((lambda
                  (v.25)
                  (if
                   (pair? v.25)
                   ((lambda
                     (v.26)
                     (if
                      (compare v.26
                       (quote quote))
                      ((lambda
                        (v.27)
                        (if
                         (pair? v.27)
                         ((lambda
                           (v.28)
                           ((lambda
                             (x)
                             ((lambda
                               (v.29)
                               (if
                                (null? v.29)
                                ((lambda
                                  (v.30)
                                  (if
                                   (pair? v.30)
                                   ((lambda
                                     (v.31)
                                     (if
                                      (list? v.31)
                                      ((lambda
                                        (k)
                                        ((lambda
                                          (v.32)
                                          (if
                                           (pair? v.32)
                                           ((lambda
                                             (v.33)
                                             ((lambda
                                               (i)
                                               ((lambda
                                                 (v.34)
                                                 (if
                                                  (pair? v.34)
                                                  ((lambda
                                                    (v.35)
                                                    ((lambda
                                                      (v)
                                                      ((lambda
                                                        (v.36)
                                                        (if
                                                         (null? v.36)
                                                         (append
                                                          (map
                                                           (lambda
                                                            (k) k) k)
                                                          (cons v
                                                           (quote
                                                            ()))) #f))
                                                       (cdr v.34))) v.35))
                                                   (car v.34)) #f))
                                                (cdr v.32))) v.33))
                                            (car v.32)) #f))
                                         (cdr v.30))) v.31) #f))
                                    (car v.30)) #f))
                                 (cdr v.24)) #f))
                              (cdr v.27))) v.28))
                          (car v.27)) #f))
                       (cdr v.25)) #f))
                    (car v.25)) #f))
                 (car v.24)) #f))
              (cdr expr)))))
          ((lambda
            (v.15)
            (if
             (pair? v.15)
             ((lambda
               (v.16)
               (if
                (pair? v.16)
                ((lambda
                  (v.17)
                  (if
                   (compare v.17
                    (quote =))
                   ((lambda
                     (v.18)
                     (if
                      (pair? v.18)
                      ((lambda
                        (v.19)
                        ((lambda
                          (proc)
                          ((lambda
                            (v.20)
                            (if
                             (pair? v.20)
                             ((lambda
                               (v.21)
                               ((lambda
                                 (p)
                                 ((lambda
                                   (v.22)
                                   (if
                                    (null? v.22)
                                    ((lambda
                                      (v.23)
                                      ((lambda
                                        (x)
                                        (cons
                                         (rename
                                          (quote match-extract-vars))
                                         (cons p x))) v.23))
                                     (cdr v.15)) #f))
                                  (cdr v.20))) v.21))
                              (car v.20)) #f))
                           (cdr v.18))) v.19))
                       (car v.18)) #f))
                    (cdr v.16)) #f))
                 (car v.16)) #f))
              (car v.15)) #f))
           (cdr expr)))))
       ((lambda
         (v.8)
         (if
          (pair? v.8)
          ((lambda
            (v.9)
            (if
             (pair? v.9)
             ((lambda
               (v.10)
               (if
                (compare v.10
                 (quote $))
                ((lambda
                  (v.11)
                  (if
                   (pair? v.11)
                   ((lambda
                     (v.12)
                     ((lambda
                       (rec)
                       ((lambda
                         (v.13)
                         ((lambda
                           (p)
                           ((lambda
                             (v.14)
                             ((lambda
                               (x)
                               (cons
                                (rename
                                 (quote match-extract-vars))
                                (cons p x))) v.14))
                            (cdr v.8))) v.13))
                        (cdr v.11))) v.12))
                    (car v.11)) #f))
                 (cdr v.9)) #f))
              (car v.9)) #f))
           (car v.8)) #f))
        (cdr expr)))))
    ((lambda
      (v.1)
      (if
       (pair? v.1)
       ((lambda
         (v.2)
         (if
          (pair? v.2)
          ((lambda
            (v.3)
            (if
             (compare v.3
              (quote ?))
             ((lambda
               (v.4)
               (if
                (pair? v.4)
                ((lambda
                  (v.5)
                  ((lambda
                    (pred)
                    ((lambda
                      (v.6)
                      ((lambda
                        (p)
                        ((lambda
                          (v.7)
                          ((lambda
                            (x)
                            (cons
                             (rename
                              (quote match-extract-vars))
                             (cons p x))) v.7))
                         (cdr v.1))) v.6))
                     (cdr v.4))) v.5))
                 (car v.4)) #f))
              (cdr v.2)) #f))
           (car v.2)) #f))
        (car v.1)) #f))
     (cdr expr))))))

(define-syntax match-extract-vars-step
 (er-macro-transformer
  (lambda
   (expr rename compare)
   ((lambda
     (tmp)
     (if tmp tmp
      (error "no expansion for"
       (strip-syntactic-closures expr))))
    ((lambda
      (v.1)
      (if
       (pair? v.1)
       ((lambda
         (v.2)
         ((lambda
           (p)
           ((lambda
             (v.3)
             (if
              (pair? v.3)
              ((lambda
                (v.4)
                ((lambda
                  (k)
                  ((lambda
                    (v.5)
                    (if
                     (pair? v.5)
                     ((lambda
                       (v.6)
                       ((lambda
                         (i)
                         ((lambda
                           (v.7)
                           (if
                            (pair? v.7)
                            ((lambda
                              (v.8)
                              ((lambda
                                (v)
                                ((lambda
                                  (v.9)
                                  (if
                                   (pair? v.9)
                                   ((lambda
                                     (v.10)
                                     ((lambda
                                       ()
                                       (define lp #f)
                                       (set! lp
                                        (lambda
                                         (v.11 v2-ls v2-ls-ls)
                                         (if
                                          (null? v.11)
                                          ((lambda
                                            (v2 v2-ls)
                                            ((lambda
                                              (v.17)
                                              (if
                                               (null? v.17)
                                               (cons
                                                (rename
                                                 (quote match-extract-vars))
                                                (cons p
                                                 (cons k
                                                  (cons
                                                   (append
                                                    (map
                                                     (lambda
                                                      (v2) v2) v2) i)
                                                   (cons
                                                    (append
                                                     (map
                                                      (lambda
                                                       (v2 v2-ls)
                                                       (cons v2
                                                        (cons v2-ls
                                                         (quote
                                                          ())))) v2 v2-ls) v)
                                                    (quote
                                                     ())))))) #f))
                                             (cdr v.9)))
                                           (reverse v2-ls)
                                           (reverse v2-ls-ls))
                                          (if
                                           (pair? v.11)
                                           ((lambda
                                             (v.12)
                                             (if
                                              (pair? v.12)
                                              ((lambda
                                                (v.13)
                                                ((lambda
                                                  (v2)
                                                  ((lambda
                                                    (v.14)
                                                    (if
                                                     (pair? v.14)
                                                     ((lambda
                                                       (v.15)
                                                       ((lambda
                                                         (v2-ls.1)
                                                         ((lambda
                                                           (v.16)
                                                           (if
                                                            (null? v.16)
                                                            (lp
                                                             (cdr v.11)
                                                             (cons v2 v2-ls)
                                                             (cons v2-ls.1 v2-ls-ls)) #f))
                                                          (cdr v.14))) v.15))
                                                      (car v.14)) #f))
                                                   (cdr v.12))) v.13))
                                               (car v.12)) #f))
                                            (car v.11)) #f)))) #<undef>
                                       (lp v.10
                                        ()
                                        ()))))
                                    (car v.9)) #f))
                                 (cdr v.7))) v.8))
                             (car v.7)) #f))
                          (cdr v.5))) v.6))
                      (car v.5)) #f))
                   (cdr v.3))) v.4))
               (car v.3)) #f))
            (cdr v.1))) v.2))
        (car v.1)) #f))
     (cdr expr))))))

(define-syntax match-extract-quasiquote-vars
 (er-macro-transformer
  (lambda
   (expr rename compare)
   ((lambda
     (tmp)
     (if tmp tmp
      ((lambda
        (tmp)
        (if tmp tmp
         ((lambda
           (tmp)
           (if tmp tmp
            ((lambda
              (tmp)
              (if tmp tmp
               ((lambda
                 (tmp)
                 (if tmp tmp
                  ((lambda
                    (tmp)
                    (if tmp tmp
                     ((lambda
                       (tmp)
                       (if tmp tmp
                        (error "no expansion for"
                         (strip-syntactic-closures expr))))
                      ((lambda
                        (v.94)
                        (if
                         (pair? v.94)
                         ((lambda
                           (v.95)
                           ((lambda
                             (x)
                             ((lambda
                               (v.96)
                               (if
                                (pair? v.96)
                                ((lambda
                                  (v.97)
                                  (if
                                   (list? v.97)
                                   ((lambda
                                     (k)
                                     ((lambda
                                       (v.98)
                                       (if
                                        (pair? v.98)
                                        ((lambda
                                          (v.99)
                                          ((lambda
                                            (i)
                                            ((lambda
                                              (v.100)
                                              (if
                                               (pair? v.100)
                                               ((lambda
                                                 (v.101)
                                                 ((lambda
                                                   (v)
                                                   ((lambda
                                                     (v.102)
                                                     (if
                                                      (pair? v.102)
                                                      ((lambda
                                                        (v.103)
                                                        (if
                                                         (pair? v.103)
                                                         ((lambda
                                                           (v.104)
                                                           (if
                                                            (equal? v.104 #t)
                                                            ((lambda
                                                              (v.105)
                                                              ((lambda
                                                                (d)
                                                                ((lambda
                                                                  (v.106)
                                                                  (if
                                                                   (null? v.106)
                                                                   (append
                                                                    (map
                                                                     (lambda
                                                                      (k) k) k)
                                                                    (cons v
                                                                     (quote
                                                                      ()))) #f))
                                                                 (cdr v.102))) v.105))
                                                             (cdr v.103)) #f))
                                                          (car v.103)) #f))
                                                       (car v.102)) #f))
                                                    (cdr v.100))) v.101))
                                                (car v.100)) #f))
                                             (cdr v.98))) v.99))
                                         (car v.98)) #f))
                                      (cdr v.96))) v.97) #f))
                                 (car v.96)) #f))
                              (cdr v.94))) v.95))
                          (car v.94)) #f))
                       (cdr expr)))))
                   ((lambda
                     (v.80)
                     (if
                      (pair? v.80)
                      ((lambda
                        (v.81)
                        (if
                         (vector? v.81)
                         ((lambda
                           (v.82)
                           (if
                            (list? v.82)
                            ((lambda
                              (x)
                              ((lambda
                                (v.83)
                                (if
                                 (pair? v.83)
                                 ((lambda
                                   (v.84)
                                   ((lambda
                                     (k)
                                     ((lambda
                                       (v.85)
                                       (if
                                        (pair? v.85)
                                        ((lambda
                                          (v.86)
                                          ((lambda
                                            (i)
                                            ((lambda
                                              (v.87)
                                              (if
                                               (pair? v.87)
                                               ((lambda
                                                 (v.88)
                                                 ((lambda
                                                   (v)
                                                   ((lambda
                                                     (v.89)
                                                     (if
                                                      (pair? v.89)
                                                      ((lambda
                                                        (v.90)
                                                        (if
                                                         (pair? v.90)
                                                         ((lambda
                                                           (v.91)
                                                           (if
                                                            (equal? v.91 #t)
                                                            ((lambda
                                                              (v.92)
                                                              ((lambda
                                                                (d)
                                                                ((lambda
                                                                  (v.93)
                                                                  (if
                                                                   (null? v.93)
                                                                   (cons
                                                                    (rename
                                                                     (quote match-extract-quasiquote-vars))
                                                                    (cons
                                                                     (map
                                                                      (lambda
                                                                       (x) x) x)
                                                                     (cons k
                                                                      (cons i
                                                                       (cons v
                                                                        (cons d
                                                                         (quote
                                                                          ()))))))) #f))
                                                                 (cdr v.89))) v.92))
                                                             (cdr v.90)) #f))
                                                          (car v.90)) #f))
                                                       (car v.89)) #f))
                                                    (cdr v.87))) v.88))
                                                (car v.87)) #f))
                                             (cdr v.85))) v.86))
                                         (car v.85)) #f))
                                      (cdr v.83))) v.84))
                                  (car v.83)) #f))
                               (cdr v.80))) v.82) #f))
                          (vector->list v.81)) #f))
                       (car v.80)) #f))
                    (cdr expr)))))
                ((lambda
                  (v.65)
                  (if
                   (pair? v.65)
                   ((lambda
                     (v.66)
                     (if
                      (pair? v.66)
                      ((lambda
                        (v.67)
                        ((lambda
                          (x)
                          ((lambda
                            (v.68)
                            ((lambda
                              (y)
                              ((lambda
                                (v.69)
                                (if
                                 (pair? v.69)
                                 ((lambda
                                   (v.70)
                                   ((lambda
                                     (k)
                                     ((lambda
                                       (v.71)
                                       (if
                                        (pair? v.71)
                                        ((lambda
                                          (v.72)
                                          ((lambda
                                            (i)
                                            ((lambda
                                              (v.73)
                                              (if
                                               (pair? v.73)
                                               ((lambda
                                                 (v.74)
                                                 ((lambda
                                                   (v)
                                                   ((lambda
                                                     (v.75)
                                                     (if
                                                      (pair? v.75)
                                                      ((lambda
                                                        (v.76)
                                                        (if
                                                         (pair? v.76)
                                                         ((lambda
                                                           (v.77)
                                                           (if
                                                            (equal? v.77 #t)
                                                            ((lambda
                                                              (v.78)
                                                              ((lambda
                                                                (d)
                                                                ((lambda
                                                                  (v.79)
                                                                  (if
                                                                   (null? v.79)
                                                                   (cons
                                                                    (rename
                                                                     (quote match-extract-quasiquote-vars))
                                                                    (cons x
                                                                     (cons
                                                                      (cons
                                                                       (rename
                                                                        (quote match-extract-quasiquote-vars-step))
                                                                       (cons y
                                                                        (cons k
                                                                         (cons i
                                                                          (cons v
                                                                           (cons d
                                                                            (quote
                                                                             ())))))))
                                                                      (cons i
                                                                       (cons
                                                                        (quote
                                                                         ())
                                                                        (quote
                                                                         ())))))) #f))
                                                                 (cdr v.75))) v.78))
                                                             (cdr v.76)) #f))
                                                          (car v.76)) #f))
                                                       (car v.75)) #f))
                                                    (cdr v.73))) v.74))
                                                (car v.73)) #f))
                                             (cdr v.71))) v.72))
                                         (car v.71)) #f))
                                      (cdr v.69))) v.70))
                                  (car v.69)) #f))
                               (cdr v.65))) v.68))
                           (cdr v.66))) v.67))
                       (car v.66)) #f))
                    (car v.65)) #f))
                 (cdr expr)))))
             ((lambda
               (v.48)
               (if
                (pair? v.48)
                ((lambda
                  (v.49)
                  (if
                   (pair? v.49)
                   ((lambda
                     (v.50)
                     (if
                      (compare v.50
                       (quote unquote))
                      ((lambda
                        (v.51)
                        (if
                         (pair? v.51)
                         ((lambda
                           (v.52)
                           ((lambda
                             (x)
                             ((lambda
                               (v.53)
                               (if
                                (null? v.53)
                                ((lambda
                                  (v.54)
                                  (if
                                   (pair? v.54)
                                   ((lambda
                                     (v.55)
                                     ((lambda
                                       (k)
                                       ((lambda
                                         (v.56)
                                         (if
                                          (pair? v.56)
                                          ((lambda
                                            (v.57)
                                            ((lambda
                                              (i)
                                              ((lambda
                                                (v.58)
                                                (if
                                                 (pair? v.58)
                                                 ((lambda
                                                   (v.59)
                                                   ((lambda
                                                     (v)
                                                     ((lambda
                                                       (v.60)
                                                       (if
                                                        (pair? v.60)
                                                        ((lambda
                                                          (v.61)
                                                          (if
                                                           (pair? v.61)
                                                           ((lambda
                                                             (v.62)
                                                             (if
                                                              (equal? v.62 #t)
                                                              ((lambda
                                                                (v.63)
                                                                ((lambda
                                                                  (d)
                                                                  ((lambda
                                                                    (v.64)
                                                                    (if
                                                                     (null? v.64)
                                                                     (cons
                                                                      (rename
                                                                       (quote match-extract-quasiquote-vars))
                                                                      (cons x
                                                                       (cons k
                                                                        (cons i
                                                                         (cons v
                                                                          (cons d
                                                                           (quote
                                                                            ()))))))) #f))
                                                                   (cdr v.60))) v.63))
                                                               (cdr v.61)) #f))
                                                            (car v.61)) #f))
                                                         (car v.60)) #f))
                                                      (cdr v.58))) v.59))
                                                  (car v.58)) #f))
                                               (cdr v.56))) v.57))
                                           (car v.56)) #f))
                                        (cdr v.54))) v.55))
                                    (car v.54)) #f))
                                 (cdr v.48)) #f))
                              (cdr v.51))) v.52))
                          (car v.51)) #f))
                       (cdr v.49)) #f))
                    (car v.49)) #f))
                 (car v.48)) #f))
              (cdr expr)))))
          ((lambda
            (v.31)
            (if
             (pair? v.31)
             ((lambda
               (v.32)
               (if
                (pair? v.32)
                ((lambda
                  (v.33)
                  (if
                   (compare v.33
                    (quote unquote))
                   ((lambda
                     (v.34)
                     (if
                      (pair? v.34)
                      ((lambda
                        (v.35)
                        ((lambda
                          (x)
                          ((lambda
                            (v.36)
                            (if
                             (null? v.36)
                             ((lambda
                               (v.37)
                               (if
                                (pair? v.37)
                                ((lambda
                                  (v.38)
                                  ((lambda
                                    (k)
                                    ((lambda
                                      (v.39)
                                      (if
                                       (pair? v.39)
                                       ((lambda
                                         (v.40)
                                         ((lambda
                                           (i)
                                           ((lambda
                                             (v.41)
                                             (if
                                              (pair? v.41)
                                              ((lambda
                                                (v.42)
                                                ((lambda
                                                  (v)
                                                  ((lambda
                                                    (v.43)
                                                    (if
                                                     (pair? v.43)
                                                     ((lambda
                                                       (v.44)
                                                       (if
                                                        (pair? v.44)
                                                        ((lambda
                                                          (v.45)
                                                          (if
                                                           (equal? v.45 #t)
                                                           ((lambda
                                                             (v.46)
                                                             (if
                                                              (null? v.46)
                                                              ((lambda
                                                                (v.47)
                                                                (if
                                                                 (null? v.47)
                                                                 (cons
                                                                  (rename
                                                                   (quote match-extract-vars))
                                                                  (cons x
                                                                   (cons k
                                                                    (cons i
                                                                     (cons v
                                                                      (quote
                                                                       ())))))) #f))
                                                               (cdr v.43)) #f))
                                                            (cdr v.44)) #f))
                                                         (car v.44)) #f))
                                                      (car v.43)) #f))
                                                   (cdr v.41))) v.42))
                                               (car v.41)) #f))
                                            (cdr v.39))) v.40))
                                        (car v.39)) #f))
                                     (cdr v.37))) v.38))
                                 (car v.37)) #f))
                              (cdr v.31)) #f))
                           (cdr v.34))) v.35))
                       (car v.34)) #f))
                    (cdr v.32)) #f))
                 (car v.32)) #f))
              (car v.31)) #f))
           (cdr expr)))))
       ((lambda
         (v.16)
         (if
          (pair? v.16)
          ((lambda
            (v.17)
            (if
             (pair? v.17)
             ((lambda
               (v.18)
               (if
                (compare v.18
                 (quote unquote-splicing))
                ((lambda
                  (v.19)
                  (if
                   (pair? v.19)
                   ((lambda
                     (v.20)
                     ((lambda
                       (x)
                       ((lambda
                         (v.21)
                         (if
                          (null? v.21)
                          ((lambda
                            (v.22)
                            (if
                             (pair? v.22)
                             ((lambda
                               (v.23)
                               ((lambda
                                 (k)
                                 ((lambda
                                   (v.24)
                                   (if
                                    (pair? v.24)
                                    ((lambda
                                      (v.25)
                                      ((lambda
                                        (i)
                                        ((lambda
                                          (v.26)
                                          (if
                                           (pair? v.26)
                                           ((lambda
                                             (v.27)
                                             ((lambda
                                               (v)
                                               ((lambda
                                                 (v.28)
                                                 (if
                                                  (pair? v.28)
                                                  ((lambda
                                                    (v.29)
                                                    ((lambda
                                                      (d)
                                                      ((lambda
                                                        (v.30)
                                                        (if
                                                         (null? v.30)
                                                         (cons
                                                          (rename
                                                           (quote match-extract-quasiquote-vars))
                                                          (cons
                                                           (cons
                                                            (rename
                                                             (quote unquote))
                                                            (cons x
                                                             (quote
                                                              ())))
                                                           (cons k
                                                            (cons i
                                                             (cons v
                                                              (cons d
                                                               (quote
                                                                ()))))))) #f))
                                                       (cdr v.28))) v.29))
                                                   (car v.28)) #f))
                                                (cdr v.26))) v.27))
                                            (car v.26)) #f))
                                         (cdr v.24))) v.25))
                                     (car v.24)) #f))
                                  (cdr v.22))) v.23))
                              (car v.22)) #f))
                           (cdr v.16)) #f))
                        (cdr v.19))) v.20))
                    (car v.19)) #f))
                 (cdr v.17)) #f))
              (car v.17)) #f))
           (car v.16)) #f))
        (cdr expr)))))
    ((lambda
      (v.1)
      (if
       (pair? v.1)
       ((lambda
         (v.2)
         (if
          (pair? v.2)
          ((lambda
            (v.3)
            (if
             (compare v.3
              (quote quasiquote))
             ((lambda
               (v.4)
               (if
                (pair? v.4)
                ((lambda
                  (v.5)
                  ((lambda
                    (x)
                    ((lambda
                      (v.6)
                      (if
                       (null? v.6)
                       ((lambda
                         (v.7)
                         (if
                          (pair? v.7)
                          ((lambda
                            (v.8)
                            ((lambda
                              (k)
                              ((lambda
                                (v.9)
                                (if
                                 (pair? v.9)
                                 ((lambda
                                   (v.10)
                                   ((lambda
                                     (i)
                                     ((lambda
                                       (v.11)
                                       (if
                                        (pair? v.11)
                                        ((lambda
                                          (v.12)
                                          ((lambda
                                            (v)
                                            ((lambda
                                              (v.13)
                                              (if
                                               (pair? v.13)
                                               ((lambda
                                                 (v.14)
                                                 ((lambda
                                                   (d)
                                                   ((lambda
                                                     (v.15)
                                                     (if
                                                      (null? v.15)
                                                      (cons
                                                       (rename
                                                        (quote match-extract-quasiquote-vars))
                                                       (cons x
                                                        (cons k
                                                         (cons i
                                                          (cons v
                                                           (cons
                                                            (cons #t d)
                                                            (quote
                                                             ()))))))) #f))
                                                    (cdr v.13))) v.14))
                                                (car v.13)) #f))
                                             (cdr v.11))) v.12))
                                         (car v.11)) #f))
                                      (cdr v.9))) v.10))
                                  (car v.9)) #f))
                               (cdr v.7))) v.8))
                           (car v.7)) #f))
                        (cdr v.1)) #f))
                     (cdr v.4))) v.5))
                 (car v.4)) #f))
              (cdr v.2)) #f))
           (car v.2)) #f))
        (car v.1)) #f))
     (cdr expr))))))

(define-syntax match-extract-quasiquote-vars-step
 (er-macro-transformer
  (lambda
   (expr rename compare)
   ((lambda
     (tmp)
     (if tmp tmp
      (error "no expansion for"
       (strip-syntactic-closures expr))))
    ((lambda
      (v.1)
      (if
       (pair? v.1)
       ((lambda
         (v.2)
         ((lambda
           (x)
           ((lambda
             (v.3)
             (if
              (pair? v.3)
              ((lambda
                (v.4)
                ((lambda
                  (k)
                  ((lambda
                    (v.5)
                    (if
                     (pair? v.5)
                     ((lambda
                       (v.6)
                       ((lambda
                         (i)
                         ((lambda
                           (v.7)
                           (if
                            (pair? v.7)
                            ((lambda
                              (v.8)
                              ((lambda
                                (v)
                                ((lambda
                                  (v.9)
                                  (if
                                   (pair? v.9)
                                   ((lambda
                                     (v.10)
                                     ((lambda
                                       (d)
                                       ((lambda
                                         (v.11)
                                         (if
                                          (pair? v.11)
                                          ((lambda
                                            (v.12)
                                            ((lambda
                                              ()
                                              (define lp #f)
                                              (set! lp
                                               (lambda
                                                (v.13 v2-ls v2-ls-ls)
                                                (if
                                                 (null? v.13)
                                                 ((lambda
                                                   (v2 v2-ls)
                                                   ((lambda
                                                     (v.19)
                                                     (if
                                                      (null? v.19)
                                                      (cons
                                                       (rename
                                                        (quote match-extract-quasiquote-vars))
                                                       (cons x
                                                        (cons k
                                                         (cons
                                                          (append
                                                           (map
                                                            (lambda
                                                             (v2) v2) v2) i)
                                                          (cons
                                                           (append
                                                            (map
                                                             (lambda
                                                              (v2 v2-ls)
                                                              (cons v2
                                                               (cons v2-ls
                                                                (quote
                                                                 ())))) v2 v2-ls) v)
                                                           (cons d
                                                            (quote
                                                             ()))))))) #f))
                                                    (cdr v.11)))
                                                  (reverse v2-ls)
                                                  (reverse v2-ls-ls))
                                                 (if
                                                  (pair? v.13)
                                                  ((lambda
                                                    (v.14)
                                                    (if
                                                     (pair? v.14)
                                                     ((lambda
                                                       (v.15)
                                                       ((lambda
                                                         (v2)
                                                         ((lambda
                                                           (v.16)
                                                           (if
                                                            (pair? v.16)
                                                            ((lambda
                                                              (v.17)
                                                              ((lambda
                                                                (v2-ls.1)
                                                                ((lambda
                                                                  (v.18)
                                                                  (if
                                                                   (null? v.18)
                                                                   (lp
                                                                    (cdr v.13)
                                                                    (cons v2 v2-ls)
                                                                    (cons v2-ls.1 v2-ls-ls)) #f))
                                                                 (cdr v.16))) v.17))
                                                             (car v.16)) #f))
                                                          (cdr v.14))) v.15))
                                                      (car v.14)) #f))
                                                   (car v.13)) #f)))) #<undef>
                                              (lp v.12
                                               ()
                                               ()))))
                                           (car v.11)) #f))
                                        (cdr v.9))) v.10))
                                    (car v.9)) #f))
                                 (cdr v.7))) v.8))
                             (car v.7)) #f))
                          (cdr v.5))) v.6))
                      (car v.5)) #f))
                   (cdr v.3))) v.4))
               (car v.3)) #f))
            (cdr v.1))) v.2))
        (car v.1)) #f))
     (cdr expr))))))

(define-syntax match-lambda
 (er-macro-transformer
  (lambda
   (expr rename compare)
   ((lambda
     (tmp)
     (if tmp tmp
      (error "no expansion for"
       (strip-syntactic-closures expr))))
    ((lambda
      (v.1)
      (if
       (list? v.1)
       ((lambda
         (clause)
         (cons
          (rename
           (quote lambda))
          (cons
           (cons
            (rename
             (quote expr))
            (quote
             ()))
           (cons
            (cons
             (rename
              (quote match))
             (cons
              (rename
               (quote expr))
              (map
               (lambda
                (clause) clause) clause)))
            (quote
             ()))))) v.1) #f))
     (cdr expr))))))

(define-syntax match-lambda*
 (er-macro-transformer
  (lambda
   (expr rename compare)
   ((lambda
     (tmp)
     (if tmp tmp
      (error "no expansion for"
       (strip-syntactic-closures expr))))
    ((lambda
      (v.1)
      (if
       (list? v.1)
       ((lambda
         (clause)
         (cons
          (rename
           (quote lambda))
          (cons
           (rename
            (quote expr))
           (cons
            (cons
             (rename
              (quote match))
             (cons
              (rename
               (quote expr))
              (map
               (lambda
                (clause) clause) clause)))
            (quote
             ()))))) v.1) #f))
     (cdr expr))))))

(define-syntax match-let
 (er-macro-transformer
  (lambda
   (expr rename compare)
   ((lambda
     (tmp)
     (if tmp tmp
      ((lambda
        (tmp)
        (if tmp tmp
         (error "no expansion for"
          (strip-syntactic-closures expr))))
       ((lambda
         (v.4)
         (if
          (pair? v.4)
          ((lambda
            (v.5)
            ((lambda
              (loop)
              ((lambda
                (v.6)
                ((lambda
                  (rest)
                  (cons
                   (rename
                    (quote match-named-let))
                   (cons loop
                    (cons
                     (quote
                      ()) rest)))) v.6))
               (cdr v.4))) v.5))
           (car v.4)) #f))
        (cdr expr)))))
    ((lambda
      (v.1)
      (if
       (pair? v.1)
       ((lambda
         (v.2)
         (if
          (list? v.2)
          ((lambda
            (vars)
            ((lambda
              (v.3)
              ((lambda
                (body)
                (cons
                 (rename
                  (quote match-let/helper))
                 (cons
                  (rename
                   (quote let))
                  (cons
                   (quote
                    ())
                   (cons
                    (quote
                     ())
                    (cons
                     (map
                      (lambda
                       (vars) vars) vars) body)))))) v.3))
             (cdr v.1))) v.2) #f))
        (car v.1)) #f))
     (cdr expr))))))

(define-syntax match-letrec
 (er-macro-transformer
  (lambda
   (expr rename compare)
   ((lambda
     (tmp)
     (if tmp tmp
      (error "no expansion for"
       (strip-syntactic-closures expr))))
    ((lambda
      (v.1)
      (if
       (pair? v.1)
       ((lambda
         (v.2)
         ((lambda
           (vars)
           ((lambda
             (v.3)
             ((lambda
               (body)
               (cons
                (rename
                 (quote match-let/helper))
                (cons
                 (rename
                  (quote letrec))
                 (cons
                  (quote
                   ())
                  (cons
                   (quote
                    ())
                   (cons vars body)))))) v.3))
            (cdr v.1))) v.2))
        (car v.1)) #f))
     (cdr expr))))))

(define-syntax match-let/helper
 (er-macro-transformer
  (lambda
   (expr rename compare)
   ((lambda
     (tmp)
     (if tmp tmp
      ((lambda
        (tmp)
        (if tmp tmp
         ((lambda
           (tmp)
           (if tmp tmp
            ((lambda
              (tmp)
              (if tmp tmp
               ((lambda
                 (tmp)
                 (if tmp tmp
                  (error "no expansion for"
                   (strip-syntactic-closures expr))))
                ((lambda
                  (v.70)
                  (if
                   (pair? v.70)
                   ((lambda
                     (v.71)
                     ((lambda
                       (let)
                       ((lambda
                         (v.72)
                         (if
                          (pair? v.72)
                          ((lambda
                            (v.73)
                            (if
                             (list? v.73)
                             ((lambda
                               (v)
                               ((lambda
                                 (v.74)
                                 (if
                                  (pair? v.74)
                                  ((lambda
                                    (v.75)
                                    (if
                                     (list? v.75)
                                     ((lambda
                                       (p)
                                       ((lambda
                                         (v.76)
                                         (if
                                          (pair? v.76)
                                          ((lambda
                                            (v.77)
                                            (if
                                             (pair? v.77)
                                             ((lambda
                                               (v.78)
                                               (if
                                                (pair? v.78)
                                                ((lambda
                                                  (v.79)
                                                  ((lambda
                                                    (a)
                                                    ((lambda
                                                      (v.80)
                                                      (if
                                                       (pair? v.80)
                                                       ((lambda
                                                         (v.81)
                                                         ((lambda
                                                           (expr)
                                                           ((lambda
                                                             (v.82)
                                                             (if
                                                              (null? v.82)
                                                              ((lambda
                                                                (v.83)
                                                                ((lambda
                                                                  (rest)
                                                                  ((lambda
                                                                    (v.84)
                                                                    ((lambda
                                                                      (body)
                                                                      (cons
                                                                       (rename
                                                                        (quote match-let/helper))
                                                                       (cons let
                                                                        (cons
                                                                         (append
                                                                          (map
                                                                           (lambda
                                                                            (v) v) v)
                                                                          (cons
                                                                           (cons a
                                                                            (cons expr
                                                                             (quote
                                                                              ())))
                                                                           (quote
                                                                            ())))
                                                                         (cons
                                                                          (map
                                                                           (lambda
                                                                            (p) p) p)
                                                                          (cons rest body)))))) v.84))
                                                                   (cdr v.76))) v.83))
                                                               (cdr v.77)) #f))
                                                            (cdr v.80))) v.81))
                                                        (car v.80)) #f))
                                                     (cdr v.78))) v.79))
                                                 (car v.78)) #f))
                                              (car v.77)) #f))
                                           (car v.76)) #f))
                                        (cdr v.74))) v.75) #f))
                                   (car v.74)) #f))
                                (cdr v.72))) v.73) #f))
                           (car v.72)) #f))
                        (cdr v.70))) v.71))
                    (car v.70)) #f))
                 (cdr expr)))))
             ((lambda
               (v.54)
               (if
                (pair? v.54)
                ((lambda
                  (v.55)
                  ((lambda
                    (let)
                    ((lambda
                      (v.56)
                      (if
                       (pair? v.56)
                       ((lambda
                         (v.57)
                         (if
                          (list? v.57)
                          ((lambda
                            (v)
                            ((lambda
                              (v.58)
                              (if
                               (pair? v.58)
                               ((lambda
                                 (v.59)
                                 (if
                                  (list? v.59)
                                  ((lambda
                                    (p)
                                    ((lambda
                                      (v.60)
                                      (if
                                       (pair? v.60)
                                       ((lambda
                                         (v.61)
                                         (if
                                          (pair? v.61)
                                          ((lambda
                                            (v.62)
                                            (if
                                             (pair? v.62)
                                             ((lambda
                                               (v.63)
                                               (if
                                                (vector? v.63)
                                                ((lambda
                                                  (v.64)
                                                  (if
                                                   (list? v.64)
                                                   ((lambda
                                                     (a)
                                                     ((lambda
                                                       (v.65)
                                                       (if
                                                        (pair? v.65)
                                                        ((lambda
                                                          (v.66)
                                                          ((lambda
                                                            (expr)
                                                            ((lambda
                                                              (v.67)
                                                              (if
                                                               (null? v.67)
                                                               ((lambda
                                                                 (v.68)
                                                                 ((lambda
                                                                   (rest)
                                                                   ((lambda
                                                                     (v.69)
                                                                     ((lambda
                                                                       (body)
                                                                       (cons
                                                                        (rename
                                                                         (quote match-let/helper))
                                                                        (cons let
                                                                         (cons
                                                                          (append
                                                                           (map
                                                                            (lambda
                                                                             (v) v) v)
                                                                           (cons
                                                                            (cons
                                                                             (rename
                                                                              (quote tmp))
                                                                             (cons expr
                                                                              (quote
                                                                               ())))
                                                                            (quote
                                                                             ())))
                                                                          (cons
                                                                           (append
                                                                            (map
                                                                             (lambda
                                                                              (p) p) p)
                                                                            (cons
                                                                             (cons
                                                                              (list->vector
                                                                               (map
                                                                                (lambda
                                                                                 (a) a) a))
                                                                              (cons
                                                                               (rename
                                                                                (quote tmp))
                                                                               (quote
                                                                                ())))
                                                                             (quote
                                                                              ())))
                                                                           (cons rest body)))))) v.69))
                                                                    (cdr v.60))) v.68))
                                                                (cdr v.61)) #f))
                                                             (cdr v.65))) v.66))
                                                         (car v.65)) #f))
                                                      (cdr v.62))) v.64) #f))
                                                 (vector->list v.63)) #f))
                                              (car v.62)) #f))
                                           (car v.61)) #f))
                                        (car v.60)) #f))
                                     (cdr v.58))) v.59) #f))
                                (car v.58)) #f))
                             (cdr v.56))) v.57) #f))
                        (car v.56)) #f))
                     (cdr v.54))) v.55))
                 (car v.54)) #f))
              (cdr expr)))))
          ((lambda
            (v.37)
            (if
             (pair? v.37)
             ((lambda
               (v.38)
               ((lambda
                 (let)
                 ((lambda
                   (v.39)
                   (if
                    (pair? v.39)
                    ((lambda
                      (v.40)
                      (if
                       (list? v.40)
                       ((lambda
                         (v)
                         ((lambda
                           (v.41)
                           (if
                            (pair? v.41)
                            ((lambda
                              (v.42)
                              (if
                               (list? v.42)
                               ((lambda
                                 (p)
                                 ((lambda
                                   (v.43)
                                   (if
                                    (pair? v.43)
                                    ((lambda
                                      (v.44)
                                      (if
                                       (pair? v.44)
                                       ((lambda
                                         (v.45)
                                         (if
                                          (pair? v.45)
                                          ((lambda
                                            (v.46)
                                            (if
                                             (pair? v.46)
                                             ((lambda
                                               (v.47)
                                               ((lambda
                                                 (a)
                                                 ((lambda
                                                   (v.48)
                                                   ((lambda
                                                     (b)
                                                     ((lambda
                                                       (v.49)
                                                       (if
                                                        (pair? v.49)
                                                        ((lambda
                                                          (v.50)
                                                          ((lambda
                                                            (expr)
                                                            ((lambda
                                                              (v.51)
                                                              (if
                                                               (null? v.51)
                                                               ((lambda
                                                                 (v.52)
                                                                 ((lambda
                                                                   (rest)
                                                                   ((lambda
                                                                     (v.53)
                                                                     ((lambda
                                                                       (body)
                                                                       (cons
                                                                        (rename
                                                                         (quote match-let/helper))
                                                                        (cons let
                                                                         (cons
                                                                          (append
                                                                           (map
                                                                            (lambda
                                                                             (v) v) v)
                                                                           (cons
                                                                            (cons
                                                                             (rename
                                                                              (quote tmp))
                                                                             (cons expr
                                                                              (quote
                                                                               ())))
                                                                            (quote
                                                                             ())))
                                                                          (cons
                                                                           (append
                                                                            (map
                                                                             (lambda
                                                                              (p) p) p)
                                                                            (cons
                                                                             (cons
                                                                              (cons a b)
                                                                              (cons
                                                                               (rename
                                                                                (quote tmp))
                                                                               (quote
                                                                                ())))
                                                                             (quote
                                                                              ())))
                                                                           (cons rest body)))))) v.53))
                                                                    (cdr v.43))) v.52))
                                                                (cdr v.44)) #f))
                                                             (cdr v.49))) v.50))
                                                         (car v.49)) #f))
                                                      (cdr v.45))) v.48))
                                                  (cdr v.46))) v.47))
                                              (car v.46)) #f))
                                           (car v.45)) #f))
                                        (car v.44)) #f))
                                     (car v.43)) #f))
                                  (cdr v.41))) v.42) #f))
                             (car v.41)) #f))
                          (cdr v.39))) v.40) #f))
                     (car v.39)) #f))
                  (cdr v.37))) v.38))
              (car v.37)) #f))
           (cdr expr)))))
       ((lambda
         (v.16)
         (if
          (pair? v.16)
          ((lambda
            (v.17)
            ((lambda
              (let)
              ((lambda
                (v.18)
                (if
                 (pair? v.18)
                 ((lambda
                   (v.19)
                   ((lambda
                     ()
                     (define lp #f)
                     (set! lp
                      (lambda
                       (v.20 var-ls expr-ls)
                       (if
                        (null? v.20)
                        ((lambda
                          (var expr)
                          ((lambda
                            (v.26)
                            (if
                             (pair? v.26)
                             ((lambda
                               (v.27)
                               ((lambda
                                 ()
                                 (define lp #f)
                                 (set! lp
                                  (lambda
                                   (v.28 pat-ls tmp-ls)
                                   (if
                                    (null? v.28)
                                    ((lambda
                                      (pat tmp)
                                      ((lambda
                                        (v.34)
                                        (if
                                         (pair? v.34)
                                         ((lambda
                                           (v.35)
                                           (if
                                            (null? v.35)
                                            ((lambda
                                              (v.36)
                                              ((lambda
                                                (body)
                                                (cons let
                                                 (cons
                                                  (map
                                                   (lambda
                                                    (var expr)
                                                    (cons var
                                                     (cons expr
                                                      (quote
                                                       ())))) var expr)
                                                  (cons
                                                   (cons
                                                    (rename
                                                     (quote match-let*))
                                                    (cons
                                                     (map
                                                      (lambda
                                                       (pat tmp)
                                                       (cons pat
                                                        (cons tmp
                                                         (quote
                                                          ())))) pat tmp) body))
                                                   (quote
                                                    ()))))) v.36))
                                             (cdr v.34)) #f))
                                          (car v.34)) #f))
                                       (cdr v.26)))
                                     (reverse pat-ls)
                                     (reverse tmp-ls))
                                    (if
                                     (pair? v.28)
                                     ((lambda
                                       (v.29)
                                       (if
                                        (pair? v.29)
                                        ((lambda
                                          (v.30)
                                          ((lambda
                                            (pat)
                                            ((lambda
                                              (v.31)
                                              (if
                                               (pair? v.31)
                                               ((lambda
                                                 (v.32)
                                                 ((lambda
                                                   (tmp)
                                                   ((lambda
                                                     (v.33)
                                                     (if
                                                      (null? v.33)
                                                      (lp
                                                       (cdr v.28)
                                                       (cons pat pat-ls)
                                                       (cons tmp tmp-ls)) #f))
                                                    (cdr v.31))) v.32))
                                                (car v.31)) #f))
                                             (cdr v.29))) v.30))
                                         (car v.29)) #f))
                                      (car v.28)) #f)))) #<undef>
                                 (lp v.27
                                  ()
                                  ()))))
                              (car v.26)) #f))
                           (cdr v.18)))
                         (reverse var-ls)
                         (reverse expr-ls))
                        (if
                         (pair? v.20)
                         ((lambda
                           (v.21)
                           (if
                            (pair? v.21)
                            ((lambda
                              (v.22)
                              ((lambda
                                (var)
                                ((lambda
                                  (v.23)
                                  (if
                                   (pair? v.23)
                                   ((lambda
                                     (v.24)
                                     ((lambda
                                       (expr)
                                       ((lambda
                                         (v.25)
                                         (if
                                          (null? v.25)
                                          (lp
                                           (cdr v.20)
                                           (cons var var-ls)
                                           (cons expr expr-ls)) #f))
                                        (cdr v.23))) v.24))
                                    (car v.23)) #f))
                                 (cdr v.21))) v.22))
                             (car v.21)) #f))
                          (car v.20)) #f)))) #<undef>
                     (lp v.19
                      ()
                      ()))))
                  (car v.18)) #f))
               (cdr v.16))) v.17))
           (car v.16)) #f))
        (cdr expr)))))
    ((lambda
      (v.1)
      (if
       (pair? v.1)
       ((lambda
         (v.2)
         ((lambda
           (let)
           ((lambda
             (v.3)
             (if
              (pair? v.3)
              ((lambda
                (v.4)
                ((lambda
                  ()
                  (define lp #f)
                  (set! lp
                   (lambda
                    (v.5 var-ls expr-ls)
                    (if
                     (null? v.5)
                     ((lambda
                       (var expr)
                       ((lambda
                         (v.11)
                         (if
                          (pair? v.11)
                          ((lambda
                            (v.12)
                            (if
                             (null? v.12)
                             ((lambda
                               (v.13)
                               (if
                                (pair? v.13)
                                ((lambda
                                  (v.14)
                                  (if
                                   (null? v.14)
                                   ((lambda
                                     (v.15)
                                     ((lambda
                                       (body)
                                       (cons let
                                        (cons
                                         (map
                                          (lambda
                                           (var expr)
                                           (cons var
                                            (cons expr
                                             (quote
                                              ())))) var expr) body))) v.15))
                                    (cdr v.13)) #f))
                                 (car v.13)) #f))
                              (cdr v.11)) #f))
                           (car v.11)) #f))
                        (cdr v.3)))
                      (reverse var-ls)
                      (reverse expr-ls))
                     (if
                      (pair? v.5)
                      ((lambda
                        (v.6)
                        (if
                         (pair? v.6)
                         ((lambda
                           (v.7)
                           ((lambda
                             (var)
                             ((lambda
                               (v.8)
                               (if
                                (pair? v.8)
                                ((lambda
                                  (v.9)
                                  ((lambda
                                    (expr)
                                    ((lambda
                                      (v.10)
                                      (if
                                       (null? v.10)
                                       (lp
                                        (cdr v.5)
                                        (cons var var-ls)
                                        (cons expr expr-ls)) #f))
                                     (cdr v.8))) v.9))
                                 (car v.8)) #f))
                              (cdr v.6))) v.7))
                          (car v.6)) #f))
                       (car v.5)) #f)))) #<undef>
                  (lp v.4
                   ()
                   ()))))
               (car v.3)) #f))
            (cdr v.1))) v.2))
        (car v.1)) #f))
     (cdr expr))))))

(define-syntax match-named-let
 (er-macro-transformer
  (lambda
   (expr rename compare)
   ((lambda
     (tmp)
     (if tmp tmp
      ((lambda
        (tmp)
        (if tmp tmp
         (error "no expansion for"
          (strip-syntactic-closures expr))))
       ((lambda
         (v.16)
         (if
          (pair? v.16)
          ((lambda
            (v.17)
            ((lambda
              (loop)
              ((lambda
                (v.18)
                (if
                 (pair? v.18)
                 ((lambda
                   (v.19)
                   (if
                    (list? v.19)
                    ((lambda
                      (v)
                      ((lambda
                        (v.20)
                        (if
                         (pair? v.20)
                         ((lambda
                           (v.21)
                           (if
                            (pair? v.21)
                            ((lambda
                              (v.22)
                              (if
                               (pair? v.22)
                               ((lambda
                                 (v.23)
                                 ((lambda
                                   (pat)
                                   ((lambda
                                     (v.24)
                                     (if
                                      (pair? v.24)
                                      ((lambda
                                        (v.25)
                                        ((lambda
                                          (expr)
                                          ((lambda
                                            (v.26)
                                            (if
                                             (null? v.26)
                                             ((lambda
                                               (v.27)
                                               ((lambda
                                                 (rest)
                                                 ((lambda
                                                   (v.28)
                                                   ((lambda
                                                     (body)
                                                     (cons
                                                      (rename
                                                       (quote match-named-let))
                                                      (cons loop
                                                       (cons
                                                        (append
                                                         (map
                                                          (lambda
                                                           (v) v) v)
                                                         (cons
                                                          (cons pat
                                                           (cons expr
                                                            (cons
                                                             (rename
                                                              (quote tmp))
                                                             (quote
                                                              ()))))
                                                          (quote
                                                           ())))
                                                        (cons rest body))))) v.28))
                                                  (cdr v.20))) v.27))
                                              (cdr v.21)) #f))
                                           (cdr v.24))) v.25))
                                       (car v.24)) #f))
                                    (cdr v.22))) v.23))
                                (car v.22)) #f))
                             (car v.21)) #f))
                          (car v.20)) #f))
                       (cdr v.18))) v.19) #f))
                  (car v.18)) #f))
               (cdr v.16))) v.17))
           (car v.16)) #f))
        (cdr expr)))))
    ((lambda
      (v.1)
      (if
       (pair? v.1)
       ((lambda
         (v.2)
         ((lambda
           (loop)
           ((lambda
             (v.3)
             (if
              (pair? v.3)
              ((lambda
                (v.4)
                ((lambda
                  ()
                  (define lp #f)
                  (set! lp
                   (lambda
                    (v.5 pat-ls expr-ls var-ls)
                    (if
                     (null? v.5)
                     ((lambda
                       (pat expr var)
                       ((lambda
                         (v.13)
                         (if
                          (pair? v.13)
                          ((lambda
                            (v.14)
                            (if
                             (null? v.14)
                             ((lambda
                               (v.15)
                               ((lambda
                                 (body)
                                 (cons
                                  (rename
                                   (quote let))
                                  (cons loop
                                   (cons
                                    (map
                                     (lambda
                                      (var expr)
                                      (cons var
                                       (cons expr
                                        (quote
                                         ())))) var expr)
                                    (cons
                                     (cons
                                      (rename
                                       (quote match-let))
                                      (cons
                                       (map
                                        (lambda
                                         (pat var)
                                         (cons pat
                                          (cons var
                                           (quote
                                            ())))) pat var) body))
                                     (quote
                                      ())))))) v.15))
                              (cdr v.13)) #f))
                           (car v.13)) #f))
                        (cdr v.3)))
                      (reverse pat-ls)
                      (reverse expr-ls)
                      (reverse var-ls))
                     (if
                      (pair? v.5)
                      ((lambda
                        (v.6)
                        (if
                         (pair? v.6)
                         ((lambda
                           (v.7)
                           ((lambda
                             (pat)
                             ((lambda
                               (v.8)
                               (if
                                (pair? v.8)
                                ((lambda
                                  (v.9)
                                  ((lambda
                                    (expr)
                                    ((lambda
                                      (v.10)
                                      (if
                                       (pair? v.10)
                                       ((lambda
                                         (v.11)
                                         ((lambda
                                           (var)
                                           ((lambda
                                             (v.12)
                                             (if
                                              (null? v.12)
                                              (lp
                                               (cdr v.5)
                                               (cons pat pat-ls)
                                               (cons expr expr-ls)
                                               (cons var var-ls)) #f))
                                            (cdr v.10))) v.11))
                                        (car v.10)) #f))
                                     (cdr v.8))) v.9))
                                 (car v.8)) #f))
                              (cdr v.6))) v.7))
                          (car v.6)) #f))
                       (car v.5)) #f)))) #<undef>
                  (lp v.4
                   ()
                   ()
                   ()))))
               (car v.3)) #f))
            (cdr v.1))) v.2))
        (car v.1)) #f))
     (cdr expr))))))

(define-syntax match-let*
 (er-macro-transformer
  (lambda
   (expr rename compare)
   ((lambda
     (tmp)
     (if tmp tmp
      ((lambda
        (tmp)
        (if tmp tmp
         (error "no expansion for"
          (strip-syntactic-closures expr))))
       ((lambda
         (v.4)
         (if
          (pair? v.4)
          ((lambda
            (v.5)
            (if
             (pair? v.5)
             ((lambda
               (v.6)
               (if
                (pair? v.6)
                ((lambda
                  (v.7)
                  ((lambda
                    (pat)
                    ((lambda
                      (v.8)
                      (if
                       (pair? v.8)
                       ((lambda
                         (v.9)
                         ((lambda
                           (expr)
                           ((lambda
                             (v.10)
                             (if
                              (null? v.10)
                              ((lambda
                                (v.11)
                                ((lambda
                                  (rest)
                                  ((lambda
                                    (v.12)
                                    ((lambda
                                      (body)
                                      (cons
                                       (rename
                                        (quote match))
                                       (cons expr
                                        (cons
                                         (cons pat
                                          (cons
                                           (cons
                                            (rename
                                             (quote match-let*))
                                            (cons rest body))
                                           (quote
                                            ())))
                                         (quote
                                          ()))))) v.12))
                                   (cdr v.4))) v.11))
                               (cdr v.5)) #f))
                            (cdr v.8))) v.9))
                        (car v.8)) #f))
                     (cdr v.6))) v.7))
                 (car v.6)) #f))
              (car v.5)) #f))
           (car v.4)) #f))
        (cdr expr)))))
    ((lambda
      (v.1)
      (if
       (pair? v.1)
       ((lambda
         (v.2)
         (if
          (null? v.2)
          ((lambda
            (v.3)
            ((lambda
              (body)
              (cons
               (rename
                (quote begin)) body)) v.3))
           (cdr v.1)) #f))
        (car v.1)) #f))
     (cdr expr))))))

(define-syntax match-check-ellipse
 (er-macro-transformer
  (lambda
   (expr rename compare)
   ((lambda
     (tmp)
     (if tmp tmp
      ((lambda
        (tmp)
        (if tmp tmp
         ((lambda
           (tmp)
           (if tmp tmp
            (error "no expansion for"
             (strip-syntactic-closures expr))))
          ((lambda
            (v.18)
            (if
             (pair? v.18)
             ((lambda
               (v.19)
               ((lambda
                 (id)
                 ((lambda
                   (v.20)
                   (if
                    (pair? v.20)
                    ((lambda
                      (v.21)
                      ((lambda
                        (success-k)
                        ((lambda
                          (v.22)
                          (if
                           (pair? v.22)
                           ((lambda
                             (v.23)
                             ((lambda
                               (failure-k)
                               ((lambda
                                 (v.24)
                                 (if
                                  (null? v.24)
                                  (cons
                                   (rename
                                    (quote let-syntax))
                                   (cons
                                    (cons
                                     (cons
                                      (rename
                                       (quote ellipse?))
                                      (cons
                                       (cons
                                        (rename
                                         (quote syntax-rules))
                                        (cons
                                         (quote
                                          ())
                                         (cons
                                          (cons
                                           (cons
                                            (rename
                                             (quote ellipse?))
                                            (cons
                                             (cons
                                              (rename
                                               (quote foo))
                                              (cons id
                                               (quote
                                                ())))
                                             (cons
                                              (rename
                                               (quote sk))
                                              (cons
                                               (rename
                                                (quote fk))
                                               (quote
                                                ())))))
                                           (cons
                                            (rename
                                             (quote sk))
                                            (quote
                                             ())))
                                          (cons
                                           (cons
                                            (cons
                                             (rename
                                              (quote ellipse?))
                                             (cons
                                              (rename
                                               (quote other))
                                              (cons
                                               (rename
                                                (quote sk))
                                               (cons
                                                (rename
                                                 (quote fk))
                                                (quote
                                                 ())))))
                                            (cons
                                             (rename
                                              (quote fk))
                                             (quote
                                              ())))
                                           (quote
                                            ())))))
                                       (quote
                                        ())))
                                     (quote
                                      ()))
                                    (cons
                                     (cons
                                      (rename
                                       (quote ellipse?))
                                      (cons
                                       (cons
                                        (rename
                                         (quote a))
                                        (cons
                                         (rename
                                          (quote b))
                                         (cons
                                          (rename
                                           (quote c))
                                          (quote
                                           ()))))
                                       (cons success-k
                                        (cons failure-k
                                         (quote
                                          ())))))
                                     (quote
                                      ())))) #f))
                                (cdr v.22))) v.23))
                            (car v.22)) #f))
                         (cdr v.20))) v.21))
                     (car v.20)) #f))
                  (cdr v.18))) v.19))
              (car v.18)) #f))
           (cdr expr)))))
       ((lambda
         (v.10)
         (if
          (pair? v.10)
          ((lambda
            (v.11)
            (if
             (vector? v.11)
             ((lambda
               (v.12)
               (if
                (list? v.12)
                ((lambda
                  (a)
                  ((lambda
                    (v.13)
                    (if
                     (pair? v.13)
                     ((lambda
                       (v.14)
                       ((lambda
                         (success-k)
                         ((lambda
                           (v.15)
                           (if
                            (pair? v.15)
                            ((lambda
                              (v.16)
                              ((lambda
                                (failure-k)
                                ((lambda
                                  (v.17)
                                  (if
                                   (null? v.17) failure-k #f))
                                 (cdr v.15))) v.16))
                             (car v.15)) #f))
                          (cdr v.13))) v.14))
                      (car v.13)) #f))
                   (cdr v.10))) v.12) #f))
              (vector->list v.11)) #f))
           (car v.10)) #f))
        (cdr expr)))))
    ((lambda
      (v.1)
      (if
       (pair? v.1)
       ((lambda
         (v.2)
         (if
          (pair? v.2)
          ((lambda
            (v.3)
            ((lambda
              (a)
              ((lambda
                (v.4)
                ((lambda
                  (b)
                  ((lambda
                    (v.5)
                    (if
                     (pair? v.5)
                     ((lambda
                       (v.6)
                       ((lambda
                         (success-k)
                         ((lambda
                           (v.7)
                           (if
                            (pair? v.7)
                            ((lambda
                              (v.8)
                              ((lambda
                                (failure-k)
                                ((lambda
                                  (v.9)
                                  (if
                                   (null? v.9) failure-k #f))
                                 (cdr v.7))) v.8))
                             (car v.7)) #f))
                          (cdr v.5))) v.6))
                      (car v.5)) #f))
                   (cdr v.1))) v.4))
               (cdr v.2))) v.3))
           (car v.2)) #f))
        (car v.1)) #f))
     (cdr expr))))))

(define-syntax match-check-identifier
 (er-macro-transformer
  (lambda
   (expr rename compare)
   ((lambda
     (tmp)
     (if tmp tmp
      ((lambda
        (tmp)
        (if tmp tmp
         ((lambda
           (tmp)
           (if tmp tmp
            (error "no expansion for"
             (strip-syntactic-closures expr))))
          ((lambda
            (v.18)
            (if
             (pair? v.18)
             ((lambda
               (v.19)
               ((lambda
                 (x)
                 ((lambda
                   (v.20)
                   (if
                    (pair? v.20)
                    ((lambda
                      (v.21)
                      ((lambda
                        (success-k)
                        ((lambda
                          (v.22)
                          (if
                           (pair? v.22)
                           ((lambda
                             (v.23)
                             ((lambda
                               (failure-k)
                               ((lambda
                                 (v.24)
                                 (if
                                  (null? v.24)
                                  (cons
                                   (rename
                                    (quote let-syntax))
                                   (cons
                                    (cons
                                     (cons
                                      (rename
                                       (quote sym?))
                                      (cons
                                       (cons
                                        (rename
                                         (quote syntax-rules))
                                        (cons
                                         (quote
                                          ())
                                         (cons
                                          (cons
                                           (cons
                                            (rename
                                             (quote sym?))
                                            (cons x
                                             (cons
                                              (rename
                                               (quote sk))
                                              (cons
                                               (rename
                                                (quote fk))
                                               (quote
                                                ())))))
                                           (cons
                                            (rename
                                             (quote sk))
                                            (quote
                                             ())))
                                          (cons
                                           (cons
                                            (cons
                                             (rename
                                              (quote sym?))
                                             (cons
                                              (rename
                                               (quote y))
                                              (cons
                                               (rename
                                                (quote sk))
                                               (cons
                                                (rename
                                                 (quote fk))
                                                (quote
                                                 ())))))
                                            (cons
                                             (rename
                                              (quote fk))
                                             (quote
                                              ())))
                                           (quote
                                            ())))))
                                       (quote
                                        ())))
                                     (quote
                                      ()))
                                    (cons
                                     (cons
                                      (rename
                                       (quote sym?))
                                      (cons
                                       (rename
                                        (quote abracadabra))
                                       (cons success-k
                                        (cons failure-k
                                         (quote
                                          ())))))
                                     (quote
                                      ())))) #f))
                                (cdr v.22))) v.23))
                            (car v.22)) #f))
                         (cdr v.20))) v.21))
                     (car v.20)) #f))
                  (cdr v.18))) v.19))
              (car v.18)) #f))
           (cdr expr)))))
       ((lambda
         (v.10)
         (if
          (pair? v.10)
          ((lambda
            (v.11)
            (if
             (vector? v.11)
             ((lambda
               (v.12)
               (if
                (list? v.12)
                ((lambda
                  (x)
                  ((lambda
                    (v.13)
                    (if
                     (pair? v.13)
                     ((lambda
                       (v.14)
                       ((lambda
                         (success-k)
                         ((lambda
                           (v.15)
                           (if
                            (pair? v.15)
                            ((lambda
                              (v.16)
                              ((lambda
                                (failure-k)
                                ((lambda
                                  (v.17)
                                  (if
                                   (null? v.17) failure-k #f))
                                 (cdr v.15))) v.16))
                             (car v.15)) #f))
                          (cdr v.13))) v.14))
                      (car v.13)) #f))
                   (cdr v.10))) v.12) #f))
              (vector->list v.11)) #f))
           (car v.10)) #f))
        (cdr expr)))))
    ((lambda
      (v.1)
      (if
       (pair? v.1)
       ((lambda
         (v.2)
         (if
          (pair? v.2)
          ((lambda
            (v.3)
            ((lambda
              (x)
              ((lambda
                (v.4)
                ((lambda
                  (y)
                  ((lambda
                    (v.5)
                    (if
                     (pair? v.5)
                     ((lambda
                       (v.6)
                       ((lambda
                         (success-k)
                         ((lambda
                           (v.7)
                           (if
                            (pair? v.7)
                            ((lambda
                              (v.8)
                              ((lambda
                                (failure-k)
                                ((lambda
                                  (v.9)
                                  (if
                                   (null? v.9) failure-k #f))
                                 (cdr v.7))) v.8))
                             (car v.7)) #f))
                          (cdr v.5))) v.6))
                      (car v.5)) #f))
                   (cdr v.1))) v.4))
               (cdr v.2))) v.3))
           (car v.2)) #f))
        (car v.1)) #f))
     (cdr expr))))))

